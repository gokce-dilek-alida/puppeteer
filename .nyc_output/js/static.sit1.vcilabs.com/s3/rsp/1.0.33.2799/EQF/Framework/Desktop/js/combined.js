//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.

//     Underscore may be freely distributed under the MIT license.

/**
* Panzoom for panning and zooming elements using CSS transforms
* Copyright Timmy Willison and other contributors
* https://github.com/timmywil/panzoom/blob/master/MIT-License.txt
*/

/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */

/*

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/

/**
 * Copyright (c) 2011-2014 Felix Gnass
 * Licensed under the MIT license
 * http://spin.js.org/
 *
 * Example:
    var opts = {
      lines: 12             // The number of lines to draw
    , length: 7             // The length of each line
    , width: 5              // The line thickness
    , radius: 10            // The radius of the inner circle
    , scale: 1.0            // Scales overall size of the spinner
    , corners: 1            // Roundness (0..1)
    , color: '#000'         // #rgb or #rrggbb
    , opacity: 1/4          // Opacity of the lines
    , rotate: 0             // Rotation offset
    , direction: 1          // 1: clockwise, -1: counterclockwise
    , speed: 1              // Rounds per second
    , trail: 100            // Afterglow percentage
    , fps: 20               // Frames per second when using setTimeout()
    , zIndex: 2e9           // Use a high z-index by default
    , className: 'spinner'  // CSS class to assign to the element
    , top: '50%'            // center vertically
    , left: '50%'           // center horizontally
    , shadow: false         // Whether to render a shadow
    , hwaccel: false        // Whether to use hardware acceleration (might be buggy)
    , position: 'absolute'  // Element positioning
    }
    var target = document.getElementById('foo')
    var spinner = new Spinner(opts).spin(target)
 */

/**
 * Copyright (c) 2011-2014 Felix Gnass
 * Licensed under the MIT license
 * http://spin.js.org/
 */

/*!
 * Extremely modded, stripped-down version of https://github.com/lokesh/lightbox2/blob/master/LICENSE
 * - Displays a single image passed into the start() method
 *
 * Lightbox v2.9.0
 * by Lokesh Dhakar
 *
 * More info:
 * http://lokeshdhakar.com/projects/lightbox2/
 *
 * Copyright 2007, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://github.com/lokesh/lightbox2/blob/master/LICENSE
 *
 * @preserve
 */

/*! fontfaceonload - v1.0.2 - 2017-06-28
 * https://github.com/zachleat/fontfaceonload
 * Copyright (c) 2017 Zach Leatherman (@zachleat)
 * MIT License */

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*
 * jQuery File Upload Plugin 5.42.3
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */

/*
 * jQuery Iframe Transport Plugin 1.8.3
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */

// │ Copyright (c) 2008-2011 Dmitry Baranovskiy (http://raphaeljs.com)   │ \\

// │ Copyright (c) 2008-2011 Sencha Labs (http://sencha.com)             │ \\

// │ Licensed under the MIT (http://raphaeljs.com/license.html) license. │ \\

// │ Copyright (c) 2008-2011 Dmitry Baranovskiy (http://dmitry.baranovskiy.com/)          │ \\

// │ Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license. │ \\

// │ Copyright (c) 2008-2011 Dmitry Baranovskiy (http://raphaeljs.com)   │ \\

// │ Copyright (c) 2008-2011 Sencha Labs (http://sencha.com)             │ \\

// │ Licensed under the MIT (http://raphaeljs.com/license.html) license. │ \\

// │ Copyright (c) 2008-2011 Dmitry Baranovskiy (http://raphaeljs.com)   │ \\

// │ Copyright (c) 2008-2011 Sencha Labs (http://sencha.com)             │ \\

// │ Licensed under the MIT (http://raphaeljs.com/license.html) license. │ \\

// │ Copyright (c) 2008-2011 Dmitry Baranovskiy (http://raphaeljs.com)   │ \\

// │ Copyright (c) 2008-2011 Sencha Labs (http://sencha.com)             │ \\

// │ Licensed under the MIT (http://raphaeljs.com/license.html) license. │ \\

define("lib/json2",[],function(){return window.JSON||(window.JSON=function(){function f(e){return e<10?"0"+e:e}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},stringify=function(e,t){var n,r,i,s,o=/["\\\x00-\x1f\x7f-\x9f]/g,u;switch(typeof e){case"string":return o.test(e)?'"'+e.replace(o,function(e){var t=m[e];return t?t:(t=e.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})+'"':'"'+e+'"';case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(typeof e.toJSON=="function")return stringify(e.toJSON());n=[];if(typeof e.length=="number"&&!e.propertyIsEnumerable("length")){s=e.length;for(r=0;r<s;r+=1)n.push(stringify(e[r],t)||"null");return"["+n.join(",")+"]"}if(t){s=t.length;for(r=0;r<s;r+=1)i=t[r],typeof i=="string"&&(u=stringify(e[i],t),u&&n.push(stringify(i)+":"+u))}else for(i in e)typeof i=="string"&&(u=stringify(e[i],t),u&&n.push(stringify(i)+":"+u));return"{"+n.join(",")+"}"}};return{stringify:stringify,parse:function(text,filter){var j,walk=function(e,t){var n,r;if(t&&typeof t=="object")for(n in t)Object.prototype.hasOwnProperty.apply(t,[n])&&(r=walk(n,t[n]),r!==undefined&&(t[n]=r));return filter(e,t)};if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof filter=="function"?walk("",j):j;throw new SyntaxError("parseJSON")}}}()),window.JSON}),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=r.unshift,l=i.toString,c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){if(e instanceof T)return e;if(!(this instanceof T))return new T(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.2";var N=T.each=T.forEach=function(e,t,r){if(e==null)return;if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return e==null?r:p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=T.keys(e);s=o.length}N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return e==null?r:m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){var r=[];return e==null?r:(N(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return e==null?i:g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return e==null?i:y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){var n=!1;return e==null?n:b&&e.indexOf===b?e.indexOf(t)!=-1:(n=C(e,function(e){return e===t}),n)},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-Infinity;var r={computed:-Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return Infinity;var r={computed:Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){n=n==null?T.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return t!=null&&!n?u.call(e,0,t):e[0]},T.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},T.last=function(e,t,n){return t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){if(t?!r||o[o.length-1]!==n:!T.contains(o,n))o.push(n),s.push(e[r])}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(e,t){var n,r;if(e.bind===x&&x)return x.apply(e,u.call(arguments,1));if(!T.isFunction(e))throw new TypeError;return r=u.call(arguments,2),n=function(){if(this instanceof n){O.prototype=e.prototype;var i=new O,s=e.apply(i,r.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,r.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return t.length==0&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o,u,a=T.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&(u=e.apply(n,r)),a()};return i||(i=setTimeout(f,t)),s?o=!0:(s=!0,u=e.apply(n,r)),a(),u}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=M(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)){o++;if(!(u=T.has(t,c)&&M(e[c],t[c],n,r)))break}if(u){for(c in t)if(T.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(e==null)return!0;if(T.isArray(e)||T.isString(e))return e.length===0;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&e.nodeType===1},T.isArray=E||function(e){return l.call(e)=="[object Array]"},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),typeof /./!="function"&&(T.isFunction=function(e){return typeof e=="function"}),T.isFinite=function(e){return T.isNumber(e)&&isFinite(e)},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||l.call(e)=="[object Boolean]"},T.isNull=function(e){return e===null},T.isUndefined=function(e){return e===void 0},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(e==null)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){return e._}}(this)),define("step",["underscore"],function(){var e=function(){return window.vcStep},t=function(e){_.each(e,function(e){e.EqfProperties&&(e.CustomQuestionProperties=e.EqfProperties,delete e.EqfProperties);if(e.AnswerCollection)for(var t=0;t<e.AnswerCollection.length;t++)e.AnswerCollection[t].EqfProperties&&(e.AnswerCollection[t].CustomAnswerProperties=e.AnswerCollection[t].EqfProperties,delete e.AnswerCollection[t].EqfProperties);if(e.WorkflowStepCollection)for(var n=0;n<e.WorkflowStepCollection.length;n++)e.WorkflowStepCollection[n].EqfProperties&&(e.WorkflowStepCollection[n].CustomRowProperties=e.WorkflowStepCollection[n].EqfProperties,delete e.WorkflowStepCollection[n].EqfProperties)})};return{getStep:e,renameEqfProperties:t}}),define("constants",[],function(){var e=function(e){return location.protocol=="https:"?e.replace("http://","https://"):e};return window.constants.ValidationTypeNone=0,window.constants.ValidationTypeNumeric=1,window.constants.ValidationTypeEmailAddress=2,window.constants.ValidationTypePhoneNumber=3,window.constants.ValidationTypeZipCode=4,window.constants.ValidationTypePostalCodeCA=5,window.constants.ValidationTypeDateTime=6,window.constants.ValidationDigitsSampleValue=12345.6,window.constants.dpResponderScripting="Scripting",window.constants.dpMasked="Masked",window.constants.dpNone="None",window.constants.AnswerStateAffix="_state",window.constants.eventType={theming:"vc_themes"},window.constants.ImageHandlerUri&&(window.constants.ImageHandlerUri=e(window.constants.ImageHandlerUri)),window.constants.plugins={VideoFeedback:"VideoFeedbackPlugin"},window.constants}),define("jQueryFramework",[],function(){return window.$}),define("localization",[],function(){var e=window.Globalize,t=e.findClosestCulture,n=function(e){var n=t.apply(this,[e]);return n&&n.numberFormat&&n.numberFormat[","]&&(n.numberFormat[","]=""),n.name==="ar-SA"&&n.calendar.name!==n.calendars.Gregorian_Localized.name&&(n.calendar=n.calendars.Gregorian_Localized),n};e.findClosestCulture=n;var r=function(t){return e.culture(t)},i=function(){return e.culture()},s=function(e){var t=i(),n=t.numberFormat["."];return n!=="."&&e.indexOf(".")>=0},o=function(t){var n=e.parseFloat(t);return s(t)?NaN:n},u=function(t,n){return arguments.length==1?e.format(t,"n"):e.format(t,"n"+n)},a=function(t){return e.parseDate(t)},f=function(t,n){return e.format(t,n)},l=function(){return e.culture().calendars.standard.patterns.d},c={setCurrentCulture:r,getCurrentCulture:i,parseFloat:o,formatFloat:u,parseDate:a,formatDate:f,getDateFormat:l};return c}),define("utils",["constants","jQueryFramework","localization"],function(e,t,n){var r=function(e){return console&&console.log&&console.log("%s: %o",e,this),this},i=function(e,t){var n=u(e),r=u(t),i=n<r?r:n,s=Math.pow(10,i);return Math.round(e*s+t*s)/s},s=function(e,t){var n=u(e),r=u(t),i=n<r?r:n,s=Math.pow(10,i);return Math.round(e*s-t*s)/s},o=function(e){var t;if(typeof e=="number")t=e;else{t=parseFloat(e);if(isNaN(t))return e}return n.formatFloat(t,u(t.toString()))},u=function(e){if(typeof e=="number")e=e.toString();else if(typeof e!="string")return 0;var t=e.indexOf(".");return t==-1?0:e.length-t-1},a=function(e){return"n"+u(e)},f=function(e,t){if(arguments.length===0)throw new Error("Error: util format function without argument.");if(!t)return e;for(var n=0;n<t.length;n++)e=e.replace(new RegExp("\\{"+n+"\\}","gm"),t[n]);return e},l=function(e){return e&&typeof e=="string"&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")),e},c=function(e){return e&&typeof e=="string"&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">")),e},h=function(e){var t=6,n=13,r=1,i=4,s=parseInt(e.substr(t,n)),o=e.substr(t+n,r),u=e.substr(t+n+r,i),a=u*36e3,f=s,l;return o=="+"?l=f+a:l=f-a,new Date(l)},p=function(){return n.getDateFormat()},d=function(e){var t=m(e);return y(t)?n.formatDate(t,"d"):""},v=function(e){var t=n.parseDate(e);return g(t)},m=function(e){if(!e)return null;if(Object.prototype.toString.call(e)==="[object Date]")return e;if(!isNaN(e))return new Date(e);var t=e.split("-").map(parseFloat);return new Date(t[0],t[1]-1,t[2])},g=function(e){if(!y(e))return"";var t=e.getMonth()+1;t<10?t="0"+t.toString():t=t.toString();var n=e.getDate();n.toString().length==1&&(n="0"+n.toString());var r=e.getFullYear()+"-"+t+"-"+n;return r},y=function(e){return Object.prototype.toString.call(e)!=="[object Date]"?!1:!isNaN(e.getTime())},b=function(t,n){switch(n){case e.ValidationTypeNumeric:return o(t);case e.ValidationTypeDateTime:return t?g(m(t)):"";default:return l(t)}},w=function(t,r){switch(r){case e.ValidationTypeNumeric:return n.parseFloat(t);case e.ValidationTypeDateTime:return m(t);default:return c(t)}},E=function(){var e=location.port;e!=""&&(e=":"+e);var t=location.protocol+"//"+location.hostname+e+"/";return t},S=function(t){switch(t.d.ReturnInfo.Code){case"AuthorizationFailed":return alert(e.NetAuthorizationFailedMessage),!1;case"Exception":return alert(e.NetExceptionMessage),!1;case"Success":return!0;default:return alert(e.NetUnknownReturnCodeMessage+t.d.ReturnInfo.Code),!0}},x=function(e){var t=e.keyCode||e.which;if(!t||t>=112&&t<=123)return!0;var n=new Array(9,16,17,18,19,20,27,33,34,35,36,37,38,39,40,44,45,91,92,93,144,145);for(var r=0;r<n.length;r++)if(n[r]==t)return!0;return!1},T=function(){if(window.history){var e=typeof window.history.pushState!="undefined";if(e){var n="#noBackToken",r=window.location.href;window.location.hash=n,window.location.hash===n&&window.history.pushState(null,"",r),window.onhashchange=function(){if(window.location.hash===n){var e=t("<div></div>");t("body").append(e),e.remove(),window.history.pushState(null,"",r)}}}else{var i=function(){window.history.forward()};i(),window.onload=i,window.onpageshow=function(e){e.persisted&&i()}}}},N=function(e,t){return e&&""!=e?e+" "+t:t},C=function(){return window.attachEvent&&!window.addEventListener?!0:!1},k=function(){var e=document.createElement("div");return e.innerHTML="<!--[if lte IE 9]><i></i><![endif]-->",e.getElementsByTagName("i").length>0?!0:!1},L=function(e,t){return t.substr(0,e.length)===e},A=function(){var t;return window.parent.document.documentElement.clientWidth<window.parent.document.documentElement.clientHeight?t=window.parent.document.documentElement.clientWidth>=768:t=window.parent.document.documentElement.clientHeight>=504,e.IsMobile&&t},O=function(){t("#desktop-button",window.parent.document).hide()},M=function(t){if(A()){var n=e.RedirectMessageForMobilePreview,r=e.RedirectInstructionForMobilePreview;O(),window.location.href="/s/EQF/Framework/Mobile/Preview/mobilePreviewTerminationRedirect.html?_message="+encodeURIComponent(n)+"&_instructions="+encodeURIComponent(r)+"&_url="+encodeURIComponent(t)+"&_testLabel="+encodeURIComponent(e.TestFlag)+"&_rtlContentDirection="+encodeURIComponent(e.IsRtlContentDirection)}else window.location.replace(t)},_=function(e){var t=document.createElement("div");return t.innerHTML=e,typeof t.innerText=="undefined"?t.textContent:t.innerText},D=function(t){return e.FeatureToggles&&e.FeatureToggles[t]},P=function(){return D("Toggles+RespondingUXEnhancements")},H=function(){return D("Toggles+Q3SurveyRespondingUXImprovements")},B=function(){return D("Toggles+Q3AccessibilityImprovements")},j=function(){return e.IsRtlContentDirection};return{log:r,add:i,sub:s,localizeNumber:o,getDecimalPlaces:u,getNumberFormat:a,formatString:f,htmlEncodeString:l,htmlDecodeString:c,parseToLocalDate:h,ISO8601DateToLocalizedString:d,localizeDateToISO8601String:v,getISO8601DateObject:m,decodeAndParseDataPointValue:w,encodeAndLocalizeDataPointValue:b,getBaseUrl:E,handleReturnCode:S,isSpecialKeyCode:x,concatMessage:N,disableBrowserBackButtonDefaultBehavior:T,isIE8OrLess:C,isIE9OrLess:k,startsWith:L,handleRedirect:M,isMobilePreview:A,getLocalizedDateFormat:p,getISO8601DateString:g,getPlainText:_,isFeatureToggleEnabled:D,isUxImprovementsToggleEnabled:P,isRightToLeftContentDirection:j,isQ3SurveyRespondingUXImprovementsEnabled:H,isQ3AccessibilityImprovementsEnabled:B}}),define("responseVariables/screenSizeVariable",["jQueryFramework"],function(e){var t=function(){return JSON.stringify({width:document.documentElement.clientWidth,height:document.documentElement.clientHeight})};return{Name:"ScreenResolution",Event:"WhileResponding",getValue:t}}),define("responseVariables/testVariable",[],function(){var e=function(e,t,n){var r=function(){return Math.random().toString()},i=function(){return Math.random().toString()},s=function(){return Math.floor(Math.random()*12)+1},o=function(){return Math.floor(Math.random()*28)+1},u=function(){return(new Date(2014,s(),o())).toString()},a=function(){var e=["A","B","C"],t=Math.floor(Math.random()*e.length);return e[t]},f=function(){if(n==="String")return r();if(n==="Numeric")return i();if(n==="Date")return"2014-01-01";if(n==="Choice")return a();throw"Unknown variable type"};return{Name:e,Event:t,getValue:f}};return{create:e}}),define("responseVariableProvider",["jQueryFramework","responseVariables/screenSizeVariable","responseVariables/testVariable","constants","underscore"],function(e,t,n,r,i){var s=[];if(r.TestResponseVariables){var o=["SurveyStart","SurveyComplete","WhileResponding","Reconnect"],u=["String","Date","Numeric","Choice"];i.each(u,function(e){i.each(o,function(t){var r="Client_"+t+"_"+e,i=n.create(r,t,e);s.push(i)})})}else s.push(t);var a=function(e,t){var n=function(e){return i.filter(s,function(t){return i.any(e,function(e){return t.Event===e})})},r;e?r=n(["WhileResponding","Reconnect","SurveyComplete"]):t?r=n(["SurveyStart","WhileResponding","SurveyComplete"]):r=n(["WhileResponding","SurveyComplete"]);var o=i.map(r,function(e){return{Group:"ResponseVariables",Name:e.Name,UpdateOn:[e.Event],Value:e.getValue()}});return o};return{getResponseVariableDataArray:a}}),define("data",["lib/json2","step","utils","constants","responseVariableProvider","jQueryFramework"],function(e,t,n,r,i,s){var o=function(){s("input").each(function(e){var t=s(this).attr("name");(t==r.NavNextFormId||t==r.NavBackFormId)&&s(this).val("")})},u=function(){var e=s("#"+r.ResponseId);if(e)return e.val()},a=function(e,t){return s("#"+r.DataPointPrefix+e+r.EventIdPrefix+t)},f=function(e,t){return s("#"+r.DataPointPrefix+e+r.EventIdPrefix+t+r.IsSelectedAffix)},l=function(e,t){return s("#"+r.DataPointPrefix+e+r.EventIdPrefix+t+r.AnswerStateAffix)},c=function(e,t){return h(f(e,t))},h=function(e){return s(e).val()=="true"},p=function(e,t,n,r,i,s,o){var u=!1,a=0,f=!1;return _.every(e,function(e){var n=!1,r=0,o=0;return _.every(t,function(t){t.Exclusive&&++o;if(c(t.ObjectId,e.ObjectId)){++r;if(t.Exclusive)return n=!0,!1;if(r>s)return!1}return!0}),r==0?!0:(f=!0,n||r<=s&&(r>=i||r==t.length-o)?(++a,!0):(u=!0,!1))}),!o&&!f?!0:!u&&a<=r&&(a>=n||a==e.length)},d=function(e,t){var n,r=t.AnswerCollection;for(n=0;n<r.length;n++)if(r[n].ObjectId===e)return r[n]},v={},m=function(e){return v[e]||(v[e]=s("input[name$='"+e+r.IsSelectedAffix+"']")),v[e]},g=function(e){_.each(e,function(e){_.each(e.getAllDataPoints(),function(e){var t=a(e.RawAnswerDefinition.ObjectId,e.RawQuestionDefinition.ObjectId);e.RawAnswerDefinition.TextValidationType===r.ValidationTypeNumeric&&t.val(n.localizeNumber(t.val()))})})},y=function(){o()},b=function(){s("#vc_next").val("1"),E(),s("#SurveyForm").submit()},w=function(){s("#vc_back").val("1"),E(),s("#SurveyForm").submit()},E=function(){s("#vc_responsevariables").val(e.stringify(i.getResponseVariableDataArray(r.IsReconnect)))};return{localizeInitialDataPoints:g,currentResponseId:u,inputByAnswerIdStepId:a,selectedByAnswerIdStepId:f,stateByAnswerIdStepId:l,isSelectedByAnswerIdStepId:c,isSelected:h,answerByID:d,selectedInputsByQuestionId:m,initialize:y,submitNext:b,submitBack:w,isValidResponse:p}}),define("pluginRegistry",["constants","underscore"],function(e,t){var n=[],r=function(e){var t=["create","shouldHandleQuestion"];for(var n=0;n<t.length;n++)e[t[n]]===undefined&&console&&console.log&&console.log("Error loading plugin: You must have a "+t[n]+" function")},i=function(t){if(!t.localizations)return;var n=JSON.parse(e.LanguageFallbackChain);n.push("en-US"),n.push("en");var r=t.localizations;for(var i=0;i<n.length;i++)if(r[n[i]]){t.localizations=r[n[i]];return}},s=function(e,t){if(e.shouldHandleQuestion){var n=e.shouldHandleQuestion;return function(e){return e.ObjectId===t||n(e)}}return function(e){return e.ObjectId===t}},o=function(e,o){n=[],t.each(o,function(e){i(e),e.plugin.shouldHandleQuestion=s(e.plugin,e.objectId),n.push(e)}),n=n.concat(e);for(var u=0;u<n.length;u++)r(n[u].plugin)},u=function(e){for(var t=0;t<n.length;t++)if(n[t].plugin.shouldHandleQuestion(e))return n[t];throw"Unknown question type"};return{initialize:o,getPluginForQuestion:u}}),define("eventAggregator",[],function(){var e={},t=function(t,n){var r=e[t];r===undefined?e[t]=[n]:r.push(n)},n=function(t,n){var r=e[t];if(r!==undefined)for(var i=0;i<r.length;i++)r[i](n)},r=function(e){var r=function(t){n(e,t)},i=function(n){t(e,n)};return{publish:r,subscribe:i}};return{createEvent:r}}),define("event",["eventAggregator"],function(e){return{load:function(t,n,r,i){i.isBuild?r():r(e.createEvent(t))}}}),define("cookies",[],function(){var e=function(e,t,n){var r="";if(n){var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3),r="; expires="+i.toGMTString()}document.cookie=e+"="+t+r+"; path=/"},t=function(){var t=new Date,n=-t.getTimezoneOffset();e("VisionCritical.GmtTimezoneOffset",n,7)},n=function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},r=function(t,n,r){e(t,n,r)};return{createTimezoneOffsetCookie:t,createCookie:e,getCookie:n,updateCookie:r}}),define("themeSwitcher",["jQueryFramework","underscore","cookies","event!communityChanged","event!themeChanged","constants"],function(e,t,n,r,i){var s=[],o=[],u="surveySelectedThemeId",a=7,f,l,c,h,p,d,v,m,g,y=27,b=9,w=13,E=32,S=38,x=40,T=function(e,t){if(!f||f!==e)f=e;C(t)},N=function(e,r){if(!l||l!==e){l=e;for(var i=0;i<s.length;i++)if(s[i].CommunityId===e){f=s[i].Id;break}var o=n.getCookie(u+e);if(o){var a=t.find(s,function(e){return e.Id===o});a&&(f=o)}}C(r)},C=function(r){if(f){var o=t.find(s,function(e){return e.Id===f});l=o.CommunityId,n.createCookie(u,f,a),n.createCookie(u+o.CommunityId,f,a),c.overrideTheme(o.ThemeValues,f,r),p.text(o.CommunityName),h.attr("title",o.CommunityName),m.text(o.Name),v.attr("title",o.Name),e("li",g).remove();for(var y=0;y<s.length;y++)s[y].CommunityId===o.CommunityId&&g.append(e("<li/>").attr("data-theme-id",s[y].Id).attr("data-community-id",s[y].CommunityId).text(s[y].Name).attr("title",s[y].Name).addClass("theme-dropdown-option"));e("li",g).on("click",function(t){t.stopPropagation(),d.hide(),g.children("li").removeClass("theme-dropdown-option-selected"),g.children("li").removeClass("theme-dropdown-option-hover"),e(this).addClass("theme-dropdown-option-selected"),g.toggle();var n=e(this).attr("data-theme-id");T(n,!0),i.publish()})}},k=function(){var e=n.getCookie(u);if(e){var r=t.find(s,function(t){return t.Id===e});if(r)return e}return s[0].Id},L=function(e){var t=e.parent().children();return t.index(e)},A=function(){return e('li[data-theme-id="'+f+'"]',g)},O=function(){return e('li[data-community-id="'+l+'"]',d)},M=function(t){d=e("<ul />").addClass("community-dropdown-options").hide(),p=e("<div />").addClass("community-dropdown-default-text"),h=e("<div />").addClass("community-dropdown-container").attr("tabindex","0").append(e("<div />").addClass("community-dropdown-default-option").append(p).append(e("<div />").addClass("community-dropdown-arrow")));for(var n=0;n<o.length;n++)d.append(e("<li/>").attr("data-community-id",o[n].Id).text(o[n].Name).attr("title",o[n].Name).addClass("community-dropdown-option"));e(t+" #communitySwitcherContainer").append(h).append(d),o.length<2&&e(t+" #communitySwitcherContainer").hide(),g=e("<ul />").addClass("theme-dropdown-options").hide(),m=e("<div />").addClass("theme-dropdown-default-text"),v=e("<div />").addClass("theme-dropdown-container").attr("tabindex","0").append(e("<div />").addClass("theme-dropdown-default-option").append(m).append(e("<div />").addClass("theme-dropdown-arrow"))),e(t+" #themeSwitcherContainer").append(v).append(g)},_=function(e,t){var n=e.outerHeight(),r=t.outerHeight(),i=e.scrollTop(),s=L(t),o=(s+1)*r-(n+i);o>0&&e.scrollTop(o+i)},D=function(e,t){var n=t.outerHeight(),r=e.scrollTop(),i=L(t),s=r-i*n;s>=0&&e.scrollTop(i*n)},P=function(){var t=function(e){g.children("li").removeClass("theme-dropdown-option-selected"),A().addClass("theme-dropdown-option-selected"),g.toggle();var t=parseFloat(g.height()),n=parseFloat(v.css("margin-left"));g.css("top",-1*t+"px").css("margin-left",n+"px"),_(g,A())};v.on("click",function(e){e.stopPropagation(),d.hide(),g.css("display")==="none"?t():g.hide()}).on("keydown",function(e){e.stopPropagation(),d.hide(),g.scrollTop();if(g.css("display")!=="none"){e.keyCode===y?g.hide():e.keyCode===b?g.hide():(e.keyCode===w||e.keyCode===E)&&g.hide();if(e.keyCode===x){var n=A(),r=n.next();if(r.length>0){var i=r.attr("data-theme-id");n.removeClass("theme-dropdown-option-selected"),r.addClass("theme-dropdown-option-selected"),T(i,!0)}_(g,A())}else if(e.keyCode===S){var n=A(),r=n.prev();if(r.length>0){var s=r.attr("data-theme-id");n.removeClass("theme-dropdown-option-selected"),r.addClass("theme-dropdown-option-selected"),T(s,!0)}D(g,A())}}else g.css("display")==="none"&&(e.keyCode===w||e.keyCode===E)&&t()}),e(document).on("click",function(e){d.hide(),g.hide()}),e("li",g).on("click",function(t){t.stopPropagation(),d.hide(),g.children("li").removeClass("theme-dropdown-option-selected"),g.children("li").removeClass("theme-dropdown-option-hover"),e(this).addClass("theme-dropdown-option-selected"),g.toggle();var n=e(this).attr("data-theme-id");T(n,!0)})},H=function(){var t=function(e){d.toggle();var t=parseFloat(d.height()),n=parseFloat(h.css("margin-left"));d.css("top",-1*t+"px").css("margin-left",n+"px"),_(d,O())};h.on("click",function(e){e.stopPropagation(),g.hide(),d.css("display")==="none"?t():d.hide()}).on("keydown",function(e){e.stopPropagation(),g.hide(),d.scrollTop();if(d.css("display")!=="none"){e.keyCode===y?d.hide():e.keyCode===b?d.hide():(e.keyCode===w||e.keyCode===E)&&d.hide();if(e.keyCode===x){var n=O(),r=n.next();if(r.length>0){var i=r.attr("data-community-id");n.removeClass("community-dropdown-option-selected"),r.addClass("community-dropdown-option-selected"),N(i,!0)}_(d,O())}else if(e.keyCode===S){var n=O(),r=n.prev();if(r.length>0){var s=r.attr("data-community-id");n.removeClass("community-dropdown-option-selected"),r.addClass("community-dropdown-option-selected"),N(s,!0)}D(d,O())}}else d.css("display")==="none"&&(e.keyCode===w||e.keyCode===E)&&t()}),e(document).on("click",function(e){g.hide(),d.hide()}),e("li",d).on("click",function(t){t.stopPropagation(),g.hide(),d.children("li").removeClass("community-dropdown-option-selected"),d.children("li").removeClass("community-dropdown-option-hover"),e(this).addClass("community-dropdown-option-selected"),d.toggle();var n=e(this).attr("data-community-id");N(n,!0),r.publish()})},B=function(e,n,r,i){if(n&&r&&r.length>0){c=e,s=r,o=t.uniq(t.map(r,function(e){return{Id:e.CommunityId,Name:e.CommunityName}}),!1,function(e){return e.Id}),o.sort(function(e,t){return e.Name<t.Name?-1:e.Name>t.Name?1:0});for(var u=0;u<s.length;u++)s[u].IsActive&&(s[u].Name=i+" - "+s[u].Name);return s.sort(function(e,t){return e.CommunityName<t.CommunityName?-1:e.CommunityName>t.CommunityName?1:e.IsActive?-1:t.IsActive?1:e.Name<t.Name?-1:e.Name>t.Name?1:0}),M(n),T(k()),P(),H(),this}};return{initialize:B,updateTheme:C}}),define("viewUtils",["jQueryFramework","themeSwitcher","constants","cookies"],function(e,t,n,r){function a(e){return e&&e.length==1&&e[0].nodeName==="#text"}function f(e){return e.text()==""||e.text().length===1&&e.text().indexOf("​")!==-1}function l(){var e="surveySelectedThemeId",t=function(){var t=JSON.parse(n.ThemeListJsonString),i=r.getCookie(e);if(i){var s=_.find(t,function(e){return e.Id===i});if(s)return s}return t[0]},i=function(e){var t=JSON.parse(n.ThemeListJsonString),r=_.find(t,function(t){return t.Id===e});return r.CommunityId},s=t(),o=typeof s!="undefined",u=o?i(s.Id):n.RespondingContexts.length>0?n.RespondingContexts[0].CommunityId:"",a=_.find(n.RespondingContexts,function(e){return e.CommunityId===u});return{footerLinks:typeof a!="undefined"?a.FooterLinks:[],footerText:{text:o?s.ThemeValues.SurveyFooterText:n.ThemeValues.SurveyFooterText,isVisible:(o?s.ThemeValues.SurveyShowFooterText:n.ThemeValues.SurveyShowFooterText)==="true"?!0:!1}}}var i="data-template-element-id",s=function(t){var n=e(t),r=n.find("["+i+"]"),s={$root:n};return r.each(function(){var t=e(this),n=t.attr(i);t.removeAttr(i),s["$"+n]=t}),s},o=function(t){var n=function(e){return e&&typeof e=="string"&&(e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),e},r="";if(t!==""){var i="";_.each(e.parseHTML(t),function(t){i+=e(t).text()}),r=n(i)}return r},u=function(t){if(!t)return"";var n=e.parseHTML(t);if(n.length===1){var r=e.parseHTML(t)[0],i=e(r);return a(i)?t:f(i)?"":(i.css("margin",""),i[0].outerHTML)}return t};return{grabElements:s,stripHtml:o,removeC1ParagraphMargin:u,getCommunityMetaData:l}}),define("images",["constants","viewUtils"],function(e,t){var n=function(e,t,n,o,u){var a={src:"",alignment:"",imageDivClass:"",altText:"",width:0,height:0};if(e.HasImage){var f=p(e),l=i(e);a.src=c(r(e,t,n,o,u)),a.isTop=f.isImageTop,a.alignment=f.alignment,a.imageDivClass=f.imageDivClass,a.altText=s(e),a.width=l.width,a.height=l.height}return a},r=function(e,t,n,r,i){if(e.CustomQuestionProperties&&e.CustomQuestionProperties.QuestionImage&&e.CustomQuestionProperties.QuestionImage.AssetUrl){var s=t?t:e.CustomQuestionProperties.QuestionImage.Width,o=n?n:e.CustomQuestionProperties.QuestionImage.Height;return f(e.CustomQuestionProperties.QuestionImage.AssetUrl,s,o,r)}return e.ImageUrl?u(e.ImageUrl,t,n,r,i):""},i=function(e){return e.CustomQuestionProperties&&e.CustomQuestionProperties.QuestionImage&&e.CustomQuestionProperties.QuestionImage.AssetUrl?{width:e.CustomQuestionProperties.QuestionImage.Width,height:e.CustomQuestionProperties.QuestionImage.Height}:{width:25,height:25}},s=function(e){var t="";return e.CustomQuestionProperties&&e.CustomQuestionProperties.QuestionImage&&e.CustomQuestionProperties.QuestionImage.AltText&&(t=e.CustomQuestionProperties.QuestionImage.AltText),t},o=function(t,n,r,i){if(t){if(t.FileId)return f(t.AssetUrl,n,r,i);if(t.ImageId)return a(e.ImageHandlerUri,t.TenantId,t.ImageId,t.ImageSize,n,r,i)}return""},u=function(e,t,n,r,i){var s=e;i&&(s=s.replace(/\b&ar=[0-9]*\b/g,""),s=s.replace(/\b&[w|h]=[0-9]*\b/g,""));var o=t?"&w="+t:"",u=n?"&h="+n:"",a=r?"&ar="+r:"",f=s+a+o+u;return f},a=function(e,t,n,r,i,s,o){var u=i?"&w="+i:"",a=s?"&h="+s:"",f=o?"&ar="+o:"",l=e+"?tid="+t+"&id="+n+"&s="+r+u+a+f;return l},f=function(e,t,n,r){if(e){var i=e.split("/"),s=[];t&&s.push("w_"+Math.floor(t)),n&&s.push("h_"+Math.floor(n)),s.push("c_limit");var o=s.join(","),u=i.length-3;return i.splice(u,0,o),i.join("/")}return c(e)},l=function(){return location.protocol=="https:"},c=function(e){return l()?e.replace("http://","https://"):e},h=function(e,t,n){return{isImageTop:e,alignment:t,imageDivClass:n}},p=function(t){return e.IsRtlContentDirection?h(!0,"floatRight","questionImageFloatRight"):t.ImageAlignmentText==="TopLeft"?h(!0,"floatLeft","questionImageFloatLeft"):t.ImageAlignmentText==="TopRight"?h(!0,"floatRight","questionimage"):t.ImageAlignmentText==="TopCenter"?h(!0,"imagecenter","questionImageFloatLeft"):h(!1,"imagecenter","questionImageFloatLeft")};return{getQuestionImage:n,getEqfImageUrl:o,generateAssetManagerUrl:f,getQuestionImageDimensions:i}}),define("pluginHost",["data","constants","utils","event!enableDirty","event!modifyNextButtonText","event!triggerNextButton","event!triggerBackButton","jQueryFramework","underscore","localization","event!showDialog","images"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=function(e){try{if(e!==""){var t=JSON.parse(e);if(!a.isNumber(t)&&!a.isBoolean(t))return t}}catch(n){}return e},p=function(e){if(e.CustomQuestionProperties)for(var t in e.CustomQuestionProperties)e.CustomQuestionProperties[t]=h(e.CustomQuestionProperties[t]);(function(){if(e.AnswerCollection)for(var t=0;t<e.AnswerCollection.length;t++)for(var n in e.AnswerCollection[t].CustomAnswerProperties)e.AnswerCollection[t].CustomAnswerProperties[n]=h(e.AnswerCollection[t].CustomAnswerProperties[n])})(),function(){if(e.WorkflowStepCollection)for(var t=0;t<e.WorkflowStepCollection.length;t++)for(var n in e.WorkflowStepCollection[t].CustomRowProperties)e.WorkflowStepCollection[t].CustomRowProperties[n]=h(e.WorkflowStepCollection[t].CustomRowProperties[n])}()},d=function(e){if(e.CustomQuestionProperties)for(var t in e.CustomQuestionProperties){if(e[t]!==undefined)throw new Error("Plugin EQF property cannot use the same name as question property: "+t);if(e.CustomQuestionProperties.hasOwnProperty(t)){var n=e.CustomQuestionProperties[t];if(t==="QuestionImage")n!==undefined&&n!==null&&n!==""&&(e.CustomQuestionProperties[t]=JSON.parse(n));else{try{n!==undefined&&n!==null&&n!==""&&(n=JSON.parse(n.toLowerCase()))}catch(r){}e[t]=n}}}},v=function(h,v){h.StepType==="CompositeQuestion"?d(h):p(h);var m=function(e,t,n){return c.getEqfImageUrl(e,t,n)},g=function(e){var r="";n.startsWith("http://",e)||n.startsWith("https://",e)?r=e:r=t.EqfBaseUrl+"/Plugins/ExtendedQuestions/"+e+"?version="+t.SvnRevision;try{isTestPage&&(r="plugins/"+e)}catch(i){}u("<link>").appendTo(u("head")).attr({type:"text/css",rel:"stylesheet"}).attr("href",r)},y=function(e){return v?v[e]:""},b=function(){r.publish()},w=function(e){i.publish(e)},E={setExclusiveAnswer:function(t){for(var n=0;n<h.AnswerCollection.length;n++){var r=h.AnswerCollection[n];r.ObjectId===t?e.selectedByAnswerIdStepId(r.ObjectId,h.ObjectId).val(!0):e.selectedByAnswerIdStepId(r.ObjectId,h.ObjectId).val(!1)}},setAnswer:function(t,n){e.selectedByAnswerIdStepId(t,h.ObjectId).val(n)},setAnswerForRow:function(t,n,r){var i=e.selectedByAnswerIdStepId(n,t);i.val(r)},setExclusiveAnswerForRow:function(e,t){},setOpenEndText:function(t){var r=h.AnswerCollection[0].ObjectId,i=h.ObjectId,s=e.selectedByAnswerIdStepId(r,i),o=e.inputByAnswerIdStepId(r,i);s.val("true"),o.val(n.htmlEncodeString(t))},setAnswerText:function(t,r){var i=h.ObjectId,s=e.selectedByAnswerIdStepId(t,i);s.val(!0);var o=e.inputByAnswerIdStepId(t,i);o.val(n.htmlEncodeString(r))},setAnswerTextForRow:function(t,r,i){var s=e.selectedByAnswerIdStepId(r,t);s.val(!0);var o=e.inputByAnswerIdStepId(r,t);o.val(n.htmlEncodeString(i))},setAnswerJson:function(t){e.selectedByAnswerIdStepId("00000000-0000-0000-0000-000000000000",h.ObjectId).val(!0),e.inputByAnswerIdStepId("00000000-0000-0000-0000-000000000000",h.ObjectId).val(JSON.stringify(t))},getAnswer:function(t){return e.isSelectedByAnswerIdStepId(t,h.ObjectId)},getAnswerForRow:function(t,n){var r=e.selectedByAnswerIdStepId(n,t);return r.val()==="true"},getOpenEndText:function(){var t=h.AnswerCollection[0].ObjectId,n=e.inputByAnswerIdStepId(t,h.ObjectId);return n.val()},getAnswerText:function(t){var n=e.inputByAnswerIdStepId(t,h.ObjectId);return n.val()},getAnswerTextForRow:function(t,n){var r=e.inputByAnswerIdStepId(n,t);return r.val()},isValidResponse:function(t,n,r,i,s,o,u){return e.isValidResponse(t,n,r,i,s,o,u)},getAnswerJson:function(){var t=e.inputByAnswerIdStepId("00000000-0000-0000-0000-000000000000",h.ObjectId),n=t.val();return n===""?{}:JSON.parse(n)}},S=function(){return{IsValid:!0,Messages:[]}},x=function(e,t){return{Text:e,IsUnique:t}},T=function(e){var t=[];return a.isString(e)?t=[x(e,!1)]:a.isArray(e)?t=e:a.isObject(e)&&(t=[e]),{IsValid:!1,Messages:t}},N=function(){s.publish()},C=function(){o.publish()},k=function(e){l.publish(e)};return{questionDefinition:h,getImage:m,loadCss:g,getLocalizedString:y,dataStore:E,completionStatusChanged:b,modifyNextButton:w,validationPassed:S,validationFailed:T,validationFailedMessage:x,parseFloat:f.parseFloat,formatFloat:f.formatFloat,parseDate:f.parseDate,formatDate:f.formatDate,triggerNext:N,triggerBack:C,showDialog:k}};return{createPluginHost:v}}),define("scriptingData",[],function(){var e=function(){return window.vcScriptingData};return{getScriptingData:e}}),function(e,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define("panzoom",[],t):(e=typeof globalThis!="undefined"?globalThis:e||self,e.Panzoom=t())}(this,function(){function t(e,t){var n=e.length;while(n--)if(e[n].pointerId===t.pointerId)return n;return-1}function n(e,r){var i;if(r.touches){i=0;for(var s=0,o=r.touches;s<o.length;s++){var u=o[s];u.pointerId=i++,n(e,u)}return}i=t(e,r),i>-1&&e.splice(i,1),e.push(r)}function r(e,n){if(n.touches){while(e.length)e.pop();return}var r=t(e,n);r>-1&&e.splice(r,1)}function i(e){e=e.slice(0);var t=e.pop(),n;while(n=e.pop())t={clientX:(n.clientX-t.clientX)/2+t.clientX,clientY:(n.clientY-t.clientY)/2+t.clientY};return t}function s(e){if(e.length<2)return 0;var t=e[0],n=e[1];return Math.sqrt(Math.pow(Math.abs(n.clientX-t.clientX),2)+Math.pow(Math.abs(n.clientY-t.clientY),2))}function u(e,t,n,r){o[e].split(" ").forEach(function(e){t.addEventListener(e,n,r)})}function a(e,t,n){o[e].split(" ").forEach(function(e){t.removeEventListener(e,n)})}function c(){return l?l:l=document.createElement("div").style}function d(e){if(p[e])return p[e];var t=c();if(e in t)return p[e]=e;var n=e[0].toUpperCase()+e.slice(1),r=h.length;while(r--){var i=""+h[r]+n;if(i in t)return p[e]=i}}function v(e,t){return parseFloat(t[d(e)])||0}function m(e,t,n){n===void 0&&(n=window.getComputedStyle(e));var r=t==="border"?"Width":"";return{left:v(t+"Left"+r,n),right:v(t+"Right"+r,n),top:v(t+"Top"+r,n),bottom:v(t+"Bottom"+r,n)}}function g(e,t,n){e.style[d(t)]=n}function y(e,t){var n=d("transform");g(e,"transition",n+" "+t.duration+"ms "+t.easing)}function b(e,t,n){var r=t.x,i=t.y,s=t.scale,o=t.isSVG;g(e,"transform","scale("+s+") translate("+r+"px, "+i+"px)");if(o&&f){var u=window.getComputedStyle(e).getPropertyValue("transform");e.setAttribute("transform",u)}}function w(e){var t=e.parentNode,n=window.getComputedStyle(e),r=window.getComputedStyle(t),i=e.getBoundingClientRect(),s=t.getBoundingClientRect();return{elem:{style:n,width:i.width,height:i.height,top:i.top,bottom:i.bottom,left:i.left,right:i.right,margin:m(e,"margin",n),border:m(e,"border",n)},parent:{style:r,width:s.width,height:s.height,top:s.top,bottom:s.bottom,left:s.left,right:s.right,padding:m(t,"padding",r),border:m(t,"border",r)}}}function E(e){var t=e.ownerDocument,n=e.parentNode;return t&&n&&t.nodeType===9&&n.nodeType===1&&t.documentElement.contains(n)}function S(e){return(e.getAttribute("class")||"").trim()}function x(e,t){return e.nodeType===1&&(" "+S(e)+" ").indexOf(" "+t+" ")>-1}function T(e,t){for(var n=e;n!=null;n=n.parentNode)if(x(n,t.excludeClass)||t.exclude.indexOf(n)>-1)return!0;return!1}function C(e){return N.test(e.namespaceURI)&&e.nodeName.toLowerCase()!=="svg"}function k(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function A(t,f){function p(e){e===void 0&&(e={});for(var n in e)e.hasOwnProperty(n)&&(f[n]=e[n]);e.hasOwnProperty("cursor")&&(t.style.cursor=e.cursor),e.hasOwnProperty("overflow")&&(c.style.overflow=e.overflow),e.hasOwnProperty("touchAction")&&(c.style.touchAction=e.touchAction,t.style.touchAction=e.touchAction),(e.hasOwnProperty("minScale")||e.hasOwnProperty("maxScale")||e.hasOwnProperty("contain"))&&N()}function S(e,n,r){if(r.silent)return;var i=new CustomEvent(e,{detail:n});t.dispatchEvent(i)}function x(e,n){var r={x:d,y:v,scale:m,isSVG:l};return requestAnimationFrame(function(){typeof n.animate=="boolean"&&(n.animate?y(t,n):g(t,"transition","none")),n.setTransform(t,r,n)}),S(e,r,n),S("panzoomchange",r,n),r}function N(){if(f.contain){var e=w(t),n=e.parent.width-e.parent.border.left-e.parent.border.right,r=e.parent.height-e.parent.border.top-e.parent.border.bottom,i=e.elem.width/m,s=e.elem.height/m,o=n/i,u=r/s;f.contain==="inside"?f.maxScale=Math.min(o,u):f.contain==="outside"&&(f.minScale=Math.max(o,u))}}function A(n,r,i,s){var o=e(e({},f),s),u={x:d,y:v,opts:o};if(!o.force&&(o.disablePan||o.panOnlyWhenZoomed&&m===o.startScale))return u;n=parseFloat(n),r=parseFloat(r),o.disableXAxis||(u.x=(o.relative?d:0)+n),o.disableYAxis||(u.y=(o.relative?v:0)+r);if(o.contain==="inside"){var a=w(t);u.x=Math.max(-a.elem.margin.left-a.parent.padding.left,Math.min(a.parent.width-a.elem.width/i-a.parent.padding.left-a.elem.margin.left-a.parent.border.left-a.parent.border.right,u.x)),u.y=Math.max(-a.elem.margin.top-a.parent.padding.top,Math.min(a.parent.height-a.elem.height/i-a.parent.padding.top-a.elem.margin.top-a.parent.border.top-a.parent.border.bottom,u.y))}else if(o.contain==="outside"){var a=w(t),l=a.elem.width/m,c=a.elem.height/m,h=l*i,p=c*i,g=(h-l)/2,y=(p-c)/2,b=(-(h-a.parent.width)-a.parent.padding.left-a.parent.border.left-a.parent.border.right+g)/i,E=(g-a.parent.padding.left)/i;u.x=Math.max(Math.min(u.x,E),b);var S=(-(p-a.parent.height)-a.parent.padding.top-a.parent.border.top-a.parent.border.bottom+y)/i,x=(y-a.parent.padding.top)/i;u.y=Math.max(Math.min(u.y,x),S)}return u}function O(t,n){var r=e(e({},f),n),i={scale:m,opts:r};return!r.force&&r.disableZoom?i:(i.scale=Math.min(Math.max(t,r.minScale),r.maxScale),i)}function M(e,t,n){var r=A(e,t,m,n),i=r.opts;return d=r.x,v=r.y,x("panzoompan",i)}function _(e,t){var n=O(e,t),r=n.opts;if(!r.force&&r.disableZoom)return;e=n.scale;var i=d,s=v;if(r.focal){var o=r.focal;i=(o.x/e-o.x/m+d*e)/e,s=(o.y/e-o.y/m+v*e)/e}var u=A(i,s,e,{relative:!1,force:!0});return d=u.x,v=u.y,m=e,x("panzoomzoom",r)}function D(t,n){var r=e(e(e({},f),{animate:!0}),n);return _(m*Math.exp((t?1:-1)*r.step),r)}function P(e){return D(!0,e)}function H(e){return D(!1,e)}function B(n,r,i){var s=w(t),o={width:s.parent.width-s.parent.padding.left-s.parent.padding.right-s.parent.border.left-s.parent.border.right,height:s.parent.height-s.parent.padding.top-s.parent.padding.bottom-s.parent.border.top-s.parent.border.bottom},u=r.clientX-s.parent.left-s.parent.padding.left-s.parent.border.left-s.elem.margin.left,a=r.clientY-s.parent.top-s.parent.padding.top-s.parent.border.top-s.elem.margin.top;l||(u-=s.elem.width/m/2,a-=s.elem.height/m/2);var f={x:u/o.width*o.width*n,y:a/o.height*o.height*n};return _(n,e(e({animate:!1},i),{focal:f}))}function j(t,n){t.preventDefault();var r=e(e({},f),n),i=t.deltaY===0&&t.deltaX?t.deltaX:t.deltaY,s=i<0?1:-1,o=O(m*Math.exp(s*r.step/3),r).scale;return B(o,t,r)}function F(t){var n=e(e(e({},f),{animate:!0,force:!0}),t);m=O(n.startScale,n).scale;var r=A(n.startX,n.startY,m,n);return d=r.x,v=r.y,x("panzoomreset",n)}function $(e){if(T(e.target,f))return;n(X,e),b=!0,f.multiTouchPan||f.handleStartEvent(e),I=d,q=v,S("panzoomstart",{x:d,y:v,scale:m},f);var t=i(X);R=t.clientX,U=t.clientY,z=m,W=s(X),h=0}function J(e){if(!b||I===undefined||q===undefined||R===undefined||U===undefined)return;n(X,e);var t=i(X);if(X.length>1){var r=s(X)-W;h===0&&(h=r);if(!(!f.multiTouchPan||Math.abs(Math.ceil(h)-Math.ceil(r))>V)){M(I+(t.clientX-R)/m,q+(t.clientY-U)/m,{animate:!1});return}var o=O(r*f.step/80+z).scale;B(o,t)}f.multiTouchPan||M(I+(t.clientX-R)/m,q+(t.clientY-U)/m,{animate:!1})}function K(e){X.length===1&&S("panzoomend",{x:d,y:v,scale:m},f),r(X,e);if(!b)return;b=!1,I=q=R=U=undefined}function G(){if(Q)return;Q=!0,u("down",f.canvas?c:t,$),u("move",document,J,{passive:!0}),u("up",document,K,{passive:!0})}function Y(){Q=!1,a("down",f.canvas?c:t,$),a("move",document,J),a("up",document,K)}if(!t)throw new Error("Panzoom requires an element as an argument");if(t.nodeType!==1)throw new Error("Panzoom requires an element with a nodeType of 1");if(!E(t))throw new Error("Panzoom should be called on elements that have been attached to the DOM");f=e(e({},L),f);var l=C(t),c=t.parentNode,h=0;c.style.overflow=f.overflow,c.style.userSelect="none",c.style.touchAction=f.touchAction,(f.canvas?c:t).style.cursor=f.cursor,t.style.userSelect="none",t.style.touchAction=f.touchAction,g(t,"transformOrigin",typeof f.origin=="string"?f.origin:l?"0 0":"50% 50%");var d=0,v=0,m=1,b=!1;_(f.startScale,{animate:!1}),setTimeout(function(){N(),M(f.startX,f.startY,{animate:!1})});var I,q,R,U,z,W,X=[],V=20,Q=!1;return f.noBind||G(),{bind:G,destroy:Y,eventNames:o,getPan:function(){return{x:d,y:v}},getScale:function(){return m},getOptions:function(){return k(f)},pan:M,reset:F,setOptions:p,setStyle:function(e,n){return g(t,e,n)},zoom:_,zoomIn:P,zoomOut:H,zoomToPoint:B,zoomWithWheel:j}}var e=function(){return e=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},e.apply(this,arguments)};typeof window!="undefined"&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),typeof window.CustomEvent!="function"&&(window.CustomEvent=function(t,n){n=n||{bubbles:!1,cancelable:!1,detail:null};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),r}));var o={down:"mousedown",move:"mousemove",up:"mouseup mouseleave"};typeof window!="undefined"&&(typeof window.PointerEvent=="function"?o={down:"pointerdown",move:"pointermove",up:"pointerup pointerleave pointercancel"}:typeof window.TouchEvent=="function"&&(o={down:"touchstart",move:"touchmove",up:"touchend touchcancel"}));var f=typeof document!="undefined"&&!!document.documentMode,l,h=["webkit","moz","ms"],p={},N=/^http:[\w\.\/]+svg$/,L={animate:!1,canvas:!1,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,duration:200,easing:"ease-in-out",exclude:[],excludeClass:"panzoom-exclude",multiTouchPan:!1,handleStartEvent:function(e){e.preventDefault(),e.stopPropagation()},maxScale:4,minScale:.125,overflow:"hidden",panOnlyWhenZoomed:!0,relative:!1,setTransform:b,startX:0,startY:0,startScale:1,step:.3,touchAction:"none"};return A.defaultOptions=L,A}),define("pluginsShared/Image/Mobile/js/imageZoomUtil",["jQueryFramework","panzoom","constants"],function(e,t,n){var r,i=[],s,o,u=[],a,f,l=!1,c=n.IsRtlContentDirection?"to left":"to right",h=0,p=function(t,n){s=e(t),u[h]=n;if(s.find(".zoomImage").length<=0)return;a=u[h].pen.options.size,f=u[h].cursor.penOptions.penSize,d()},d=function(){var n=e("<div class='zoomDiv'></div>"),r=e("<div class='sliderDiv'></div>"),u=e("<div class='minus'></div>");o=e('<input class="range-input svgRange" type="range" min="1" max="5" step="0.1" value="1" id="'+h+'">');var a=e("<div class='plus'></div>");r.append(u),r.append(o),r.append(a),n.append(r),s.append(n);var f=e("svg")[0],c=f.getScreenCTM();const p=c?s.find(".zoomImage")[0]:s.find("svg")[0];l=!c,i[h]=t(p,{maxScale:5,easing:"ease",multiTouchPan:!0}),o.css("bottom",c?"-1.25em":"-1.8em"),o.on("input",y),s.find(".controlsToolbar").css("display","none"),s.find(".zoomImage")[0].addEventListener("panzoomchange",v),h++},v=function(t){t.preventDefault(),o=e(".highlighterContainer:visible").find(".svgRange"),o.val(t.detail.scale),g(t.detail.scale,o.attr("id"))},m=function(e){e.preventDefault(),o.val(e.detail.scale),T(e.detail.scale)},g=function(t,n){var r=(t-1)/4*100;l||e(o[n]).css("background","linear-gradient("+c+", rgba(85, 117, 199, 1), rgba(85, 117, 199, 1) "+r+"%, rgba(0, 0, 0, 0.4) "+r+"%, rgba(0, 0, 0, 0.4) 100%)"),u[n]&&(u[n].pen.options.size=a/t,u[n].cursor.penOptions.penSize=f/t,u[n].pen.options.scaleVal=u[n].cursor.penOptions.scaleVal=parseFloat(t))},y=function(t){var n=e(t.target).val();i[t.target.id].zoom(n),g(n,t.target.id)},b=function(){for(var t=0;t<h;t++)e(".highlighterContainer").find(".svgRange")[t].value="1",i[t].reset(),u[t].pen.options.size=a,u[t].cursor.penOptions.penSize=f,u[t].pen.options.scaleVal=u[t].cursor.penOptions.scaleVal=1},w=function(){b(),this.dispatchEvent(new CustomEvent("CloseZoomWindow",{bubbles:!0,detail:{text:function(){return"Zoom Feature Closed"}}}))},E=function(t,n){s=e(t);if(s.find(".zoomImage").length<=0)return;s.css("position","relative"),s.append('<img class="search-button" alt="zoom" role="button"/>');var r=s.find(".zoomImage");s.find(".search-button").on("click",{src:r[0].src,alt:r[0].alt,originalSrc:n},S)},S=function(n){if(e("#visioncritical-mainView").find(".fullScreenImage").length>0)return;var i=e("<div class='fullScreenImage'></div>"),s=e("<div class='zoomDiv'></div>"),u=e('<img class="ui image zoomElement" src="'+n.data.originalSrc+'" alt="'+n.data.alt+'"/>'),a=e('<img class="closeFullScreenImage" alt="close" role="button"/>'),f=e("<div class='minus alt'></div>");o=e('<input class="range-input" type="range" min="1" max="5" step="0.1" value="1">');var l=e("<div class='plus alt'></div>");s.append(u),s.append(a),s.append(f),s.append(o),s.append(l),i.append(s),e("#visioncritical-pageView").append(i),i.find(".zoomElement")[0].onload=function(){var t=this.height,n=e(this)[0].parentElement.offsetHeight,r=(n-t)/n*100/2;e(this).css("top",r+"%")},r=t(i.find(".zoomElement")[0],{maxScale:5,easing:"ease"}),o.css({height:"4px",bottom:"0.5em"}),o.on("input",x),a.on("click",N),i.find(".zoomElement")[0].addEventListener("panzoomchange",m),i[0].addEventListener("wheel",t.zoomWithWheel)},x=function(t){var n=e(t.target).val();r.zoom(n),T(n)},T=function(e){var t=(e-1)/4*100;o.css("background","linear-gradient("+c+", rgba(85, 117, 199, 1), rgba(85, 117, 199, 1) "+t+"%, rgba(0, 0, 0, 0.4) "+t+"%, rgba(0, 0, 0, 0.4) 100%)")},N=function(){r.reset(),e(".fullScreenImage").remove()};return{enableImageZoom:E,enableSvgZoom:p,resetSvgZoom:b}}),define("page",["constants","pluginRegistry","pluginHost","step","scriptingData","underscore","pluginsShared/Image/Mobile/js/imageZoomUtil","utils"],function(e,t,n,r,i,s,o,u){var a=function(){return r.getStep().IsPage?r.getStep().WorkflowStepCollection:[r.getStep()]},f=function(){if(e.HasPreviousStep!=="true")return!1;var t=r.getStep();return t.IsPage?t.AllowedBack:t.AllowBackButton},l=[],c=function(e){return s.find(l,function(t){return t.definition.ObjectId===e})},h=function(){var e=r.getStep();return e.IsPage?[e].concat(r.getStep().WorkflowStepCollection):[e]},p=function(){var e=r.getStep(),t=null;e.IsPage?t=e.WorkflowStepCollection:t=[e];var n=s.chain(t).map(function(e){return e.WorkflowStepCollection&&e.WorkflowStepCollection.length>0?[e].concat(e.WorkflowStepCollection):[e]}).flatten().value();return[e].concat(n)},d=function(){return l.concat([])},v=function(r){var i=a(),s=[];for(var f=0;f<i.length;f++)s.push(t.getPluginForQuestion(i[f]));for(var f=0;f<i.length;f++){var c=n.createPluginHost(i[f],s[f].localizations),h=s[f].plugin.create(c);if(h.definition!==undefined)throw"Plugin must not define a 'definition' property";if(h.getLocalizedString!==undefined)throw"Plugin must not define a 'getLocalizedString' property";h.getLocalizedString=c.getLocalizedString,h.definition=c.questionDefinition,l.push(h);if(h.createView!==undefined){var p=r(i[f].ObjectId),d=h.createView(),v=i[f].CustomQuestionProperties&&i[f].CustomQuestionProperties.QuestionImage&&i[f].CustomQuestionProperties.QuestionImage.AssetUrl?i[f].CustomQuestionProperties.QuestionImage.AssetUrl:null;p.append(d),e.IsMobile&&u.isFeatureToggleEnabled("Toggles+RespondingUXEnhancements")&&o.enableImageZoom($(d).closest(".visioncritical-questiontext"),v)}m(i[f],d,h)}},m=function(t,n,r){if(!u.isQ3SurveyRespondingUXImprovementsEnabled())return;if(!e.IsMobile){if(t.RespondingPlugin==="InstructionPlugin"){var i=$("#"+r.getObjectId());i.children('div[class="questionbody"]').remove();return}if(n!==undefined&&n.hasClass("survey-page-divider-no-margin")){n.closest('div[class="questionbody"]').css({padding:"0px"});return}if(t.StepType==="WorkflowTerminus"||t.StepType==="TerminationPoint"){b(n);return}g(r)}else{var i=$("[data-question-id="+r.definition.ObjectId+"]"),s=i.children('div[class="visioncritical-questiontext"]');if(s.children().length>0){var o=i.children($("#"+r.definition.ObjectId+" > div"));o.length>1?y(s):$("#qheader-"+r.definition.ObjectId).css({"padding-bottom":"16px"})}var a=i.children('div[class="visioncritical-image-upload"]');a.children().length>0&&a.children("div.ui").addClass("imageupload-border"),$("#divider_"+r.definition.ObjectId).parent().css({padding:"0",margin:"0",border:"0"}),u.isQ3SurveyRespondingUXImprovementsEnabled()&&$("div.plugin-root").length===1&&r.definition.Name==="Image Upload"&&$("#"+r.definition.ObjectId).css({"margin-bottom":"64px"})}},g=function(e){var t=$("#"+e.getObjectId()).children('div[class="questionheader"]');y(t)},y=function(e){var t=$("<hr class = 'question-underline'/>");e.after(t)},b=function(e){var t=e.closest('div[class="question"]');t.children('div[class="questionheader"]').remove()},w=function(){for(var e=0;e<l.length;e++)l[e].addedToPage!==undefined&&l[e].addedToPage()},E=function(e){return s.any(p(),function(t){return t.ObjectId===e})},S=function(){return s.chain(i.getScriptingData().ReferencedSteps).map(function(e){return e.IsPage?s.flatten([[e],e.WorkflowStepCollection]):[e]}).flatten().value()},x=function(e){var t=S();return s.find(t,function(t){return t.ObjectId==e})},T=function(){var e=a();return e.length===1&&(e[0].StepType==="WorkflowTerminus"||e[0].StepType==="TerminationPoint")};return{createQuestions:v,pageReady:w,getAllQuestionPlugins:d,getAllNonPageQuestionDefinitions:a,getAllReferencedSteps:S,getAllPageOrQuestionDefinitions:h,getAllPageOrQuestionOrRowDefinitions:p,getPluginInstanceByQuestionId:c,findReferencedStepById:x,isStepOnPage:E,isBackButtonVisible:f,isTermination:T}}),define("scriptingLibrary",[],function(){var e=function(e){},t=function(e){},n=function(e){},r=function(e){},i=function(e){},s=function(e){};return{extendScriptHost:e,extendQuestion:t,extendAnswer:i,extendGrid:n,extendAllocation:r,extendPage:s,isBlankLibrary:!0}}),define("scriptingFormElements",["jQueryFramework","underscore","scriptingData","page","utils","constants"],function(e,t,n,r,i,s){function d(e,r){var i=n.getScriptingData().ResponseData;return t.any(i,function(t){return t.StepId===e&&t.AnswerId===r})}function v(e,r){var i=t.find(n.getScriptingData().ResponseData,function(t){return t.StepId===e&&t.AnswerId===r}),s=0;i!==undefined?s=i.AnswerState:(i=t.find(n.getScriptingData().AllDataPoints,function(t){return t.StepId===e&&t.AnswerId===r}),i!==undefined&&(s=i.AnswerState));switch(s){case 1:return"Showed";case 2:return"Masked";case 3:return"AutoPunch";default:return"None"}}function m(e,r){var i=n.getScriptingData().ResponseData,s=t.find(i,function(t){return t.StepId===e&&t.AnswerId===r});return s===undefined?"":s.DateTimeValue!==null?s.DateTimeValue:s.NumericValue!==null?s.NumericValue:s.TextValue}var o={},u=-1,a,f=function(t,n){var r=l(t,n);return e("#"+r).size()>0},l=function(e,t){return"dp_"+t+"_e_"+e},c=function(e,t){return l(e,t)+"_isselected"},h=function(e,t){return l(e,t)+"_state"},p=function(t,n){var r=o[t],i=c(r,n),s=e("#"+i);return s.size()===0?d(t,n):s.val()==="true"},g=function(t,n,r){var s=o[t],u=l(s,n),a=e("#"+u),f=a.size()===0?i.encodeAndLocalizeDataPointValue(m(t,n),r):a.val();return f},y=function(t,n,r,s){if(f(r,n)===!0)return;var o=l(r,n),u=c(r,n),p=h(r,n),g=i.encodeAndLocalizeDataPointValue(m(t,n),s),y=d(t,n),b=v(t,n),w=e(i.formatString("<input type='hidden' name='{0}' id='{1}' value='{2}' />",[o,o,g])),E=e(i.formatString("<input type='hidden' name='{0}' id='{1}' value='{2}' />",[u,u,y])),S=e(i.formatString("<input type='hidden' name='{0}' id='{1}' value='Scripting,{2}' />",[p,p,b]));a.append(w).append(E).append(S)},b=function(e){return o[e]!==undefined},w=function(n){if(b(n))return;a===undefined&&(a=e("<div id='scriptingDataPoints'></div>"),e("#"+s.SurveyFormId).append(a));var f=!1,l=r.getAllReferencedSteps(),c;t.each(l,function(e){if(e.ObjectId===n){f=!1,c=e;return}e.WorkflowStepCollection&&!e.IsPage&&e.WorkflowStepCollection.length>0&&t.each(e.WorkflowStepCollection,function(t){if(t.ObjectId===n){f=!0,c=e;return}})});var h=function(n){u+=1;var r=u;p=i.formatString("vc_evts{0}",[n]),d=e(i.formatString("<input type='hidden' name='{0}' id='{1}' value='{2}' />",[p,p,r])),a.append(d),o[n]=r;var s=c.AnswerAmount?[c.AnswerAmount]:c.AnswerCollection;t.each(s,function(e){y(n,e.ObjectId,r,e.TextValidationType)})},p,d;f?t.each(c.WorkflowStepCollection,function(e){h(e.ObjectId)}):h(c.ObjectId)},E=function(t,n,r){w(t);var i=o[t],u=c(i,n),a=e("#"+u);a.val(r?"true":"false"),T(i,n,s.dpNone)},S=function(t,n,r){w(t);var i=o[t],u=l(i,n),a=e("#"+u);a.val(r),T(i,n,s.dpNone)},x=function(e,t){w(e);var n=o[e];T(n,t,s.dpMasked)},T=function(t,n,r){var i=e("#"+h(t,n));i.val(s.dpResponderScripting+","+r)};return{setDataPoint:E,setDataPointTextValue:S,isDataPointSelected:p,getDataPointTextValue:g,mask:x}}),define("scriptableDataPoint",["scriptingFormElements","step","data","utils","page"],function(e,t,n,r,i){var s=function(t,i){var s=n.inputByAnswerIdStepId(i.ObjectId,t.ObjectId).length>0,o=function(){return s?n.isSelectedByAnswerIdStepId(i.ObjectId,t.ObjectId):e.isDataPointSelected(t.ObjectId,i.ObjectId)},u=function(){s?(n.selectedByAnswerIdStepId(i.ObjectId,t.ObjectId).val(!0),h()):e.setDataPoint(t.ObjectId,i.ObjectId,!0)},a=function(){s?(n.selectedByAnswerIdStepId(i.ObjectId,t.ObjectId).val(!1),h()):e.setDataPoint(t.ObjectId,i.ObjectId,!1)},f=function(o){var u=r.encodeAndLocalizeDataPointValue(o,i.TextValidationType);s?(n.inputByAnswerIdStepId(i.ObjectId,t.ObjectId).val(u),h()):e.setDataPointTextValue(t.ObjectId,i.ObjectId,u)},l=function(){var o;return s?o=n.inputByAnswerIdStepId(i.ObjectId,t.ObjectId).val():o=e.getDataPointTextValue(t.ObjectId,i.ObjectId,i.TextValidationType),r.decodeAndParseDataPointValue(o,i.TextValidationType)},c=function(){if(s){var r=n.stateByAnswerIdStepId(i.ObjectId,t.ObjectId);r.val(constants.dpResponderScripting+","+constants.dpMasked)}else e.mask(t.ObjectId,i.ObjectId)},h=function(){var e=n.stateByAnswerIdStepId(i.ObjectId,t.ObjectId);e.val(e.val().replace(/^.*?,/gi,constants.dpResponderScripting+","))};return{AnswerId:i.ObjectId,QuestionId:t.ObjectId,RawQuestionDefinition:t,RawAnswerDefinition:i,isSelected:o,select:u,unselect:a,getValue:l,setValue:f,mask:c}};return{createDataPoint:s}}),define("scriptableAnswer",["underscore","scriptableDataPoint","scriptingLibrary"],function(e,t,n){var r=function(r,i){var s=function(){return r.WorkflowStepCollection&&r.WorkflowStepCollection.length>0?e.map(r.WorkflowStepCollection,function(e){return t.createDataPoint(e,i)}):[t.createDataPoint(r,i)]},o={RawDefinition:i,getAllDataPoints:s};return n.extendAnswer(o),o};return{createScriptableAnswer:r}}),define("scriptableQuestion",["underscore","scriptableDataPoint","scriptableAnswer","scriptingLibrary"],function(e,t,n,r){var i=function(i){var s=function(){return e.map(i.AnswerCollection,function(e){return t.createDataPoint(i,e)})},o=function(){return e.map(i.AnswerCollection,function(e){return n.createScriptableAnswer(i,e)})},u={RawDefinition:i,Answers:o(),getAllDataPoints:s};return r.extendQuestion(u),u};return{createScriptableQuestion:i}}),define("scriptableRow",["underscore","scriptableDataPoint"],function(e,t){var n=function(n,r){var i=function(){return e.map(n,function(e){return t.createDataPoint(r,e)})};return{RawDefinition:r,getAllDataPoints:i}};return{createScriptableRow:n}}),define("scriptableGrid",["underscore","scriptableDataPoint","scriptableRow","scriptableAnswer","scriptingLibrary"],function(e,t,n,r,i){var s=function(s){var o=function(){var n=[];return e.each(s.WorkflowStepCollection,function(r){e.each(s.AnswerCollection,function(e){n.push(t.createDataPoint(r,e))})}),n},u=function(){return e.map(s.WorkflowStepCollection,function(e){return n.createScriptableRow(s.AnswerCollection,e)})},a=function(){return e.map(s.AnswerCollection,function(e){return r.createScriptableAnswer(s,e)})},f={RawDefinition:s,Rows:u(),Columns:a(),getAllDataPoints:o};return i.extendGrid(f),f};return{createScriptableGrid:s}}),define("scriptableAllocation",["underscore","constants","scriptableDataPoint","scriptableRow","scriptableAnswer","scriptingLibrary"],function(e,t,n,r,i,s){var o=function(t){var o=function(){var r=[];return e.each(t.WorkflowStepCollection,function(e){r.push(n.createDataPoint(e,t.AnswerAmount))}),r},u=function(){return e.map(t.WorkflowStepCollection,function(e){return r.createScriptableRow([t.AnswerAmount],e)})},a=function(){return[i.createScriptableAnswer(t,t.AnswerAmount)]},f={RawDefinition:t,Rows:u(),Columns:a(),getAllDataPoints:o};return s.extendAllocation(f),f};return{createScriptableAllocation:o}}),define("scriptablePage",["underscore","scriptableDataPoint","scriptableQuestion","scriptingLibrary"],function(e,t,n,r){var i=function(t,n){var i=function(){var t=e.chain(n).map(function(e){return e.getAllDataPoints()}).flatten().value();return t},s={RawDefinition:t,Questions:n,getAllDataPoints:i};return r.extendPage(s),s};return{createScriptablePage:i}}),define("scriptableObjectFactory",["scriptableQuestion","scriptableGrid","scriptableAllocation","scriptablePage","underscore"],function(e,t,n,r,i){var s=function(o){if(o.IsPage){var u=i.map(o.WorkflowStepCollection,s);return r.createScriptablePage(o,u)}return o.AnswerAmount?n.createScriptableAllocation(o):o.WorkflowStepCollection&&o.WorkflowStepCollection.length>0?t.createScriptableGrid(o):e.createScriptableQuestion(o)};return{createScriptableObject:s}}),define("scriptHost",["scriptingLibrary","scriptableObjectFactory","scriptingData","page","constants","event!triggerNextButton","event!triggerBacktButton"],function(e,t,n,r,i,s,o){var u=function(u){var a=n.getScriptingData(),f=_.filter(a.ReferencedSteps,function(e){return e.ObjectId!==u.ObjectId}).concat(r.getAllPageOrQuestionDefinitions()),l=_.chain(f).map(function(e){return[e.Name,t.createScriptableObject(e)]}).object().value(),c=r.findReferencedStepById(u.ObjectId),h=t.createScriptableObject(c),p=function(){s.publish()},d=function(){o.publish()},v={Questions:l,CurrentAuthoredStep:h,IsMobile:i.IsMobile,triggerNext:p,triggerBack:d};return e.extendScriptHost(v),v};return{create:u}}),define("scriptRegistry",[],function(){var e=[],t=function(t){e=t},n=function(t){for(var n=0;n<e.length;n++)if(e[n].name===t)return e[n].script;return""};return{initialize:t,getScript:n}}),define("scripting",["constants","scriptHost","scriptableObjectFactory","page","step","scriptRegistry","underscore"],function(e,t,n,r,i,s,o){var u=function(n,r){if(e.IsScriptingEnabled!=="true")return!0;var i=s.getScript(r);return i===""||i===null||i===undefined?!0:i.run(t.create(n))},a=function(){return o.chain(r.getAllNonPageQuestionDefinitions()).map(n.createScriptableObject).value()},f=function(e,t){var n=e.replace(/[^a-zA-Z0-9]+/g,"").replace(/\s+/g,"")+"_"+t.replace(/-/g,"");return n},l=function(){var e=r.getAllNonPageQuestionDefinitions();for(var t=0;t<e.length;t++)u(e[t],"OnLoad_"+f(e[t].Name,e[t].ObjectId));var n=i.getStep();n.IsPage&&u(n,"OnLoad_"+f(n.Name,n.ObjectId))},c=function(){var e=r.getAllNonPageQuestionDefinitions(),t=i.getStep();for(var n=0;n<e.length;n++)u(e[n],"OnClientRendered_"+f(e[n].Name,e[n].ObjectId));t.IsPage&&u(t,"OnClientRendered_"+f(t.Name,t.ObjectId))},h=function(){var e=r.getAllNonPageQuestionDefinitions(),t=i.getStep();if(t.IsPage)for(var n=0;n<e.length;n++){var s=u(e[n],"OnValidate_"+f(e[n].Name,e[n].ObjectId));if(s===!1)return!1}return u(t,"OnValidate_"+f(t.Name,t.ObjectId))},p=function(){var e=r.getAllNonPageQuestionDefinitions(),t=i.getStep();if(t.IsPage)for(var n=0;n<e.length;n++)u(e[n],"OnExit_"+f(e[n].Name,e[n].ObjectId));u(t,"OnExit_"+f(t.Name,t.ObjectId))};return{executeScript:u,executeOnLoadScripts:l,executeOnClientRenderedScripts:c,executeOnValidateScripts:h,executeOnExitScripts:p,getScriptableCurrentQuestions:a}}),define("embedContentRegistry",["event!enableDirty","underscore"],function(e,t){var n=0,r=0,i=function(e){e.WorkflowStepCollection&&e.WorkflowStepCollection.length>0&&t.each(e.WorkflowStepCollection,function(e){e.RespondingPlugin=="EmbeddedContentPlugin"&&n++}),r=n},s=function(){if(u())return;++r,e.publish()},o=function(){if(!u()&&r===0)return;--r,e.publish()},u=function(){return r===n};return{init:i,setComplete:s,setIncomplete:o,isComplete:u}}),define("navViewModel",["scripting","page","data","event!triggerNextButton","event!triggerBackButton","event!aboutToSubmit","event!aboutToValidate","embedContentRegistry","underscore"],function(e,t,n,r,i,s,o,u,a){var f=function(){var f=!1,l=!1,c=[],h=function(){var e=m();b(e)},p=function(e){var t=[];a.each(e,function(e){a.isObject(e)&&a.each(e.Messages,function(e){t.push(e)})});var n={};return a.chain(t).filter(function(e){return e.IsUnique?n[e.Text]?!1:(n[e.Text]=!0,!0):!0}).map(function(e){return e.Text}).value()},d=function(e){var t=a.map(e,function(e){if(a.isBoolean(e))return e;if(a.isObject(e))return e.IsValid;throw"Unexpected validation result from plugin"});for(var n=0;n<t.length;n++)if(!t[n])return!1;return!0},v=function(){var e=a.map(t.getAllQuestionPlugins(),function(e){return e.isComplete()});return e.push(u.isComplete()),e},m=function(){var e=v();return c=p(e),d(e)},g=function(){return e.executeOnValidateScripts()},y=function(){return e.executeOnExitScripts()},b=function(e){l=e},w=function(){return l},E=function(){f=!0},S=function(){return!f},x=function(){return!f&&l},T=function(){return t.isBackButtonVisible()},N=function(){return c},C=function(){if(x()){o.publish();if(g())return y(),s.publish(),E(),n.submitNext(),!0}return!1},k=function(){return S()?(o.publish(),s.publish(),E(),n.submitBack(),!0):!1};return r.subscribe(function(){C()}),i.subscribe(function(){k()}),{updateNextButton:h,disableNavigation:E,canNavigateBack:S,canNavigateForward:x,isNextButtonEnabled:w,executeOnValidateScripts:g,executeOnExitScripts:y,isBackButtonVisible:T,getValidationMessages:N,onNext:C,onBack:k}};return{createNavViewModel:f}}),function(){var e={};(function(e,t){e.VERSION="1.0.0-rc.3",e.COMPILER_REVISION=2,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:">= 1.0.0-rc.3"},e.helpers={},e.partials={},e.registerHelper=function(e,t,n){n&&(t.not=n),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(arguments.length===2)return t;throw new Error("Could not find property '"+e+"'")});var n=Object.prototype.toString,r="[object Function]";e.registerHelper("blockHelperMissing",function(t,i){var s=i.inverse||function(){},o=i.fn,u=n.call(t);return u===r&&(t=t.call(this)),t===!0?o(this):t===!1||t==null?s(this):u==="[object Array]"?t.length>0?e.helpers.each(t,i):s(this):o(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,n){if(e.logger.level<=t){var r=e.logger.methodMap[t];typeof console!="undefined"&&console[r]&&console[r].call(console,n)}}},e.log=function(t,n){e.logger.log(t,n)},e.registerHelper("each",function(t,n){var r=n.fn,i=n.inverse,s=0,o="",u;n.data&&(u=e.createFrame(n.data));if(t&&typeof t=="object")if(t instanceof Array)for(var a=t.length;s<a;s++)u&&(u.index=s),o+=r(t[s],{data:u});else for(var f in t)t.hasOwnProperty(f)&&(u&&(u.key=f),o+=r(t[f],{data:u}),s++);return s===0&&(o=i(this)),o}),e.registerHelper("if",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn})}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t,n){var r=n.data&&n.data.level!=null?parseInt(n.data.level,10):1;e.log(r,t)})})(e);var t=function(){function n(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,partialName:25,params:26,hash:27,DATA:28,param:29,STRING:30,INTEGER:31,BOOLEAN:32,hashSegments:33,hashSegment:34,ID:35,EQUALS:36,PARTIAL_NAME:37,pathSegments:38,SEP:39,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"DATA",30:"STRING",31:"INTEGER",32:"BOOLEAN",35:"ID",36:"EQUALS",37:"PARTIAL_NAME",39:"SEP"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[26,2],[26,1],[29,1],[29,1],[29,1],[29,1],[29,1],[27,1],[33,2],[33,1],[34,3],[34,3],[34,3],[34,3],[34,3],[25,1],[21,1],[38,3],[38,1]],performAction:function(t,n,r,i,s,o,u){var a=o.length-1;switch(s){case 1:return o[a-1];case 2:this.$=new i.ProgramNode([],o[a]);break;case 3:this.$=new i.ProgramNode(o[a-2],o[a]);break;case 4:this.$=new i.ProgramNode(o[a-1],[]);break;case 5:this.$=new i.ProgramNode(o[a]);break;case 6:this.$=new i.ProgramNode([],[]);break;case 7:this.$=new i.ProgramNode([]);break;case 8:this.$=[o[a]];break;case 9:o[a-1].push(o[a]),this.$=o[a-1];break;case 10:this.$=new i.BlockNode(o[a-2],o[a-1].inverse,o[a-1],o[a]);break;case 11:this.$=new i.BlockNode(o[a-2],o[a-1],o[a-1].inverse,o[a]);break;case 12:this.$=o[a];break;case 13:this.$=o[a];break;case 14:this.$=new i.ContentNode(o[a]);break;case 15:this.$=new i.CommentNode(o[a]);break;case 16:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 17:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 18:this.$=o[a-1];break;case 19:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 20:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],!0);break;case 21:this.$=new i.PartialNode(o[a-1]);break;case 22:this.$=new i.PartialNode(o[a-2],o[a-1]);break;case 23:break;case 24:this.$=[[o[a-2]].concat(o[a-1]),o[a]];break;case 25:this.$=[[o[a-1]].concat(o[a]),null];break;case 26:this.$=[[o[a-1]],o[a]];break;case 27:this.$=[[o[a]],null];break;case 28:this.$=[[new i.DataNode(o[a])],null];break;case 29:o[a-1].push(o[a]),this.$=o[a-1];break;case 30:this.$=[o[a]];break;case 31:this.$=o[a];break;case 32:this.$=new i.StringNode(o[a]);break;case 33:this.$=new i.IntegerNode(o[a]);break;case 34:this.$=new i.BooleanNode(o[a]);break;case 35:this.$=new i.DataNode(o[a]);break;case 36:this.$=new i.HashNode(o[a]);break;case 37:o[a-1].push(o[a]),this.$=o[a-1];break;case 38:this.$=[o[a]];break;case 39:this.$=[o[a-2],o[a]];break;case 40:this.$=[o[a-2],new i.StringNode(o[a])];break;case 41:this.$=[o[a-2],new i.IntegerNode(o[a])];break;case 42:this.$=[o[a-2],new i.BooleanNode(o[a])];break;case 43:this.$=[o[a-2],new i.DataNode(o[a])];break;case 44:this.$=new i.PartialNameNode(o[a]);break;case 45:this.$=new i.IdNode(o[a]);break;case 46:o[a-2].push(o[a]),this.$=o[a-2];break;case 47:this.$=[o[a]]}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],24:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],24:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],24:[1,16]},{17:23,18:[1,22],21:24,28:[1,25],35:[1,27],38:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{4:28,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],24:[1,16]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],24:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{17:30,21:24,28:[1,25],35:[1,27],38:26},{17:31,21:24,28:[1,25],35:[1,27],38:26},{17:32,21:24,28:[1,25],35:[1,27],38:26},{25:33,37:[1,34]},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],24:[1,16]},{17:23,21:24,28:[1,25],35:[1,27],38:26},{5:[2,4],7:35,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],24:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],24:[2,23]},{18:[1,36]},{18:[2,27],21:41,26:37,27:38,28:[1,45],29:39,30:[1,42],31:[1,43],32:[1,44],33:40,34:46,35:[1,47],38:26},{18:[2,28]},{18:[2,45],28:[2,45],30:[2,45],31:[2,45],32:[2,45],35:[2,45],39:[1,48]},{18:[2,47],28:[2,47],30:[2,47],31:[2,47],32:[2,47],35:[2,47],39:[2,47]},{10:49,20:[1,50]},{10:51,20:[1,50]},{18:[1,52]},{18:[1,53]},{18:[1,54]},{18:[1,55],21:56,35:[1,27],38:26},{18:[2,44],35:[2,44]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],24:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{18:[2,25],21:41,27:57,28:[1,45],29:58,30:[1,42],31:[1,43],32:[1,44],33:40,34:46,35:[1,47],38:26},{18:[2,26]},{18:[2,30],28:[2,30],30:[2,30],31:[2,30],32:[2,30],35:[2,30]},{18:[2,36],34:59,35:[1,60]},{18:[2,31],28:[2,31],30:[2,31],31:[2,31],32:[2,31],35:[2,31]},{18:[2,32],28:[2,32],30:[2,32],31:[2,32],32:[2,32],35:[2,32]},{18:[2,33],28:[2,33],30:[2,33],31:[2,33],32:[2,33],35:[2,33]},{18:[2,34],28:[2,34],30:[2,34],31:[2,34],32:[2,34],35:[2,34]},{18:[2,35],28:[2,35],30:[2,35],31:[2,35],32:[2,35],35:[2,35]},{18:[2,38],35:[2,38]},{18:[2,47],28:[2,47],30:[2,47],31:[2,47],32:[2,47],35:[2,47],36:[1,61],39:[2,47]},{35:[1,62]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{21:63,35:[1,27],38:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],24:[2,21]},{18:[1,64]},{18:[2,24]},{18:[2,29],28:[2,29],30:[2,29],31:[2,29],32:[2,29],35:[2,29]},{18:[2,37],35:[2,37]},{36:[1,61]},{21:65,28:[1,69],30:[1,66],31:[1,67],32:[1,68],35:[1,27],38:26},{18:[2,46],28:[2,46],30:[2,46],31:[2,46],32:[2,46],35:[2,46],39:[2,46]},{18:[1,70]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],24:[2,22]},{18:[2,39],35:[2,39]},{18:[2,40],35:[2,40]},{18:[2,41],35:[2,41]},{18:[2,42],35:[2,42]},{18:[2,43],35:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]}],defaultActions:{17:[2,1],25:[2,28],38:[2,26],57:[2,24]},parseError:function(t,n){throw new Error(t)},parse:function(t){function v(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function m(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p);var d=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var g,y,b,w,E,S,x={},T,N,C,k;for(;;){b=r[r.length-1];if(this.defaultActions[b])w=this.defaultActions[b];else{if(g===null||typeof g=="undefined")g=m();w=o[b]&&o[b][g]}if(typeof w=="undefined"||!w.length||!w[0]){var L="";if(!l){k=[];for(T in o[b])this.terminals_[T]&&T>2&&k.push("'"+this.terminals_[T]+"'");this.lexer.showPosition?L="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":L="Parse error on line "+(a+1)+": Unexpected "+(g==1?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:p,expected:k})}}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(w[0]){case 1:r.push(g),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(w[1]),g=null,y?(g=y,y=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:N=this.productions_[w[1]][1],x.$=i[i.length-N],x._$={first_line:s[s.length-(N||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(N||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(N||1)].range[0],s[s.length-1].range[1]]),S=this.performAction.call(x,u,f,a,this.yy,w[1],i,s);if(typeof S!="undefined")return S;N&&(r=r.slice(0,-1*N*2),i=i.slice(0,-1*N),s=s.slice(0,-1*N)),r.push(this.productions_[w[1]][0]),i.push(x.$),s.push(x._$),C=o[r[r.length-2]][r[r.length-1]],r.push(C);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.options={},e.performAction=function(t,n,r,i){var s=i;switch(r){case 0:n.yytext.slice(-1)!=="\\"&&this.begin("mu"),n.yytext.slice(-1)==="\\"&&(n.yytext=n.yytext.substr(0,n.yyleng-1),this.begin("emu"));if(n.yytext)return 14;break;case 1:return 14;case 2:return n.yytext.slice(-1)!=="\\"&&this.popState(),n.yytext.slice(-1)==="\\"&&(n.yytext=n.yytext.substr(0,n.yyleng-1)),14;case 3:return n.yytext=n.yytext.substr(0,n.yyleng-4),this.popState(),15;case 4:return this.begin("par"),24;case 5:return 16;case 6:return 20;case 7:return 19;case 8:return 19;case 9:return 23;case 10:return 23;case 11:this.popState(),this.begin("com");break;case 12:return n.yytext=n.yytext.substr(3,n.yyleng-5),this.popState(),15;case 13:return 22;case 14:return 36;case 15:return 35;case 16:return 35;case 17:return 39;case 18:break;case 19:return this.popState(),18;case 20:return this.popState(),18;case 21:return n.yytext=n.yytext.substr(1,n.yyleng-2).replace(/\\"/g,'"'),30;case 22:return n.yytext=n.yytext.substr(1,n.yyleng-2).replace(/\\'/g,"'"),30;case 23:return n.yytext=n.yytext.substr(1),28;case 24:return 32;case 25:return 32;case 26:return 31;case 27:return 35;case 28:return n.yytext=n.yytext.substr(1,n.yyleng-2),35;case 29:return"INVALID";case 30:break;case 31:return this.popState(),37;case 32:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[} ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@[a-zA-Z]+)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:-?[0-9]+(?=[}\s]))/,/^(?:[a-zA-Z0-9_$-]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:\s+)/,/^(?:[a-zA-Z0-9_$-/]+)/,/^(?:$)/],e.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},par:{rules:[30,31],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},e}();return e.lexer=t,n.prototype=e,e.Parser=n,new n}();e.Parser=t,e.parse=function(t){return t.constructor===e.AST.ProgramNode?t:(e.Parser.yy=e.AST,e.Parser.parse(t))},function(){e.AST={},e.AST.ProgramNode=function(t,n){this.type="program",this.statements=t,n&&(this.inverse=new e.AST.ProgramNode(n))},e.AST.MustacheNode=function(e,t,n){this.type="mustache",this.escaped=!n,this.hash=t;var r=this.id=e[0],i=this.params=e.slice(1),s=this.eligibleHelper=r.isSimple;this.isHelper=s&&(i.length||t)},e.AST.PartialNode=function(e,t){this.type="partial",this.partialName=e,this.context=t},e.AST.BlockNode=function(t,n,r,i){var s=function(t,n){if(t.original!==n.original)throw new e.Exception(t.original+" doesn't match "+n.original)};s(t.id,i),this.type="block",this.mustache=t,this.program=n,this.inverse=r,this.inverse&&!this.program&&(this.isInverse=!0)},e.AST.ContentNode=function(e){this.type="content",this.string=e},e.AST.HashNode=function(e){this.type="hash",this.pairs=e},e.AST.IdNode=function(t){this.type="ID",this.original=t.join(".");var n=[],r=0;for(var i=0,s=t.length;i<s;i++){var o=t[i];if(o===".."||o==="."||o==="this"){if(n.length>0)throw new e.Exception("Invalid path: "+this.original);o===".."?r++:this.isScoped=!0}else n.push(o)}this.parts=n,this.string=n.join("."),this.depth=r,this.isSimple=t.length===1&&!this.isScoped&&r===0,this.stringModeValue=this.string},e.AST.PartialNameNode=function(e){this.type="PARTIAL_NAME",this.name=e},e.AST.DataNode=function(e){this.type="DATA",this.id=e},e.AST.StringNode=function(e){this.type="STRING",this.string=e,this.stringModeValue=e},e.AST.IntegerNode=function(e){this.type="INTEGER",this.integer=e,this.stringModeValue=Number(e)},e.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e,this.stringModeValue=e==="true"},e.AST.CommentNode=function(e){this.type="comment",this.comment=e}}();var n=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(e){var t=Error.prototype.constructor.apply(this,arguments);for(var r=0;r<n.length;r++)this[n[r]]=t[n[r]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()},function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=/[&<>"'`]/g,r=/[&<>"'`]/,i=function(e){return t[e]||"&amp;"};e.Utils={escapeExpression:function(t){return t instanceof e.SafeString?t.toString():t==null||t===!1?"":r.test(t)?t.replace(n,i):t},isEmpty:function(e){return!e&&e!==0?!0:Object.prototype.toString.call(e)==="[object Array]"&&e.length===0?!0:!1}}}(),e.Compiler=function(){},e.JavaScriptCompiler=function(){},function(t,n){t.prototype={compiler:t,disassemble:function(){var e=this.opcodes,t,n=[],r,i;for(var s=0,o=e.length;s<o;s++){t=e[s];if(t.opcode==="DECLARE")n.push("DECLARE "+t.name+"="+t.value);else{r=[];for(var u=0;u<t.args.length;u++)i=t.args[u],typeof i=="string"&&(i='"'+i.replace("\n","\\n")+'"'),r.push(i);n.push(t.opcode+" "+r.join(" "))}}return n.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var r=this.opcodes[n],i=e.opcodes[n];if(r.opcode!==i.opcode||r.args.length!==i.args.length)return!1;for(var s=0;s<r.args.length;s++)if(r.args[s]!==i.args[s])return!1}t=this.children.length;if(e.children.length!==t)return!1;for(n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t=e.statements,n;this.opcodes=[];for(var r=0,i=t.length;r<i;r++)n=t[r],this[n.type](n);return this.isSimple=i===1,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++,r;this.usePartial=this.usePartial||t.usePartial,this.children[n]=t;for(var i=0,s=t.depths.list.length;i<s;i++){r=t.depths.list[i];if(r<2)continue;this.addDepth(r-1)}return n},block:function(e){var t=e.mustache,n=e.program,r=e.inverse;n&&(n=this.compileProgram(n)),r&&(r=this.compileProgram(r));var i=this.classifyMustache(t);i==="helper"?this.helperMustache(t,n,r):i==="simple"?(this.simpleMustache(t),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(t,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t=e.pairs,n,r;this.opcode("pushHash");for(var i=0,s=t.length;i<s;i++)n=t[i],r=n[1],this.options.stringParams?this.opcode("pushStringParam",r.stringModeValue,r.type):this.accept(r),this.opcode("assignToHash",n[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,n=this.classifyMustache(e);n==="simple"?this.simpleMustache(e):n==="helper"?this.helperMustache(e):this.ambiguousMustache(e),e.escaped&&!t.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(e,t,n){var r=e.id,i=r.parts[0],s=t!=null||n!=null;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",i,s)},simpleMustache:function(e){var t=e.id;t.type==="DATA"?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,n){var r=this.setupFullMustacheParams(e,t,n),i=e.id.parts[0];if(this.options.knownHelpers[i])this.opcode("invokeKnownHelper",r.length,i);else{if(this.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+i);this.opcode("invokeHelper",r.length,i)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var n=1,r=e.parts.length;n<r;n++)this.opcode("lookup",e.parts[n])},DATA:function(e){this.options.data=!0,this.opcode("lookupData",e.id)},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");if(e===0)return;this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e))},classifyMustache:function(e){var t=e.isHelper,n=e.eligibleHelper,r=this.options;if(n&&!t){var i=e.id.parts[0];r.knownHelpers[i]?t=!0:r.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){var t=e.length,n;while(t--)n=e[t],this.options.stringParams?(n.depth&&this.addDepth(n.depth),this.opcode("getContext",n.depth||0),this.opcode("pushStringParam",n.stringModeValue,n.type)):this[n.type](n)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("emptyHash"),t},setupFullMustacheParams:function(e,t,n){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("emptyHash"),r}};var r=function(e){this.value=e};n.prototype={nameLookup:function(e,t){return/^[0-9]+$/.test(t)?e+"["+t+"]":n.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,n,r,i){this.environment=t,this.options=n||{},e.log(e.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!r,this.context=r||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(t,n);var s=t.opcodes,o;this.i=0;for(u=s.length;this.i<u;this.i++)o=s[this.i],o.opcode==="DECLARE"?this[o.name]=o.value:this[o.opcode].apply(this,o.args);return this.createFunctionContext(i)},nextOpcode:function(){var e=this.environment.opcodes;return e[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var e=[];if(!this.isChild){var t=this.namespace,n="helpers = helpers || "+t+".helpers;";this.environment.usePartial&&(n=n+" partials = partials || "+t+".partials;"),this.options.data&&(n+=" data = data || {};"),e.push(n)}else e.push("");this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(t){var n=this.stackVars.concat(this.registers.list);n.length>0&&(this.source[1]=this.source[1]+", "+n.join(", "));if(!this.isChild)for(var r in this.context.aliases)this.source[1]=this.source[1]+", "+r+"="+this.context.aliases[r];this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");var i=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var s=0,o=this.environment.depths.list.length;s<o;s++)i.push("depth"+this.environment.depths.list[s]);var u=this.mergeSource();if(!this.isChild){var a=e.COMPILER_REVISION,f=e.REVISION_CHANGES[a];u="this.compilerInfo = ["+a+",'"+f+"'];\n"+u}if(t)return i.push(u),Function.apply(this,i);var l="function "+(this.name||"")+"("+i.join(",")+") {\n  "+u+"}";return e.log(e.logger.DEBUG,l+"\n\n"),l},mergeSource:function(){var e="",t;for(var n=0,r=this.source.length;n<r;n++){var i=this.source[n];i.appendToBuffer?t?t=t+"\n    + "+i.content:t=i.content:(t&&(e+="buffer += "+t+";\n  ",t=undefined),e+=i+"\n  ")}return e},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),e[e.length-1]="options",this.source.push("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){this.flushInline();var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(e){this.push(this.nameLookup("data",e,"data"))},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),typeof e=="string"?this.pushString(e):this.pushStackLiteral(e)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&this.register("hashTypes","{}")},pushHash:function(){this.hash={values:[],types:[]}},popHash:function(){var e=this.hash;this.hash=undefined,this.options.stringParams&&this.register("hashTypes","{"+e.types.join(",")+"}"),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var n=this.lastHelper=this.setupHelper(e,t,!0);this.push(n.name),this.replaceStack(function(e){return e+" ? "+e+".call("+n.callParams+") "+": helperMissing.call("+n.helperMissingParams+")"})},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var n=this.setupHelper(0,e,t),r=this.lastHelper=this.nameLookup("helpers",e,"helper"),i=this.nameLookup("depth"+this.lastContext,e,"context"),s=this.nextStack();this.source.push("if ("+s+" = "+r+") { "+s+" = "+s+".call("+n.callParams+"); }"),this.source.push("else { "+s+" = "+i+"; "+s+" = typeof "+s+" === functionType ? "+s+".apply(depth0) : "+s+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")},assignToHash:function(e){var t=this.popStack(),n;this.options.stringParams&&(n=this.popStack(),this.popStack());var r=this.hash;n&&r.types.push("'"+e+"': "+n),r.values.push("'"+e+"': ("+t+")")},compiler:n,compileChildren:function(e,t){var n=e.children,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s],i=new this.compiler;var u=this.matchExistingProgram(r);u==null?(this.context.programs.push(""),u=this.context.programs.length,r.index=u,r.name="program"+u,this.context.programs[u]=i.compile(r,t,this.context),this.context.environments[u]=r):(r.index=u,r.name="program"+u)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var r=this.context.environments[t];if(r&&r.equals(e))return t}},programExpression:function(e){this.context.aliases.self="this";if(e==null)return"self.noop";var t=this.environment.children[e],n=t.depths.list,r,i=[t.index,t.name,"data"];for(var s=0,o=n.length;s<o;s++)r=n[s],r===1?i.push("depth0"):i.push("depth"+(r-1));return n.length===0?"self.program("+i.join(", ")+")":(i.shift(),"self.programWithDepth("+i.join(", ")+")")},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new r(e))},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.source.push(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t="",n=this.isInline(),i;if(n){var s=this.popStack(!0);if(s instanceof r)i=s.value;else{var o=this.stackSlot?this.topStackName():this.incrStack();t="("+this.push(o)+" = "+s+"),",i=this.topStack()}}else i=this.topStack();var u=e.call(this,i);return n?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+t+u+")")):(/^stack/.test(i)||(i=this.nextStack()),this.source.push(i+" = ("+t+u+");")),i},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];i instanceof r?this.compileStack.push(i):this.pushStack(i)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();return!e&&n instanceof r?n.value:(t||this.stackSlot--,n)},topStack:function(e){var t=this.isInline()?this.inlineStack:this.compileStack,n=t[t.length-1];return!e&&n instanceof r?n.value:n},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'},setupHelper:function(e,t,n){var r=[];this.setupParams(e,r,n);var i=this.nameLookup("helpers",t,"helper");return{params:r,name:i,callParams:["depth0"].concat(r).join(", "),helperMissingParams:n&&["depth0",this.quotedString(t)].concat(r).join(", ")}},setupParams:function(e,t,n){var r=[],i=[],s=[],o,u,a;r.push("hash:"+this.popStack()),u=this.popStack(),a=this.popStack();if(a||u)a||(this.context.aliases.self="this",a="self.noop"),u||(this.context.aliases.self="this",u="self.noop"),r.push("inverse:"+u),r.push("fn:"+a);for(var f=0;f<e;f++)o=this.popStack(),t.push(o),this.options.stringParams&&(s.push(this.popStack()),i.push(this.popStack()));return this.options.stringParams&&(r.push("contexts:["+i.join(",")+"]"),r.push("types:["+s.join(",")+"]"),r.push("hashTypes:hashTypes")),this.options.data&&r.push("data:data"),r="{"+r.join(",")+"}",n?(this.register("options",r),t.push("options")):t.push(r),t.join(", ")}};var i="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),s=n.RESERVED_WORDS={};for(var o=0,u=i.length;o<u;o++)s[i[o]]=!0;n.isValidJavaScriptVariableName=function(e){return!n.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1},e.precompile=function(r,i){if(!r||typeof r!="string"&&r.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+r);i=i||{},"data"in i||(i.data=!0);var s=e.parse(r),o=(new t).compile(s,i);return(new n).compile(o,i)},e.compile=function(r,i){function o(){var s=e.parse(r),o=(new t).compile(s,i),u=(new n).compile(o,i,undefined,!0);return e.template(u)}if(!r||typeof r!="string"&&r.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+r);i=i||{},"data"in i||(i.data=!0);var s;return function(e,t){return s||(s=o()),s.call(this,e,t)}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,r){var i=this.programs[t];return r?e.VM.program(n,r):i?i:(i=this.programs[t]=e.VM.program(n),i)},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(r,i){i=i||{};var s=t.call(n,e,r,i.helpers,i.partials,i.data),o=n.compilerInfo||[],u=o[0]||1,a=e.COMPILER_REVISION;if(u!==a){if(u<a){var f=e.REVISION_CHANGES[a],l=e.REVISION_CHANGES[u];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+f+") or downgrade your runtime to an older version ("+l+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return s}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,2);return function(n,i){return i=i||{},e.apply(this,[n,i.data||t].concat(r))}},program:function(e,t){return function(n,r){return r=r||{},e(n,r.data||t)}},noop:function(){return""},invokePartial:function(t,n,r,i,s,o){var u={helpers:i,partials:s,data:o};if(t===undefined)throw new e.Exception("The partial "+n+" could not be found");if(t instanceof Function)return t(r,u);if(!e.compile)throw new e.Exception("The partial "+n+" could not be compiled when running in runtime-only mode");return s[n]=e.compile(t,{data:o!==undefined}),s[n](r,u)}},e.template=e.VM.template}(e.Compiler,e.JavaScriptCompiler),define("handlebars",[],function(){return e})}(),define("hbs",["handlebars"],function(e){var t={};return{load:function(n,r,i,s){if(s.isBuild){var o=nodeRequire("fs"),u=r.toUrl(n);u.substr(-3)===".js"&&(u=u.substr(0,u.length-".js".length)),u+=".html",t[n]=o.readFileSync(u).toString(),i()}else r(["text!"+n+".html"],function(t){i(e.compile(t))})},write:function(n,r,i){var s=e.precompile(t[r]);i("define('hbs!"+r+"', ['handlebars'], function(Handlebars){ \n"+"return Handlebars.template("+s.toString()+");\n"+"});\n")}}}),define("hbs!desktopTemplates/button",["handlebars"],function(e){return e.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression;s+='﻿<button id="',(o=n.id)?o=o.call(t,{hash:{},data:i}):(o=t.id,o=typeof o===u?o.apply(t):o),s+=a(o)+'" class="vci-button">',(o=n.text)?o=o.call(t,{hash:{},data:i}):(o=t.text,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+="</button>",s})}),define("desktop/button",["jQueryFramework","hbs!desktopTemplates/button","viewUtils"],function(e,t,n){var r=function(e){var r=t({text:e.text,id:e.id}),i=n.grabElements(r),s=function(t){t.on("click",e.onClickCallback)},o=function(){i.$root.prop("disabled",!0)},u=function(){i.$root.prop("disabled",!1)};return s(i.$root),{$element:i.$root,disable:o,enable:u}};return{create:r}}),define("desktop/navView",["navViewModel","constants","utils","desktop/button","event!enableDirty","event!modifyNextButtonText","jQueryFramework"],function(e,t,n,r,i,s,o){var u=null,a=null,f=null,l=n.isRightToLeftContentDirection(),c=function(e){var n=o("#"+t.TestModeDivId),r=o("#"+t.TestModeCollapsedDivId),i=n.css("display")!="none";n.toggle(!i),r.toggle(i)},h=function(e){e?(f.enable(),o("#NextMessage").hide()):(f.disable(),o("#NextMessage").show())},p=function(e){e.preventDefault();if(u.executeOnValidateScripts()){u.executeOnExitScripts();var t=o("#Finish a").attr("href");window.location=t}},d=function(e){e.preventDefault(),u.onNext()},v=function(e){e.preventDefault(),u.onBack()},m=function(){u.updateNextButton(),h(u.isNextButtonEnabled())},g=function(){var e=window.location.href.replace("_view=d","_view=m");window.location.replace(e),o.cookie("VisionCritical.PreviewPreference","mobile",{expires:7,path:"/"})},y=function(){var h=function(){var e=o(".ButtonContainer"),n="<span style='font-family: ORCALO; position: relative; top: 1px;'>&#xe624;</span>",i="<span style='font-family: ORCALO; position: relative; top: 1px;'>&#xe623;</span>";u.isBackButtonVisible()&&(a=r.create({text:l?n+" "+t.BackButton:i+" "+t.BackButton,onClickCallback:function(e){v(e)},id:"Back"}),a.$element.attr("type","submit"),e.append(a.$element)),f=r.create({text:l?t.NextButton+" "+i:t.NextButton+" "+n,onClickCallback:function(e){d(e)},id:"Next"}),f.$element.attr("type","submit"),f.disable(),e.append(f.$element)},y=function(){var e=o("#controls");e.detach(),e.appendTo(o("#questionContent"))},b=function(){h();var e=o("#mobile-button");n.isIE9OrLess()?(e.addClass("view-button-disabled"),e.removeClass("view-button"),e.attr("title",t.MobilePreviewNotSupported)):(e.bind("click",null,g),e.keyup(function(e){e.keyCode===13&&g()}))},w=function(){var e=o("#"+t.NextButtonMessageId);e.text(e.text().replace(/.+::/,""))},E=function(e){e.callback&&e.callback();if(e.hide){f.$element.remove();return}f.$element.html(e.html),e.event&&(f.$element.off("click"),f.$element.on("click",e.event))};u=e.createNavViewModel(),b(),w(),y(),o("#"+t.CloseTestButtonId).bind("click",c),o("#"+t.CloseTestButtonId).keyup(function(e){e.keyCode===13&&c()}),o("#"+t.TestModeCollapsedDivId).bind("click",c),o("#"+t.TestModeCollapsedDivId).keyup(function(e){e.keyCode===13&&c()}),o("#Finish").bind("click",p),i.subscribe(m),s.subscribe(E)};return{initialize:y}}),define("hbs!desktopTemplates/footer",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){var r="",i;r+='\r\n\r\n<div id="footer" class="use-footer-links footer-text" role="contentinfo">\r\n	',(i=n.footerLinksHtml)?i=i.call(e,{hash:{},data:t}):(i=e.footerLinksHtml,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;r+='\r\n\r\n    <p class="legaltext pp" style="display:',i=n["if"].call(e,e.showFooterText,{hash:{},inverse:a.program(4,h,t),fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;return r+=';">',(i=n.policyNote)?i=i.call(e,{hash:{},data:t}):(i=e.policyNote,i=typeof i===u?i.apply(e):i),r+=f(i)+"</p>\r\n</div>\r\n\r\n",r}function c(e,t){return"block"}function h(e,t){return"none"}function p(e,t){var r="",i;r+='\r\n\r\n<div id="footer" role="contentinfo">\r\n	<div id="links">\r\n		<a href="',(i=n.supportLink)?i=i.call(e,{hash:{},data:t}):(i=e.supportLink,i=typeof i===u?i.apply(e):i),r+=f(i)+'" target="_blank">',(i=n.supportLabel)?i=i.call(e,{hash:{},data:t}):(i=e.supportLabel,i=typeof i===u?i.apply(e):i),r+=f(i)+"</a>\r\n	</div>\r\n\r\n	",i=n["if"].call(e,e.showFooterText,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\r\n</div>\r\n\r\n",r}function d(e,t){var r="",i;return r+='\r\n	<p class="legaltext pp">',(i=n.policyNote)?i=i.call(e,{hash:{},data:t}):(i=e.policyNote,i=typeof i===u?i.apply(e):i),r+=f(i)+"</p>\r\n	",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this,f=this.escapeExpression;o=n["if"].call(t,t.useFooterLinks,{hash:{},inverse:a.program(6,p,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\r\n",s})}),define("hbs!desktopTemplates/footerLinks",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\r\n<div class="link">\r\n    <a href="'+a((r=e.Href,typeof r===u?r.apply(e):r))+'" target="_blank">'+a((r=e.Title,typeof r===u?r.apply(e):r))+"</a>\r\n</div>\r\n",n}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+="﻿",o=n.each.call(t,t.footerLinks,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s})}),define("desktop/views/footerView",["constants","viewUtils","jQueryFramework","underscore","themeSwitcher","event!communityChanged","event!themeChanged","hbs!desktopTemplates/footer","hbs!desktopTemplates/footerLinks"],function(e,t,n,r,i,s,o,u,a){var f=function(){var e=t.getCommunityMetaData(),r=a({footerLinks:e.footerLinks}),i=n("#footer");i.find(".link").remove(),i.hide().prepend(r).fadeIn(500)},l=function(){var e=t.getCommunityMetaData(),r=n("p.legaltext, #footer.use-footer-links p");e.footerText.isVisible?(r.text(e.footerText.text),r.show()):r.hide()},c=function(){var n=null,r=t.getCommunityMetaData(),i=u({useFooterLinks:!!e.UseFooterLinks,footerLinksHtml:a({footerLinks:r.footerLinks}),supportLink:e.SupportLink,supportLabel:e.SupportLabel,showFooterText:r.footerText.isVisible,policyNote:r.footerText.text});return n=t.grabElements(i),s.subscribe(function(){f(),l()}),o.subscribe(function(){l()}),{$root:n.$root}};return{create:c}}),define("hbs!desktopTemplates/header",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function f(e,t){var r="",i;r+='\r\n    <div id="headerImage">\r\n        <img src="',(i=n.imageUri)?i=i.call(e,{hash:{},data:t}):(i=e.imageUri,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;r+='" alt="',(i=n.altTag)?i=i.call(e,{hash:{},data:t}):(i=e.altTag,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+='" />\r\n    </div>\r\n',r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this;s+="﻿",o=n["if"].call(t,t.imageUri,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+="\r\n",s})}),define("desktop/views/headerView",["constants","viewUtils","jQueryFramework","hbs!desktopTemplates/header","images"],function(e,t,n,r,i){var s=987,o=function(e,o){var u=null,a=n("#headerImage");a.length>0&&a.remove();var f=e,l="";if(o)try{var c=JSON.parse(e),h=c.publicContentUri?c.publicContentUri:c.resourceUri;f=i.generateAssetManagerUrl(h,s),l=t.stripHtml(c.description)}catch(p){f=""}var d=r({imageUri:f,altTag:l});return u=t.grabElements(d),{$root:u.$root}};return{create:o}}),define("hbs!desktopTemplates/footerImage",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function f(e,t){var r="",i;r+='\r\n<div id="logoImage"',i=n["if"].call(e,e.useFooterLinks,{hash:{},inverse:u.noop,fn:u.program(2,l,t),data:t});if(i||i===0)r+=i;r+='>\r\n        <img src="',(i=n.footerImageUri)?i=i.call(e,{hash:{},data:t}):(i=e.footerImageUri,i=typeof i===a?i.apply(e):i);if(i||i===0)r+=i;r+='" alt="',(i=n.altTag)?i=i.call(e,{hash:{},data:t}):(i=e.altTag,i=typeof i===a?i.apply(e):i);if(i||i===0)r+=i;return r+='"/>\r\n    </div>\r\n',r}function l(e,t){return' class="use-footer-links"'}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u=this,a="function";s+="﻿",o=n["if"].call(t,t.hasLogoImage,{hash:{},inverse:u.noop,fn:u.program(1,f,i),data:i});if(o||o===0)s+=o;return s})}),define("desktop/views/footerImageView",["constants","viewUtils","jQueryFramework","hbs!desktopTemplates/footerImage","images"],function(e,t,n,r,i){var s=!!e.UseFooterLinks,o=30,u=180,a=function(e,a){var f=null,l=n("#logoImage");l.length>0&&l.remove();var c=e?!0:!1,h=e,p="";if(a)try{var d=JSON.parse(e),v=d.publicContentUri?d.publicContentUri:d.resourceUri;h=i.generateAssetManagerUrl(v,u,o),p=t.stripHtml(d.description)}catch(m){h=""}var g=r({useFooterLinks:s,hasLogoImage:c,footerImageUri:h,altTag:p});return f=t.grabElements(g),{$root:f.$root}};return{create:a}}),define("hbs!desktopTemplates/questionText/questionTextTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function c(e,t){return"questionText"}function h(e,t){var r="",i,s;r+='\r\n	<div class="questionImageContainer imagePlaceholder '+f((i=(i=e.image,i==null||i===!1?i:i.alignment),typeof i===a?i.apply(e):i))+'">\r\n		<img id="vc_stepImageid',(s=n.id)?s=s.call(e,{hash:{},data:t}):(s=e.id,s=typeof s===a?s.apply(e):s),r+=f(s)+'" src="',s=(i=(i=e.image,i==null||i===!1?i:i.src),typeof i===a?i.apply(e):i);if(s||s===0)r+=s;r+='" alt="',s=(i=(i=e.image,i==null||i===!1?i:i.altText),typeof i===a?i.apply(e):i);if(s||s===0)r+=s;return r+='" />\r\n	</div>\r\n	',r}function p(e,t){var r="",i;r+='\r\n		<label for="vc_ta_',(i=n.answerId)?i=i.call(e,{hash:{},data:t}):(i=e.answerId,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',i=n["if"].call(e,e.isRequired,{hash:{},inverse:l.noop,fn:l.program(6,d,t),data:t});if(i||i===0)r+=i;(i=n.text)?i=i.call(e,{hash:{},data:t}):(i=e.text,i=typeof i===a?i.apply(e):i);if(i||i===0)r+=i;return r+="</label>\r\n	",r}function d(e,t){return'<span class="requiredStarAccessible">*</span>'}function v(e,t){var r="",i;r+="\r\n		",(i=n.text)?i=i.call(e,{hash:{},data:t}):(i=e.text,i=typeof i===a?i.apply(e):i);if(i||i===0)r+=i;return r+="\r\n	",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this;s+='﻿\r\n<div class="'+f((o=(o=t.image,o==null||o===!1?o:o.imageDivClass),typeof o===a?o.apply(t):o))+" ",u=n["if"].call(t,t.isQ3SurveyRespondingUXImprovementsEnabled,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(u||u===0)s+=u;s+='">\r\n	\r\n	',u=n["if"].call(t,(o=t.image,o==null||o===!1?o:o.src),{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(u||u===0)s+=u;s+="\r\n\r\n	",u=n["if"].call(t,t.answerId,{hash:{},inverse:l.program(8,v,i),fn:l.program(5,p,i),data:i});if(u||u===0)s+=u;return s+='\r\n	\r\n</div>\r\n<div class="fltclear">&nbsp;</div>\r\n',s})}),function(e,t){typeof module=="object"&&module.exports?module.exports=t():typeof define=="function"&&define.amd?define("lib/spinner/spin",[],t):e.Spinner=t()}(this,function(){"use strict";function i(e,t){var n=document.createElement(e||"div"),r;for(r in t)n[r]=t[r];return n}function s(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function o(e,i,s,o){var u=["opacity",i,~~(e*100),s,o].join("-"),a=.01+s/o*100,f=Math.max(1-(1-e)/i*(100-a),e),l=n.substring(0,n.indexOf("Animation")).toLowerCase(),c=l&&"-"+l+"-"||"";return t[u]||(r.insertRule("@"+c+"keyframes "+u+"{"+"0%{opacity:"+f+"}"+a+"%{opacity:"+e+"}"+(a+.01)+"%{opacity:1}"+(a+i)%100+"%{opacity:"+e+"}"+"100%{opacity:"+f+"}"+"}",r.cssRules.length),t[u]=1),u}function u(t,n){var r=t.style,i,s;n=n.charAt(0).toUpperCase()+n.slice(1);if(r[n]!==undefined)return n;for(s=0;s<e.length;s++){i=e[s]+n;if(r[i]!==undefined)return i}}function a(e,t){for(var n in t)e.style[u(e,n)||n]=t[n];return e}function f(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]===undefined&&(e[r]=n[r])}return e}function l(e,t){return typeof e=="string"?e:e[t%e.length]}function h(e){this.opts=f(e||{},h.defaults,c)}function p(){function e(e,t){return i("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}r.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(t,n){function o(){return a(e("group",{coordsize:i+" "+i,coordorigin:-r+" "+ -r}),{width:i,height:i})}function h(t,i,u){s(f,s(a(o(),{rotation:360/n.lines*t+"deg",left:~~i}),s(a(e("roundrect",{arcsize:n.corners}),{width:r,height:n.scale*n.width,left:n.scale*n.radius,top:-n.scale*n.width>>1,filter:u}),e("fill",{color:l(n.color,t),opacity:n.opacity}),e("stroke",{opacity:0}))))}var r=n.scale*(n.length+n.width),i=n.scale*2*r,u=-(n.width+n.length)*n.scale*2+"px",f=a(o(),{position:"absolute",top:u,left:u}),c;if(n.shadow)for(c=1;c<=n.lines;c++)h(c,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(c=1;c<=n.lines;c++)h(c);return s(t,f)},h.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var e=["webkit","Moz","ms","O"],t={},n,r,c={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};h.defaults={},f(h.prototype,{spin:function(e){this.stop();var t=this,r=t.opts,s=t.el=i(null,{className:r.className});a(s,{position:r.position,width:0,zIndex:r.zIndex,left:r.left,top:r.top}),e&&e.insertBefore(s,e.firstChild||null),s.setAttribute("role","progressbar"),t.lines(s,t.opts);if(!n){var o=0,u=(r.lines-1)*(1-r.direction)/2,f,l=r.fps,c=l/r.speed,h=(1-r.opacity)/(c*r.trail/100),p=c/r.lines;(function d(){o++;for(var e=0;e<r.lines;e++)f=Math.max(1-(o+(r.lines-e)*p)%c*h,r.opacity),t.opacity(s,e*r.direction+u,f,r);t.timeout=t.el&&setTimeout(d,~~(1e3/l))})()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=undefined),this},lines:function(e,t){function c(e,n){return a(i(),{position:"absolute",width:t.scale*(t.length+t.width)+"px",height:t.scale*t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*r+t.rotate)+"deg) translate("+t.scale*t.radius+"px"+",0)",borderRadius:(t.corners*t.scale*t.width>>1)+"px"})}var r=0,u=(t.lines-1)*(1-t.direction)/2,f;for(;r<t.lines;r++)f=a(i(),{position:"absolute",top:1+~(t.scale*t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:n&&o(t.opacity,t.trail,u+r*t.direction,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&s(f,a(c("#000","0 0 4px #000"),{top:"2px"})),s(e,s(f,c(l(t.color,r),"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});if(typeof document!="undefined"){r=function(){var e=i("style",{type:"text/css"});return s(document.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}();var d=a(i("group"),{behavior:"url(#default#VML)"});!u(d,"transform")&&d.adj?p():n=u(d,"animation")}return h}),function(e){if(typeof exports=="object")e(require("jquery"),require("spin.js"));else if(typeof define=="function"&&define.amd)define("lib/spinner/jquery.spin",["jQueryFramework","./spin"],e);else{if(!window.Spinner)throw new Error("Spin.js not present");e(window.jQuery,window.Spinner)}}(function(e,t){e.fn.spin=function(n,r){return this.each(function(){var i=e(this),s=i.data();s.spinner&&(s.spinner.stop(),delete s.spinner),n!==!1&&(n=e.extend({color:r||i.css("color")},e.fn.spin.presets[n]||n),s.spinner=(new t(n)).spin(this))})},e.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),function(e,t){typeof define=="function"&&define.amd?define("desktop/lightbox",["jQueryFramework","lib/spinner/jquery.spin"],t):typeof exports=="object"?module.exports=t(require("jQueryFramework")):e.lightbox=t(e.jQuery)}(this,function(e){function t(t){this.image=null,this.caption="",this.onEnd=null,this.options=e.extend({},this.constructor.defaults),this.option(t),this.visible=!1}function r(){return n===null&&(n=new t,e(document).ready(function(){n.build()})),n}t.defaults={fadeDuration:200,fitImagesInViewport:!0,imageFadeDuration:200,resizeDuration:0,wrapAround:!1,disableScrolling:!0},t.prototype.option=function(t){e.extend(this.options,t)},t.prototype.init=function(){var t=this;e(document).ready(function(){t.build()})},t.prototype.build=function(){var t=this;e("#lightbox").length===0&&e('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox" role="dialog" aria-modal="true"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-caption answer-font-family"></div><div class="lb-closeContainer"><div class="lb-close" tabindex="0" aria-label="'+constants.CloseImage+'"></div></div></div></div></div>').appendTo(e("body")),this.$lightbox=e("#lightbox"),this.$overlay=e("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.$image=this.$lightbox.find(".lb-image"),this.$close=this.$lightbox.find(".lb-close"),this.$caption=this.$lightbox.find(".lb-caption"),this.containerPadding={top:parseInt(this.$container.css("padding-top"),10),right:parseInt(this.$container.css("padding-right"),10),bottom:parseInt(this.$container.css("padding-bottom"),10),left:parseInt(this.$container.css("padding-left"),10)},this.imageBorderWidth={top:parseInt(this.$image.css("border-top-width"),10),right:parseInt(this.$image.css("border-right-width"),10),bottom:parseInt(this.$image.css("border-bottom-width"),10),left:parseInt(this.$image.css("border-left-width"),10)},this.$overlay.hide().on("click",function(){return t.end(),!1}),this.$lightbox.hide().on("click",function(n){return e(n.target).attr("id")==="lightbox"&&t.end(),!1}),this.$outerContainer.on("click",function(n){return e(n.target).attr("id")==="lightbox"&&t.end(),!1}),this.$close.on("click",function(e){t.end()}),this.$image.on("click",function(e){e.stopPropagation()}),this.$container.on("click",function(e){t.end()})},t.prototype.start=function(t,n,r){var i=this,s=e(window);s.on("resize",e.proxy(this.sizeOverlay,this)),e("select, object, embed").css({visibility:"hidden"}),!r||(this.onEnd=r);var o=s.scrollTop(),u=s.scrollLeft();this.$lightbox.css({top:o+"px",left:u+"px"}).fadeIn(this.options.fadeDuration),this.options.disableScrolling&&e("body").addClass("lb-disable-scrolling"),this.sizeOverlay(),this.showCaption(n),this.showPlaceholder(),this.$container.spin(),this.visible=!0,e(t).imagesLoaded().done(function(){i.showImage(t)}).always(function(){i.$container.spin(!1)})},t.prototype.showPlaceholder=function(){var e=this,t=this.$lightbox.find(".lb-image");this.disableKeyboardNav(),this.$overlay.fadeIn(this.options.fadeDuration),t.width(200),t.height(200),e.sizeContainer(t.width(),t.height()),e.enableKeyboardNav()},t.prototype.showImage=function(t){var n=this,r,i,s,o,u,a,f=this.$lightbox.find(".lb-image");this.image=t,this.disableKeyboardNav(),this.$overlay.fadeIn(this.options.fadeDuration),f.attr("src",t.src),f.attr("alt",t.alt),f.width(t.naturalWidth),f.height(t.naturalHeight);if(n.options.fitImagesInViewport){a=e(window).width(),u=e(window).height(),o=a-n.containerPadding.left-n.containerPadding.right-n.imageBorderWidth.left-n.imageBorderWidth.right-20,s=u-n.containerPadding.top-n.containerPadding.bottom-n.imageBorderWidth.top-n.imageBorderWidth.bottom-120,n.options.maxWidth&&n.options.maxWidth<o&&(o=n.options.maxWidth),n.options.maxHeight&&n.options.maxHeight<o&&(s=n.options.maxHeight);if(t.naturalWidth>o||t.naturalHeight>s)t.naturalWidth/o>t.naturalHeight/s?(i=o,r=parseInt(t.naturalHeight/(t.naturalWidth/i),10),f.width(i),f.height(r)):(r=s,i=parseInt(t.naturalWidth/(t.naturalHeight/r),10),f.width(i),f.height(r))}n.sizeContainer(f.width(),f.height()),n.enableKeyboardNav()},t.prototype.showCaption=function(e){e?this.$caption.css("display","inline-block").html(e):this.$caption.css("display","none").html("")},t.prototype.sizeOverlay=function(){this.$overlay.width(e(document).width()).height(e(document).height())},t.prototype.sizeContainer=function(t,n){var r=this,i=t+this.containerPadding.left+this.containerPadding.right+this.imageBorderWidth.left+this.imageBorderWidth.right,s=n+this.containerPadding.top+this.containerPadding.bottom+this.imageBorderWidth.top+this.imageBorderWidth.bottom;s+=this.$caption.outerHeight(),this.$caption.width()>i?(this.$lightbox.find(".lb-image").css("left",(this.$caption.width()-i)/2),i=this.$caption.width()):this.$lightbox.find(".lb-image").css("left",0);var o=Math.max(this.containerPadding.top+this.imageBorderWidth.top,(e(window).height()-s)/2);this.$outerContainer.css({width:i,height:s,top:o}),r.$lightbox.find(".lb-image").fadeIn(r.options.imageFadeDuration)},t.prototype.enableKeyboardNav=function(){e(document).on("keyup.keyboard",e.proxy(this.keyboardAction,this))},t.prototype.disableKeyboardNav=function(){e(document).off(".keyboard")},t.prototype.keyboardAction=function(e){var t=27,n=13,r=32,i=9,s=e.keyCode;if(s===t||s===r||s===n||s===i)e.stopPropagation(),e.preventDefault(),this.end()},t.prototype.end=function(){var t=this;this.visible=!1,this.disableKeyboardNav(),e(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration,function(){t.$image.attr("src","")}),this.$overlay.fadeOut(this.options.fadeDuration),e("select, object, embed").css({visibility:"visible"}),this.options.disableScrolling&&e("body").removeClass("lb-disable-scrolling"),this.onEnd!=null&&this.onEnd()};var n=null;return{getInstance:function(){return r()}}}),define("desktop/imageUtils",["constants","desktop/lightbox","jQueryFramework"],function(e,t,n){function r(r,s,o){function l(){var r=n("<img>");r.addClass("cs_image"),r.attr("src",o);var i=t.getInstance();e.IsRtlContentDirection&&i.$lightbox.attr("dir","rtl"),i.start(r[0],s),i.$close.focus()}r.find(".overlay-expand").length>0&&i(r);var u=n('<div class="overlay-expand" tabindex="0" role="button" aria-label="'+e.ExpandImage+'"></div>'),a=n('<div class="icon-expand"></div>'),f=r.find("img")[0];u.on("keyup keypress",function(e){var n=13,r=32,i=e.keyCode;if(i===n||i===r)e.preventDefault(),e.stopPropagation(),e.type==="keyup"&&(t.getInstance().visible?t.getInstance().end():l())}),u.click(function(e){n(this).blur()}),a.click(function(e){e.stopPropagation(),e.preventDefault(),l()}),u.append(a),r.append(u)}function i(e){e.find(".overlay-expand").remove()}return{renderExpandOverlay:r,removeOverlay:i}}),function(e,t){typeof define=="function"&&define.amd?define("lib/fontfaceonload",[],t):typeof exports=="object"?module.exports=t():e.FontFaceOnload=t()}(this,function(){var e="AxmTYklsjo190QW",t="sans-serif",n="serif",r={tolerance:2,delay:100,glyphs:"",success:function(){},error:function(){},timeout:5e3,weight:"400",style:"normal",window:window},i=["display:block","position:absolute","top:-999px","left:-999px","font-size:48px","width:auto","height:auto","line-height:normal","margin:0","padding:0","font-variant:normal","white-space:nowrap"],s='<div style="%s" aria-hidden="true">'+e+"</div>",o=function(){this.fontFamily="",this.appended=!1,this.serif=undefined,this.sansSerif=undefined,this.parent=undefined,this.options={}};o.prototype.getMeasurements=function(){return{sansSerif:{width:this.sansSerif.offsetWidth,height:this.sansSerif.offsetHeight},serif:{width:this.serif.offsetWidth,height:this.serif.offsetHeight}}},o.prototype.load=function(){function p(e){return i.concat(["font-weight:"+c.weight,"font-style:"+c.style]).concat("font-family:"+e).join(";")}function m(e,t,n){return Math.abs(e.width-t.offsetWidth)>n||Math.abs(e.height-t.offsetHeight)>n}function g(){return(new Date).getTime()-e.getTime()>c.timeout}var e=new Date,r=this,o=r.serif,u=r.sansSerif,a=r.parent,f=r.appended,l,c=r.options,h=c.reference,d=s.replace(/\%s/,p(t)),v=s.replace(/\%s/,p(n));a||(a=r.parent=c.window.document.createElement("div")),a.innerHTML=d+v,u=r.sansSerif=a.firstChild,o=r.serif=u.nextSibling,c.glyphs&&(u.innerHTML+=c.glyphs,o.innerHTML+=c.glyphs),function y(){h||(h=c.window.document.body),!f&&h&&(h.appendChild(a),f=r.appended=!0,l=r.getMeasurements(),u.style.fontFamily=r.fontFamily+", "+t,o.style.fontFamily=r.fontFamily+", "+n),f&&l&&(m(l.sansSerif,u,c.tolerance)||m(l.serif,o,c.tolerance))?c.success():g()?c.error():!f&&"requestAnimationFrame"in c.window?c.window.requestAnimationFrame(y):c.window.setTimeout(y,c.delay)}()},o.prototype.cleanFamilyName=function(e){return e.replace(/[\'\"]/g,"").toLowerCase()},o.prototype.cleanWeight=function(e){var t={normal:"400",bold:"700"};return""+(t[e]||e)},o.prototype.checkFontFaces=function(e){var t=this;t.options.window.document.fonts.forEach(function(n){t.cleanFamilyName(n.family)===t.cleanFamilyName(t.fontFamily)&&t.cleanWeight(n.weight)===t.cleanWeight(t.options.weight)&&n.style===t.options.style&&n.load().then(function(){t.options.success(n),t.options.window.clearTimeout(e)})})},o.prototype.init=function(e,t){var n;for(var i in r)t.hasOwnProperty(i)||(t[i]=r[i]);this.options=t,this.fontFamily=e,!t.glyphs&&"fonts"in t.window.document?(t.timeout&&(n=t.window.setTimeout(function(){t.error()},t.timeout)),this.checkFontFaces(n)):this.load()};var u=function(e,t){var n=new o;return n.init(e,t),n};return u}),define("desktop/pageHtmlHelper",["page","step","images","jQueryFramework","hbs!desktopTemplates/questionText/questionTextTemplate","underscore","constants","desktop/imageUtils","lib/fontfaceonload","utils"],function(e,t,n,r,i,s,o,u,a,f){var l=927,c=["HandOfSeanPro","Helvetica W02 Light","Montserrat","Open Sans","Raleway","Roboto"],h=function(){if(!t.getStep().IsPage)return;var n=e.getAllNonPageQuestionDefinitions(),i=[],o=r("#questionContent");o.remove(),o.children(".question").each(function(e,t){i.push(r(t)),r(t).remove()}),s.each(n,function(e){var t=s.find(i,function(t){return t.attr("id")===e.ObjectId});o.append(t)}),r("#pagecontent").prepend(o)},p=function(e,t){var n=t.split("::");for(var r=1;r<n.length-1;r++){var i="{"+(r-1).toString()+"}";e=e.replace(i,n[r])}return e},d=function(t){var n=r("#"+t+" .questionErrorMsg"),i=e.getPluginInstanceByQuestionId(t);if(n.length>0){var s=n,o=s.text(),u=o.split("::"),a=u.length>1?u[0]:"";if(a){var f=i.getLocalizedString(a);if(f){var l=p(f,o);s.text(l);return}s.text(u[u.length-1])}}},v=function(e){return e.AnswerCollection&&e.AnswerCollection.length===1&&e.AnswerCollection[0].DisplayTextAnswer&&e.AnswerCollection[0].IsText?e.AnswerCollection[0].ObjectId:""},m=function(e){var t=r("#"+e.ObjectId+" .questionheader"),s=r("#"+e.ObjectId+" .question-underline"),o=n.getQuestionImageDimensions(e),a=n.getQuestionImage(e),c=a.width&&a.width>l?l/a.width:1,h=a.width,p=a.height,d=e.Required||e.MustRankAllItems||e.MustUseFullAmount,m=i({id:e.ObjectId,text:e.Html,image:n.getQuestionImage(e,a.width*c,a.height*c),answerId:v(e),isRequired:d,isQ3SurveyRespondingUXImprovementsEnabled:f.isQ3SurveyRespondingUXImprovementsEnabled()});if(f.isQ3AccessibilityImprovementsEnabled()){var g=e.ObjectId;t.attr("id","qheader-"+g).attr("role","group"),r("#"+g).attr("role","group").attr("aria-labelledby","qheader-"+g)}f.isQ3SurveyRespondingUXImprovementsEnabled()&&e.Html===""&&!d&&!a.src?(t.remove(),s.remove()):t.append(r(m.toString()));if(!!a.src){var y=r(m).find("img");y.imagesLoaded().done(function(){t.find(".questionImageContainer").removeClass("imagePlaceholder"),c<1&&u.renderExpandOverlay(t.find(".questionImageContainer"),"",e.CustomQuestionProperties.QuestionImage.AssetUrl)})}},g=function(){var t=e.getAllNonPageQuestionDefinitions();s.each(t,function(e){d(e.ObjectId),m(e)}),r(".textanswermessage").html(""),r(".questionRequiredStar").css("display","block")},y=function(e){var t=r(".answer-font-family").css("font-family"),n=null,i=!1;if(!t){e();return}r.each(c,function(e,r){if(t.indexOf(r)>=0)return n=r,!1});if(!n){e();return}a(n,{success:function(){i||(e(),i=!0)},timeout:1e3})},b=function(e){return r("#pluginRoot_"+e)},w=function(e){var t=b(e);t.removeAttr("aria-busy")};return{updateQuestionText:g,refreshQuestionsOnPage:h,getQuestionElementById:b,onAnswerFontLoaded:y,enablePlugin:w,pageReady:function(){r("#questionContent").show()}}}),define("automation",["jQueryFramework"],function(e){var t=function(){var t=e("<div></div>").css("display","none").attr("id","PageIsReadyForAutomation");e("body").append(t)};return{addAutomationReadyElement:t}}),define("openWindow",[],function(){var e=function(e){var t="";if(e.width){var n=parseInt(e.width);NaN!=n&&(t+="width="+n+", ")}if(e.height){var r=parseInt(e.height);NaN!=r&&(t+="height="+r+", ")}window.open(e.uri,e.target,t)},t=function(){window.openWindow=e};return{initialize:t}}),define("scriptingLibraryErrorHandler",["constants","scriptingLibrary"],function(e,t){var n=function(){e.ExpectSurveyLibrary&&t.isBlankLibrary&&(console&&console.log&&console.log("The scripting library failed to load!"),window.location.replace("/GenericError"))};return{verifyLoaded:n}}),define("desktop/dialog",["jQueryFramework","event!showDialog"],function(e,t){function r(t){var n=e.ui.dialog.prototype[t];e.ui.dialog.prototype[t]=function(){n.apply(this,arguments),this._trigger(t,null,{dialog:this,arguments:arguments})}}function l(t,n){var r=e(t),i=r.find(".vci-dialog-content"),s=i.outerHeight(!0)-i.height();n||i.css("height","auto");var o=i.position();i.height(n?n[0]+"px":Math.max(0,r.height()-o.top-s)),n&&n.length>1&&c(i,n),h()}function c(e,t){var n=t[0];for(var r=1;t.length>r;r++)n+=t[r],e=e.parent(),e.height(n+"px"),e.css("min-height",n)}function h(){e(".ui-widget-overlay").width(e("body").innerWidth()),e(".ui-widget-overlay").height(e(document).height())}function p(t){var n=e(t);return t===window||t===document?{x:e(t).width(),y:n.height()}:{x:n.outerWidth(),y:n.outerHeight()}}function d(e){var t=e.appendTo||window,r=p(t),i=r.x-2*n,s=r.y-2*n;e.maxWidth<i&&(i=e.maxWidth),e.maxHeight<s&&(s=e.maxHeight);var o=e.style,u;switch(o){case"small":u={x:400,minX:400,maxX:400,maxY:500,minY:200};break;case"large":u={x:960,minX:960,maxX:1200,maxY:720,minY:350};break;default:u={x:600,minX:600,maxX:600,maxY:450,minY:300}}e.bypassStandardSizing&&(u={x:"auto",minX:0,maxX:i,maxY:s,minY:0}),typeof u.x=="number"&&u.x>i&&(u.x=i),u.maxX>i&&(u.maxX=i),u.minX>i&&(u.minX=i),u.maxY>s&&(u.maxY=s),u.minY>s&&(u.minY=s);if(e.fixedHeightHierarchy&&e.fixedHeightHierarchy.length>0){var a=0;for(var f=0;f<e.fixedHeightHierarchy.length;f++)a+=e.fixedHeightHierarchy[f];u.maxY=a,u.minY=a}return e.fixedWidth&&(u.maxX=e.fixedWidth,u.minX=e.fixedWidth),u}function v(e,t){var n={my:"center",at:"center",of:window,collision:"fit"};if(e||t)e&&(e>0&&(n.my+="+"),n.my+=e),n.my+=" center",t&&(t>0&&(n.my+="+"),n.my+=t);return n}var n=20,i=["_size","_setOption","_createOverlay","_destroyOverlay","_makeDraggable"];e.each(i,function(e,t){r(t)});var s=function(e,t){var n=t.dialog.options;(n.maxWidth||n.minWidth)&&t.dialog.uiDialog.css({maxWidth:n.maxWidth,minWidth:n.minWidth})},o=function(e,t){var n=t.arguments[0],r=t.arguments[1];if(n==="hideCloseButton"){var i=t.dialog.uiDialog.find(".ui-dialog-titlebar-close");r?i.hide():i.show()}},u=function(){var t=e(".ui-widget-overlay");t.length===1?t.addClass("animate"):(t.removeClass("animate"),t.removeClass("on")),t.last().addClass("on")},a=function(){e(".ui-widget-overlay").last().addClass("on")},f=function(e,t){t.dialog.uiDialog.draggable("option",{containment:"window",scroll:!1})},m=function(t){var n=t.bypassStandardSizing,r=t.style||"medium",i=d(t),c=["vci-dialog",r];t.title||c.push("no-titlebar"),t.dialogClass&&c.push(t.dialogClass);var h=e("<div />");if(r!=="small"&&t.utilityBar){var p=e("<div />").addClass("vci-dialog-utilitybar").html(t.utilityBar);h.append(p)}var m=e("<div />").addClass("vci-dialog-content").addClass(r).html(t.content);h.append(m);var g,y,b,w,E,S;return E=function(e,t){w=t.position},S=function(e,t){if(w){var n=t.position.left-w.left,r=t.position.top-w.top;y.options.position=v(n,r)}},h.on({dialog_size:s,dialog_setoption:o,dialog_createoverlay:u,dialog_destroyoverlay:a,dialog_makedraggable:f,dialogdragstart:E,dialogdragstop:S}),g=h.dialog({appendTo:t.appendTo,draggable:t.draggable,closeText:"",closeOnEscape:t.closeOnEscape,style:r,modal:!0,resizable:!1,width:i.x,maxWidth:i.maxX,maxHeight:i.maxY,minWidth:i.minX,minHeight:i.minY,title:t.title,buttons:t.buttons,show:200,hide:100,dialogClass:c.join(" "),position:v(0,0),open:function(s,o){var u=e(this).closest(".ui-dialog");t.closeOnOverlayClick&&e(".ui-widget-overlay").on("click",function(){h.dialog("close")}),l(this,t.fixedHeightHierarchy);var a=null;if(t.icon)switch(t.icon){case"info":a="vci-info-icon";break;case"warning":a="vci-warning-icon"}var f=u.find(".ui-dialog-title");f[0].scrollWidth>f[0].offsetWidth&&f.attr("title",f.text()),t.hideCloseButton&&u.find(".ui-dialog-titlebar-close").hide(),u.find(".ui-dialog-titlebar-close .ui-button-icon").html("&#xe617;").addClass("vci-font-icon");var c;a&&(c=e("<span />").addClass("ui-dialog-titlebar-icon").addClass(a),u.find(".ui-dialog-titlebar").prepend(c));if(r!=="small"&&(t.titleBarExtras||t.search)){c=e("<span />").addClass("vci-dialog-tbextra").html(t.titleBarExtras);if(t.search){var p=e("<span/>").addClass("vci-dialog-search"),v=e("<div/>").attr("tabindex","0").addClass("search-text");p.append(v),t.search.placeholder&&p.append(e("<span/>").addClass("placeholder").text(t.search.placeholder)),p.append(e("<span/>").addClass("vci-font-icon search")),c.prepend(p),v.on({mousedown:function(e){e.stopPropagation()},focus:function(t){e(this).prop("contentEditable",!0),p.find(".placeholder").hide(),p.addClass("expanded")},blur:function(t){var n=e(this);n.prop("contentEditable",!1),n.text()===""&&p.find(".placeholder").show(),p.removeClass("expanded")}}),p.on("click",function(){v.focus()})}c.insertBefore(u.find(".ui-dialog-titlebar-close"))}if(t.buttonPaneExtras){var m=u.find(".ui-dialog-buttonpane"),g=e("<div />").addClass("vci-dialog-bpextra").html(t.buttonPaneExtras);g.find("button").button(),m.prepend(g)}u.find(".ui-dialog-buttonpane button").addClass("vci-button");if(n||r==="large"){var y=u.find(".vci-dialog-content"),w=y[0];w.scrollHeight>w.clientHeight&&e(this).dialog("option",{maxHeight:i.maxY}),(w.scrollHeight>w.clientHeight||w.scrollWidth>w.clientWidth||u.find(".ui-dialog-buttonset").width()>u.find(".ui-dialog-buttonpane").width())&&e(this).dialog("option",{width:i.maxX}),l(this,t.fixedHeightHierarchy)}b=function(n){var r=d(t);e(n.data).dialog("option",{maxWidth:r.maxX,maxHeight:r.maxY}),l(n.data,t.fixedHeightHierarchy)},e(window).on("resize",null,this,b),t.open&&t.open.call(this,s,o)},close:function(n,r){t.close&&t.close.call(this,n,r),b&&e(window).off("resize",b),h.remove()},beforeClose:t.beforeClose}),y=g.data("ui-dialog"),y.contentUpdated=function(){l(h[0],t.fixedHeightHierarchy),y._position()},g};return t.subscribe(function(e){m(e)}),{create:m}}),define("hbs!desktopTemplates/themeCss",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){return",#questionContent"}function c(e,t){return"\r\n	-webkit-transition-property:background-color;\r\n	-webkit-transition-duration: 0.5s;\r\n	-webkit-transition-timing-function: linear;\r\n\r\n	-moz-transition-property:background-color;\r\n	-moz-transition-duration:0.5s;\r\n	-moz-transition-timing-function: linear;\r\n\r\n	-o-transition-property:background-color;\r\n	-o-transition-duration:0.5s;\r\n	-o-transition-timing-function: linear;\r\n\r\n	transition-property:background-color;\r\n	transition-duration:0.5s;\r\n	transition-timing-function: linear;\r\n"}function h(e,t){var r="",i;return r+="\r\n	background-color: ",(i=n.SurveyContentBackgroundColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyContentBackgroundColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n",r}function p(e,t){var r="",i;r+="\r\n	",i=n["if"].call(e,e.SurveyContentBackgroundColor,{hash:{},inverse:f.noop,fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;return r+="\r\n",r}function d(e,t){var r="",i;return r+="\r\n		background-color: ",(i=n.SurveyContentBackgroundColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyContentBackgroundColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n	",r}function v(e,t){var r="",i;return r+="\r\n	color : ",(i=n.SurveyQuestionFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n",r}function m(e,t){var r="",i;r+="\r\n	font-family : ",(i=n.SurveyQuestionFontFamily)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontFamily,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+=";\r\n",r}function g(e,t){return"\r\n	-webkit-transition-property:color;\r\n	-webkit-transition-duration: 0.5s;\r\n	-webkit-transition-timing-function: linear;\r\n\r\n	-moz-transition-property:color;\r\n	-moz-transition-duration:0.5s;\r\n	-moz-transition-timing-function: linear;\r\n\r\n	-o-transition-property:color;\r\n	-o-transition-duration:0.5s;\r\n	-o-transition-timing-function: linear;\r\n\r\n	transition-property:color;\r\n	transition-duration:0.5s;\r\n	transition-timing-function: linear;\r\n"}function y(e,t){var r="",i;return r+="\r\n	color : ",(i=n.SurveyFooterFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyFooterFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n",r}function b(e,t){var r="",i;r+="\r\n    font-family : ",(i=n.SurveyFooterFontFamily)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyFooterFontFamily,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+=";\r\n",r}function w(e,t){var r="",i;return r+="\r\n    background-color : ",(i=n.SurveyHeaderColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyHeaderColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n",r}function E(e,t){var r="",i;return r+="\r\n    background-color : ",(i=n.SurveyPageBackgroundColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyPageBackgroundColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n",r}function S(e,t){var r="",i;return r+="\r\n	/*Theme:QuestionTextColor*/\r\n	color : ",(i=n.SurveyQuestionFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n",r}function x(e,t){var r="",i;r+="\r\n    /*Theme:QuestionFontFamily*/\r\n    font-family : ",(i=n.SurveyQuestionFontFamily)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontFamily,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+=";\r\n",r}function T(e,t){var r="",i;return r+="\r\n    /*Theme:SurveyFooterFontColor*/\r\n    color : ",(i=n.SurveyFooterFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyFooterFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n",r}function N(e,t){var r="",i;r+="\r\n    /*Theme:SurveyFooterFontFamily*/\r\n    font-family : ",(i=n.SurveyFooterFontFamily)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyFooterFontFamily,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+=";\r\n",r}function C(e,t){return"\r\n	-webkit-transition-property:color;\r\n	-webkit-transition-duration: 0.5s;\r\n	-webkit-transition-timing-function: linear;\r\n\r\n	-moz-transition-property:color;\r\n	-moz-transition-duration:0.5s;\r\n	-moz-transition-timing-function: linear;\r\n\r\n	-o-transition-property:color;\r\n	-o-transition-duration:0.5s;\r\n	-o-transition-timing-function: linear;\r\n\r\n	transition-property:color;\r\n	transition-duration:0.5s;\r\n	transition-timing-function: linear;\r\n    "}function k(e,t){var r="",i;return r+="\r\n    color : ",(i=n.SurveyQuestionFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n	",r}function L(e,t){var r="",i;r+="\r\n	font-family : ",(i=n.SurveyQuestionFontFamily)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontFamily,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+=";\r\n	",r}function A(e,t){var r="",i;return r+="\r\n    /*Theme:QuestionTextColor*/\r\n    color : ",(i=n.SurveyQuestionFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n",r}function O(e,t){var r="",i;r+="\r\n.survey-page-divider {\r\n    ",i=n["if"].call(e,e.showTransition,{hash:{},inverse:f.noop,fn:f.program(32,C,t),data:t});if(i||i===0)r+=i;return r+="\r\n\r\n    border-top-color: ",(i=n.SurveyQuestionFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n}\r\n",r}function M(e,t){var r="",i;r+="\r\n    /*Theme:AnswerFontFamily*/\r\n    font-family : ",(i=n.SurveyAnswerFontFamily)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyAnswerFontFamily,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+=" !important;\r\n	",r}function _(e,t){var r="",i;return r+="\r\n    /*Theme:AnswerFontFamily*/\r\n    color : ",(i=n.SurveyAnswerFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyAnswerFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+" !important;\r\n	",r}function D(e,t){var r="",i;return r+="\r\n		color : ",(i=n.SurveyQuestionFontColor)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontColor,i=typeof i===u?i.apply(e):i),r+=a(i)+";\r\n	",r}function P(e,t){var r="",i;r+="\r\n	    font-family : ",(i=n.SurveyQuestionFontFamily)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyQuestionFontFamily,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+=";\r\n    ",r}function H(e,t){var r="",i;r+="\r\n	font-family: ",(i=n.SurveyAnswerFontFamily)?i=i.call(e,{hash:{},data:t}):(i=e.SurveyAnswerFontFamily,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+=";\r\n	",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+="/*Theme:ContentBackgroundColor*/\r\n.question ",o=n.unless.call(t,t.toggleQ3UXResponding,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\r\n{\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyContentBackgroundColor,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n.survey-page-divider-no-margin {\r\n",o=n["if"].call(t,t.toggleQ3UXResponding,{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n/*Theme:Required*/\r\n\r\n#questionRequiredText {\r\n",o=n["if"].call(t,t.SurveyQuestionFontColor,{hash:{},inverse:f.noop,fn:f.program(10,v,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyQuestionFontFamily,{hash:{},inverse:f.noop,fn:f.program(12,m,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n/*Theme:LegalTextColor*/\r\n.legaltext {\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(14,g,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyFooterFontColor,{hash:{},inverse:f.noop,fn:f.program(16,y,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyFooterFontFamily,{hash:{},inverse:f.noop,fn:f.program(18,b,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n/*Theme:SurveyFooterFontColor*/\r\n.footer-text {\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(14,g,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyFooterFontColor,{hash:{},inverse:f.noop,fn:f.program(16,y,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyFooterFontFamily,{hash:{},inverse:f.noop,fn:f.program(18,b,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n.footer-text-color {\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(14,g,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyFooterFontColor,{hash:{},inverse:f.noop,fn:f.program(16,y,i),data:i});if(o||o===0)s+=o;s+="\r\n\r\n}\r\n\r\n\r\n/*Theme:HeaderColor*/\r\n#banner {\r\nbackground-image:none;\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyHeaderColor,{hash:{},inverse:f.noop,fn:f.program(20,w,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n/*Theme:HeaderImage*/\r\n#banner {\r\n    height:auto;\r\n    text-align:left;\r\n}\r\n\r\n#headerImage {\r\n    display:block;\r\n}\r\n\r\n#headerImage img {\r\n	display:block;\r\n}\r\n\r\n/*Theme:PageBackgroundColor*/\r\nbody {\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyPageBackgroundColor,{hash:{},inverse:f.noop,fn:f.program(22,E,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n.questionheader, .questionheader p, .visioncritical-questiontext {\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(14,g,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyQuestionFontColor,{hash:{},inverse:f.noop,fn:f.program(24,S,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyQuestionFontFamily,{hash:{},inverse:f.noop,fn:f.program(26,x,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n#nav .msg{\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(14,g,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyQuestionFontColor,{hash:{},inverse:f.noop,fn:f.program(28,T,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyFooterFontFamily,{hash:{},inverse:f.noop,fn:f.program(30,N,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n.questionRequiredStar, .questionErrorMsg {\r\n    ",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(32,C,i),data:i});if(o||o===0)s+=o;s+="\r\n    ",o=n["if"].call(t,t.SurveyQuestionFontColor,{hash:{},inverse:f.noop,fn:f.program(34,k,i),data:i});if(o||o===0)s+=o;s+="\r\n	",o=n["if"].call(t,t.SurveyQuestionFontFamily,{hash:{},inverse:f.noop,fn:f.program(36,L,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n.openendedtext .buttonbody .textanswermessage,\r\n.openendedtext .buttonbody .charRange {\r\n",o=n["if"].call(t,t.showTransition,{hash:{},inverse:f.noop,fn:f.program(14,g,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyQuestionFontColor,{hash:{},inverse:f.noop,fn:f.program(38,A,i),data:i});if(o||o===0)s+=o;s+="\r\n",o=n["if"].call(t,t.SurveyQuestionFontFamily,{hash:{},inverse:f.noop,fn:f.program(12,m,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n",o=n["if"].call(t,t.SurveyQuestionFontColor,{hash:{},inverse:f.noop,fn:f.program(40,O,i),data:i});if(o||o===0)s+=o;s+="\r\n\r\n.answer-font-family {\r\n	",o=n["if"].call(t,t.SurveyAnswerFontFamily,{hash:{},inverse:f.noop,fn:f.program(42,M,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n.answer-font-color {\r\n	",o=n["if"].call(t,t.SurveyAnswerFontColor,{hash:{},inverse:f.noop,fn:f.program(44,_,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n.openendedtext .textareaContainer .textAnswerErrorText,\r\n.allocationAmountMessage,\r\n.ns_numeric_slider .ns_error\r\n{\r\n	",o=n["if"].call(t,t.SurveyQuestionFontColor,{hash:{},inverse:f.noop,fn:f.program(46,D,i),data:i});if(o||o===0)s+=o;s+="\r\n	",o=n["if"].call(t,t.SurveyQuestionFontFamily,{hash:{},inverse:f.noop,fn:f.program(48,P,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\ntextarea,input[type='text']{\r\n	",o=n["if"].call(t,t.SurveyAnswerFontFamily,{hash:{},inverse:f.noop,fn:f.program(50,H,i),data:i});if(o||o===0)s+=o;s+="\r\n}\r\n\r\n.ui-dialog.visioncritical-highlighterInstructionDialog,.vci-dialog.visioncritical-highlighterInstructionDialog .ui-dialog-buttonpane .ui-button {\r\n	",o=n["if"].call(t,t.SurveyAnswerFontFamily,{hash:{},inverse:f.noop,fn:f.program(42,M,i),data:i});if(o||o===0)s+=o;return s+="\r\n}\r\n\r\n",s})}),define("desktop/theming",["jQueryFramework","constants","hbs!desktopTemplates/themeCss","desktop/views/headerView","desktop/views/footerImageView","utils"],function(e,t,n,r,i,s){var o="surveyStyle",u=function(){a(t.ThemeValues)},a=function(t,u,a){var f=e("#"+o);f.length===1&&f.remove();var l=s.isQ3SurveyRespondingUXImprovementsEnabled(),c=n({SurveyHeaderColor:t.SurveyHeaderColor,SurveyPageBackgroundColor:t.SurveyPageBackgroundColor,SurveyContentBackgroundColor:t.SurveyContentBackgroundColor,SurveyQuestionFontFamily:t.SurveyQuestionFontFamily,SurveyQuestionFontColor:t.SurveyQuestionFontColor,SurveyAnswerFontFamily:t.SurveyAnswerFontFamily,SurveyAnswerFontColor:t.SurveyAnswerFontColor,SurveyFooterFontFamily:t.SurveyFooterFontFamily,SurveyFooterFontColor:t.SurveyFooterFontColor,SurveyQuestionFontSize:t.SurveyQuestionFontSize,SurveyAnswerFontSize:t.SurveyAnswerFontSize,showTransition:a,toggleQ3UXResponding:l}),h=document.head||document.getElementsByTagName("head")[0],p=document.createElement("style");p.setAttribute("id",o),p.type="text/css",p.styleSheet?p.styleSheet.cssText=c:p.appendChild(document.createTextNode(c)),h.appendChild(p);var d=t.SurveyDesktopHeaderImage_IsAssetUrn==="true",v=r.create(t.SurveyDesktopHeaderImage,d);v.$root.appendTo("#banner");var m=t.SurveyFooterLogoImage_IsAssetUrn==="true",g=i.create(t.SurveyFooterLogoImage,m);g.$root.appendTo("#controls"),e("p.legaltext,#footer.use-footer-links p").text(t.SurveyFooterText)};return{applyTheme:u,overrideTheme:a}}),define("desktop/main",["data","step","page","utils","desktop/navView","desktop/views/footerView","desktop/views/headerView","desktop/views/footerImageView","constants","scripting","desktop/pageHtmlHelper","cookies","automation","openWindow","event!enableDirty","localization","scriptingLibraryErrorHandler","desktop/dialog","desktop/theming","themeSwitcher","jQueryFramework"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){var E=function(){var o=function(){var e=s.create();e.$root.appendTo(w("#pagecontent"))};if(a.ThemeSelectionEnabled&&a.IsHtmlSurvey){var u=JSON.parse(a.ThemeListJsonString);u&&u.length>0?b.initialize(y,"#communityThemesContainer",u,a.ActiveThemeLabel):y.applyTheme()}else y.applyTheme();w(document).ready(function(){function s(){l.pageReady(),n.pageReady(),f.executeOnClientRenderedScripts(),w.each(n.getAllNonPageQuestionDefinitions(),function(e,t){l.getQuestionElementById(t.ObjectId).removeAttr("aria-busy")}),d.publish(),h.addAutomationReadyElement()}m.verifyLoaded(),r.disableBrowserBackButtonDefaultBehavior(),v.setCurrentCulture(t.getStep().UiLanguage),p.initialize(),e.initialize(),e.localizeInitialDataPoints(f.getScriptableCurrentQuestions()),t.renameEqfProperties(n.getAllNonPageQuestionDefinitions()),f.executeOnLoadScripts(),i.initialize(),n.createQuestions(l.getQuestionElementById),o(),l.updateQuestionText();var u=setTimeout(s,1001);l.onAnswerFontLoaded(function(){clearTimeout(u),s()}),c.createTimezoneOffsetCookie()})};return{run:E}}),define("hbs!templates/questionTextView",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function f(e,t){var r="",i,s;r+="\r\n	    ",s=n["if"].call(e,(i=e.image,i==null||i===!1?i:i.isTop),{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(s||s===0)r+=s;return r+="\r\n    ",r}function l(e,t){var n="",r,i;n+='\r\n            <img src="',i=(r=(r=e.image,r==null||r===!1?r:r.src),typeof r===u?r.apply(e):r);if(i||i===0)n+=i;return n+='" />\r\n	    ',n}function c(e,t){var r="",i,s;r+="\r\n        ",s=n.unless.call(e,(i=e.image,i==null||i===!1?i:i.isTop),{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(s||s===0)r+=s;return r+="\r\n    ",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this;s+='<div class="visioncritical-questiontext">\r\n	',o=n["if"].call(t,t.image,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;s+="\r\n\r\n   	",(o=n.text)?o=o.call(t,{hash:{},data:i}):(o=t.text,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+="\r\n\r\n    ",o=n["if"].call(t,t.image,{hash:{},inverse:a.noop,fn:a.program(4,c,i),data:i});if(o||o===0)s+=o;return s+="\r\n</div>\r\n",s})}),define("messageStep",["constants","hbs!templates/questionTextView","viewUtils","utils","jQueryFramework"],function(e,t,n,r,i){var s=function(e){return(e.StepType==="TerminationPoint"||e.StepType==="WorkflowTerminus")&&e.RespondingPlugin===""},o=function(n){var s=n.questionDefinition,o=function(){return!0},u=function(){var o;s.StepType==="TerminationPoint"?(o=s.Message,n.modifyNextButton({html:e.FinishButtonText,event:function(e){e.preventDefault(),r.handleRedirect(s.StrippedRedirectUrl)},hide:s.TerminationPointType===1?!1:!0})):(o="<p>"+e.ResponseMessage+"</p>",n.modifyNextButton({hide:!0}));var u=t({text:o,image:!1});return i(u)};return{createView:u,isComplete:o,getObjectId:function(){return s.ObjectId}}};return{create:o,shouldHandleQuestion:s}}),define("plugins/ExtendedQuestions/InstructionPlugin/Scripts/main",[],function(){var e=function(e){return e.RespondingPlugin==="InstructionPlugin"},t=function(e){var t=e.questionDefinition,n=function(){return!0};return{isComplete:n,getObjectId:function(){return t.ObjectId}}};return{create:t,shouldHandleQuestion:e}}),define("pluginsShared/OpenEnd/Desktop/Date/dateAnswer",["jQueryFramework","constants","utils","event!aboutToSubmit","localization"],function(e,t,n,r,i){var s=function(s,o){var u,a,f,l=o.questionDefinition,c={};l.RespondingPlugin=="OpenEndDatePlugin"?(c.minYear=l.CustomQuestionProperties.MinYear,c.maxYear=l.CustomQuestionProperties.MaxYear):(c.minYear="0",c.maxYear="0");var h=function(){return a.val()},p=function(){a.focus()},d=function(e){var t=i.parseDate(e);if(t===null)return!1;var n=t.getFullYear();return n<c.minYear||n>c.maxYear?!1:!0},v=function(e){e==undefined&&(e=a.val());var t=o.dataStore.getAnswer(s.ObjectId);if(t===!0){if(d(e)||e==="")if(l.RespondingPlugin=="OpenEndDatePlugin"){var r=n.localizeDateToISO8601String(e);o.dataStore.setOpenEndText(r)}else o.dataStore.setAnswerText(s.ObjectId,e);o.completionStatusChanged()}},m=function(){var e=parseInt(c.minYear);e<=0&&(c.minYear=1900);var t=parseInt(c.maxYear);if(t<=0){var n=new Date;c.maxYear=n.getFullYear()+2}},g=function(){var e=n.getLocalizedDateFormat();return e=e.toLowerCase(),e=e.replace("yyyy","yy"),e},y=function(){var t=i.getCurrentCulture().name;e.datepicker.regional[t]={monthNamesShort:[o.getLocalizedString("Jan"),o.getLocalizedString("Feb"),o.getLocalizedString("Mar"),o.getLocalizedString("Apr"),o.getLocalizedString("May"),o.getLocalizedString("Jun"),o.getLocalizedString("Jul"),o.getLocalizedString("Aug"),o.getLocalizedString("Sep"),o.getLocalizedString("Oct"),o.getLocalizedString("Nov"),o.getLocalizedString("Dec")],dayNamesMin:[o.getLocalizedString("Su"),o.getLocalizedString("Mo"),o.getLocalizedString("Tu"),o.getLocalizedString("We"),o.getLocalizedString("Th"),o.getLocalizedString("Fr"),o.getLocalizedString("Sa")],dateFormat:g()},e.datepicker.setDefaults(e.datepicker.regional[t])},b=function(){var e=o.getLocalizedString("DateFormat"),t=e&&e!=="undefined";return t?e:n.getLocalizedDateFormat().toLowerCase()},w=function(){function i(){a.datepicker("widget").find(".ui-datepicker-month").attr("title",o.getLocalizedString("Month")),a.datepicker("widget").find(".ui-datepicker-year").attr("title",o.getLocalizedString("Year"))}u=e("<div class='dateOpenEnd'></div>"),a=e("<input type='text'></input>").addClass("textanswer answer-font-color").attr("id",t.TextAreaPrefix+s.ObjectId).attr("autocomplete","off").attr({placeholder:b(),maxlength:"10"}),f=e("<span class='vci-font-icon calendar' aria-label='calendar icon'/>");var r=o.dataStore.getAnswerText(s.ObjectId);r=n.ISO8601DateToLocalizedString(r),a.val(r),a.datepicker({showOn:"button",changeMonth:!0,changeYear:!0,yearRange:c.minYear+":"+c.maxYear,minDate:new Date(c.minYear,0,1),maxDate:new Date(c.maxYear,11,31),onSelect:function(e){v(e)}}),a.keyup(function(t){t.keyCode==9&&e(this).click(),i(),v(a.val())}),f.click(function(){a.datepicker("show").blur(),i()}),u.append(a),u.append(f);var h=n.formatString(o.getLocalizedString("ErrorText"),[c.minYear,c.maxYear,b()]);s.ValidationObject={ErrorText:h,YearRange:c};var p=l.Required?t.Required:t.NotRequired;a.attr("aria-label",o.getLocalizedString("DateText")+". "+p+". "+h),o.loadCss("../Shared/OpenEnd/Desktop/Date/dateAnswer.css")},E=function(){m(),y(),w(),r.subscribe(function(){a.attr("disabled","disabled"),f.attr("disabled","disabled")})};return E(),{ui:u,updateDataPoint:v,validate:d,getValue:h,focus:p}};return{create:s}}),define("pluginsShared/OpenEnd/openEndValidation",["constants"],function(e){var t=function(){var e=/^\d$/;return function(t){var n=0;for(var r=0;r<t.length;r++)e.test(t[r])&&n++;return n}}(),n=15,r=function(r){return t(r)>n?e.MaximumDigitsMessage.replace("{0}",n):null};return{checkMaxDigitsForNumeric:r,MaximumDigits:n}}),define("plugins/Shared/OpenEnd/Desktop/textAnswer",["data","event!aboutToSubmit","utils","constants","pluginsShared/OpenEnd/Desktop/Date/dateAnswer","pluginsShared/OpenEnd/openEndValidation","localization","jQueryFramework"],function(e,t,n,r,i,s,o,u){var a=function(s,a){if(s.IsText!==!0){var f=n.formatString("Error: Can not create textAnswer when answerDefinition.isText == false; \n\n answerDefinition:\n{0}",[s]);throw f}var l=a.questionDefinition,c,h,p,d,v,m=function(){return s.TextValidationType===r.ValidationTypeDateTime},g=function(){return s.TextValidationType===r.ValidationTypeNumeric},y=function(){return s.TextValidationType===r.ValidationTypePostalCodeCA},b=function(){return s.TextValidationType===r.ValidationTypeZipCode},w=function(){return s.TextValidationType===r.ValidationTypeNone},E=function(){return s.TextValidationType===r.ValidationTypePhoneNumber},S=function(){return s.TextValidationType===r.ValidationTypeEmailAddress},x=function(){if(m())return d.getValue();var e=h.val();return e},T=function(){m()?d.focus():h.focus()},N=function(){var e=x();if(e!=""){if(m())return d.validate(e);var t=s.ValidationObject.Regex,n=new RegExp(t);return e.match(n)?!0:!1}return e.length==0?!1:e!=null&&e.length==0&&!question.IsRequired?!0:!0},C=function(){var e={min:s.MinimumTextLength||0,max:s.MaximumTextLength||300};return g()&&(e.max=s.MaximumTextLength),e},k=function(){var e=0;return e=g()?x().replace(/[^0-9]/g,"").length:x().length,e},L=function(e){var t=C(e),n=/^((?!chrome|android|crios|fxios|Windows).)*safari/i.test(navigator.userAgent);n&&k()>t.max&&h.val(h.val().substring(0,t.max));var r=k();return t.min>0&&r<t.min&&r>0||t.max>0&&r>t.max&&r>0||l.Required&&r==0?!1:!0},A=function(){var e=Math.max(x().indexOf("."),x().indexOf(","));return e===-1?!0:x().length-1-e<=5},O=function(e){var t,n="";if(m())t=d.validate(x()),t||(n=s.ValidationObject.ErrorText);else if(w())t=L(),!t&&s.MinimumTextLength>1&&x().length>0&&(n=a.getLocalizedString("MinimumLengthText").replace("{0}",s.MinimumTextLength));else if(g()){var i=N()&&!isNaN(o.parseFloat(h.val())),u=L(),f=A(),l=a.getLocalizedString("MinimumLengthText").replace("{0}",s.MinimumTextLength);x()===""?n=s.MinimumTextLength>1?l:"":i?f?u||(n=l):n=a.getLocalizedString("ExceededDecimalPlacesText").replace("{0}",o.formatFloat(.12345,5)):n=a.getLocalizedString("InfoText").replace("{0}",o.formatFloat(r.ValidationDigitsSampleValue,1)),t=u&&i&&f}else{var c=N();c||(n=s.ValidationObject.ErrorText),t=c&&L()}if(typeof e=="function"){var p="";s.TextValidationType===r.ValidationTypeNone&&(p=M()),e.call(this,n,p,t)}return t},M=function(){var e=s.MaximumTextLength-x().length;return e},_=function(){var e=s.Height;if(e===undefined||e===0)e=1;w()&&e===1&&s.MaximumTextLength>75&&u.isEmptyObject(s.CustomAnswerProperties)&&(e=2),h.height("auto").attr({rows:e})},D=function(){var e=function(e){return e>=48&&e<=57||e>=96&&e<=105};h.keydown(function(t){var n=x().replace(/[\d]/g,"").length;e(t.which)&&!t.shiftKey||t.which===8||t.metaKey||t.ctrlKey?h.attr({maxlength:s.MaximumTextLength+n}):(t.key.length===1||t.shiftKey)&&h.attr({maxlength:s.MaximumTextLength+n+1})})},P=function(){return s.Height===1&&(l.RespondingPlugin==="SingleChoicePlugin"||l.RespondingPlugin==="MultipleChoicePlugin"||s.MaximumTextLength<=75&&w)},H=function(){var e=function(e){return e>=65&&e<=90||e>=97&&102},t=function(e){return e>=48&&e<=57};h.keypress(function(n){if(n.metaKey)return!0;var r=n.which,i=32,s=46,o=45,u=44,a=13;if(E())return t(r)||r===o||r===i||r===s?!0:!1;if(b())return t(r)?!0:!1;if(y())return t(r)||e(r)||r===i?!0:!1;if(g())return t(r)||r===o||r==s||r==u?!0:!1;if(P()&&r===a)return!1})},B=function(){if(m())d.updateDataPoint();else{var e=a.dataStore.getAnswer(s.ObjectId);if(e===!0){var t=h.val();g()?u.trim(t)===""&&(t=""):y()&&t.indexOf(" ")!=3&&(t=t.slice(0,3)+" "+t.slice(3)),a.dataStore.setAnswerText(s.ObjectId,t),a.completionStatusChanged()}}},j=function(e){return e.replace(/ /g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},F=function(){h.keyup(function(e){B()}),h.change(function(e){B()})},I=function(){var t=e.inputByAnswerIdStepId(s.ObjectId,l.ObjectId),r=t.val();h.val(n.htmlDecodeString(r))},q=function(){h.addClass("answer-font-color"),E()?h.attr({placeholder:a.getLocalizedString("PhonePlaceholderText"),maxlength:"12"}):S()?(h.attr({placeholder:a.getLocalizedString("EmailPlaceholderText"),maxlength:"254"}),h.addClass("email-input")):y()?h.attr({placeholder:a.getLocalizedString("PostalCodePlaceholderText"),maxlength:"7"}):b()?h.attr({placeholder:a.getLocalizedString("ZipCodePlaceholderText"),maxlength:"5"}):g()?h.attr({placeholder:a.getLocalizedString("NumericTypeText")}):l.RespondingPlugin==="OpenEndNoValidationPlugin"&&h.attr({placeholder:a.getLocalizedString("NoValidationPlaceholder")})},R=function(){_(),F(),I(),q(),H(),g()&&D(),w()&&h.addClass("novalidation"),t.subscribe(function(){h.attr("disabled","disabled")}),h.on("keypress",function(e){e.stopPropagation()});var e="error_"+s.ObjectId,n="message_"+s.ObjectId;h.attr("aria-describedby",e+" "+n)},U=function(){return!w()||P()?"<input type='text' id='{0}' name='{1}' class='textanswer' aria-label='{2}' maxlength='{3}'>":"<textarea id='{0}' name='{1}' class='textanswer' aria-label='{2}' maxlength='{3}'></textarea>"},z=function(){var e=l.Required?r.Required:r.NotRequired,t,n=a.getLocalizedString("InfoText");return E()?t=a.getLocalizedString("PhonePlaceholderText"):S()?t=a.getLocalizedString("EmailPlaceholderText"):y()?t=a.getLocalizedString("PostalCodePlaceholderText"):b()?t=a.getLocalizedString("ZipCodePlaceholderText"):g()?(t=a.getLocalizedString("NumericTypeText"),n=n.replace("{0}",r.ValidationDigitsSampleValue)):w()&&(t=a.getLocalizedString("TextFieldText"),n=n.replace("{0}",s.MinimumTextLength).replace("{1}",s.MaximumTextLength)),t+". "+e+". "+n},W=function(){if(m())d=i.create(s,a),p=d.ui,c=p;else{var e=r.TextAreaPrefix+s.ObjectId,t=C(),o=z();h=u(n.formatString(U(),[e,e,o,t.max])),R(),c=u("<div></div>"),c.append(h)}};return W(),{answerDefinition:s,isDate:m,updateDataPoint:B,getValue:x,focus:T,validate:O,ui:c,addedToPage:function(){}}};return{create:a}}),define("plugins/Shared/OpenEnd/Desktop/openEnd",["jQueryFramework","./textAnswer","utils","data","constants"],function(e,t,n,r,i){var s=function(s){var o=s.questionDefinition,u=o.AnswerCollection[0],a=t.create(u,s),f,l,c=function(){var t,n=a.getValue();return n.length===0&&!o.Required?(l.html(""),l.hide(),f&&f.hide(),t=!0):t=a.validate(function(t,n){t!==l.html()&&l.html(t),e.trim(t).length>0?l.show():l.hide(),n.toString()!==f.html()&&f.html(n),e.trim(n).length>0?f.show():f.hide()}),t},h=function(){var t=n.formatString("#pluginRoot_{0}",[o.ObjectId]);return e(t)},p=function(){$pluginRoot=h().addClass("openendedtext");var t=e("<div></div>").addClass("textareaContainer").appendTo($pluginRoot),n=e("<div></div>").addClass("textareaplaceholder").appendTo(t);n.append(a.ui),f=e("<div></div>").addClass("textanswermessage").attr("id","lengthmessage_"+u.ObjectId).appendTo(n),l=e("<div></div>").addClass("textAnswerErrorText").attr("id","error_"+u.ObjectId).appendTo(t),u.TextValidationType===i.ValidationTypeNone&&(n.addClass("novalidation"),l.addClass("novalidation")),r.selectedByAnswerIdStepId(u.ObjectId,o.ObjectId).val(!0)},d=function(){var e=h().parent().parent().find(".questionheader").find("label");a.addedToPage(e)};return{isComplete:c,createView:p,getObjectId:function(){return o.ObjectId},addedToPage:d}};return{create:s}}),define("plugins/ExtendedQuestions/OpenEndEmailAddressPlugin/Scripts/main",["jQueryFramework","plugins/Shared/OpenEnd/Desktop/openEnd"],function(e,t){var n=function(e){return e.RespondingPlugin==="OpenEndEmailAddressPlugin"};return{shouldHandleQuestion:n,create:t.create}}),define("plugins/ExtendedQuestions/OpenEndNoValidationPlugin/Scripts/main",["jQueryFramework","plugins/Shared/OpenEnd/Desktop/openEnd"],function(e,t){var n=function(e){return e.RespondingPlugin==="OpenEndNoValidationPlugin"};return{shouldHandleQuestion:n,create:t.create}}),define("plugins/ExtendedQuestions/OpenEndNumericPlugin/Scripts/main",["jQueryFramework","plugins/Shared/OpenEnd/Desktop/openEnd"],function(e,t){var n=function(e){return e.RespondingPlugin==="OpenEndNumericPlugin"};return{shouldHandleQuestion:n,create:t.create}}),define("plugins/ExtendedQuestions/OpenEndPhoneNumberPlugin/Scripts/main",["jQueryFramework","plugins/Shared/OpenEnd/Desktop/openEnd"],function(e,t){var n=function(e){return e.RespondingPlugin==="OpenEndPhoneNumberPlugin"};return{shouldHandleQuestion:n,create:t.create}}),define("plugins/ExtendedQuestions/OpenEndPostalCodePlugin/Scripts/main",["jQueryFramework","plugins/Shared/OpenEnd/Desktop/openEnd"],function(e,t){var n=function(e){return e.RespondingPlugin==="OpenEndPostalCodePlugin"};return{shouldHandleQuestion:n,create:t.create}}),define("plugins/ExtendedQuestions/OpenEndZipCodePlugin/Scripts/main",["jQueryFramework","plugins/Shared/OpenEnd/Desktop/openEnd"],function(e,t){var n=function(e){return e.RespondingPlugin==="OpenEndZipCodePlugin"};return{shouldHandleQuestion:n,create:t.create}}),define("plugins/ExtendedQuestions/OpenEndDatePlugin/Scripts/main",["jQueryFramework","plugins/Shared/OpenEnd/Desktop/openEnd"],function(e,t){var n=function(e){return e.RespondingPlugin==="OpenEndDatePlugin"};return{shouldHandleQuestion:n,create:t.create}}),define("hbs!pluginsShared/Choice/Desktop/templates/choiceTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){return this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{},'<div class="vc-choice-buttons">\r\n    <div class="button-container" data-template-element-id="container"></div>\r\n</div>'})}),define("hbs!pluginsShared/Choice/Desktop/templates/rowTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){return this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{},'<div class="row"></div>'})}),define("hbs!pluginsShared/Choice/Desktop/templates/columnTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){return this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{},'<div class="column"></div>'})}),define("hbs!pluginsShared/Choice/Desktop/templates/button",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){return"checkbox"}function c(e,t){return"radio"}function h(e,t){return"multi"}function p(e,t){return"single"}function d(e,t){return'\r\n                <div class="selected-icon" data-template-element-id="selectedIcon"></div>\r\n            '}function v(e,t){var r="",i;r+='\r\n        <div class="label answer-font-family answer-font-color" data-template-element-id="text">',(i=n.Text)?i=i.call(e,{hash:{},data:t}):(i=e.Text,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+="</div>\r\n        ",r}function m(e,t){var r,i;return i=n.unless.call(e,(r=e.Answer,r==null||r===!1?r:r.IsText),{hash:{},inverse:a.noop,fn:a.program(14,g,t),data:t}),i||i===0?i:""}function g(e,t){return" empty"}function y(e,t){var r="",i;return r+='\r\n        <div class="image-container">\r\n            <div class="image imagePlaceholder" style="width:',(i=n.Width)?i=i.call(e,{hash:{},data:t}):(i=e.Width,i=typeof i===u?i.apply(e):i),r+=f(i)+"px;height:",(i=n.Height)?i=i.call(e,{hash:{},data:t}):(i=e.Height,i=typeof i===u?i.apply(e):i),r+=f(i)+'px" data-template-element-id="image">\r\n                <img src="',(i=n.Image)?i=i.call(e,{hash:{},data:t}):(i=e.Image,i=typeof i===u?i.apply(e):i),r+=f(i)+'" alt="'+f((i=(i=(i=(i=e.Answer,i==null||i===!1?i:i.CustomAnswerProperties),i==null||i===!1?i:i.VcSharedImage),i==null||i===!1?i:i.AltText),typeof i===u?i.apply(e):i))+'" />\r\n            </div>\r\n        </div>\r\n        ',r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this,f=this.escapeExpression;s+='<div class="button" role="',o=n["if"].call(t,t.isMultiChoice,{hash:{},inverse:a.program(3,c,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='" aria-checked="false" tabindex="0">\r\n    <div class="button-header" data-template-element-id="buttonHeader">\r\n        <div class="toggle ',o=n["if"].call(t,t.isMultiChoice,{hash:{},inverse:a.program(7,p,i),fn:a.program(5,h,i),data:i});if(o||o===0)s+=o;s+='" data-template-element-id="toggle">\r\n            ',o=n["if"].call(t,t.isMultiChoice,{hash:{},inverse:a.program(9,d,i),fn:a.program(9,d,i),data:i});if(o||o===0)s+=o;s+="\r\n        </div>\r\n        ",o=n["if"].call(t,t.Text,{hash:{},inverse:a.noop,fn:a.program(11,v,i),data:i});if(o||o===0)s+=o;s+='\r\n\r\n    </div>\r\n    <div class="button-body',o=n.unless.call(t,t.Image,{hash:{},inverse:a.noop,fn:a.program(13,m,i),data:i});if(o||o===0)s+=o;s+='" data-template-element-id="buttonBody" >\r\n        ',o=n["if"].call(t,t.Image,{hash:{},inverse:a.noop,fn:a.program(16,y,i),data:i});if(o||o===0)s+=o;return s+="        \r\n    </div>\r\n</div>\r\n",s})}),define("pluginsShared/Choice/Desktop/js/answerView",["hbs!../templates/button","plugins/Shared/OpenEnd/Desktop/textAnswer","viewUtils","jQueryFramework","desktop/imageUtils","images"],function(e,t,n,r,i,s){function o(o,u,a){function w(){var e=u.getAnswer(f.ObjectId);e?(l.$root.addClass("selected"),l.$toggle.addClass("selected"),l.$root.attr("aria-checked",!0)):(l.$root.removeClass("selected"),l.$toggle.removeClass("selected"),l.$root.attr("aria-checked",!1)),c||S(),c=!1}function E(){b&&(b.focus(),b.updateDataPoint(),x())}function S(){b&&(r(b.ui).find('textarea,input[type="text"]').blur(),l.$buttonBody.find(".textAnswerErrorText").html("").hide(),l.$buttonBody.find(".textanswermessage").html("").hide())}function x(){var e=u.getAnswer(f.ObjectId);return b&&b.getValue()===""&&e?!1:b&&e?b.validate():!0}function T(){var e=!u.isMultiChoice()||u.isMultiChoice()&&f.Exclusive,t=u.getAnswer(f.ObjectId);c=!0,t||(E(),x()),t&&!e&&S(),u.toggle(f.ObjectId,e),a(f.ObjectId)}function N(){if(h){var e=l.$buttonBody.find("img");e.imagesLoaded().done(function(){l.$buttonBody.find(".image").removeClass("imagePlaceholder"),d<1&&i.renderExpandOverlay(e.parent(),e.parents(".button").find(".label").text(),h)}),e.show()}b&&b.addedToPage()}var f=o,l,c=!1,h=f.CustomAnswerProperties.VcSharedImage?f.CustomAnswerProperties.VcSharedImage.AssetUrl:null,p=null,d=null,v=null,m=null,g,y=h?f.ShowHtmlToRespondent:!0;h&&(g=f.CustomAnswerProperties.VcSharedImage,d=Math.min(g.Width>u.getMaxButtonWidth()?u.getMaxButtonWidth()/g.Width:1,g.Height>u.getMaxImageHeight()?u.getMaxImageHeight()/g.Height:1),v=Math.round(g.Width*d),m=Math.round(g.Height*d),p=s.getEqfImageUrl(g,v,m));var b=null,C=e({Answer:f,isMultiChoice:u.isMultiChoice()&&!f.Exclusive,Text:y?f.Html:"",Image:p,Width:v,Height:m});l=n.grabElements(C),l.$root.on("click",function(e){e.stopPropagation(),T()}),l.$root.on("keypress",function(e){e.stopPropagation();var t=e.keyCode===r.ui.keyCode.ENTER||e.keyCode===r.ui.keyCode.SPACE;t&&(f.IsText&&(e.preventDefault(),b.focus()),T())}),l.$root.on("mousedown",function(e){r(e.target).is('textarea,input[type="text"]')||e.preventDefault()}),l.$root.on("keyup",function(e){!r(e.target).is('button[type="submit"]')&&e.keycode===r.ui.keyCode.ENTER&&(e.returnValue=!1)});if(f.IsText){f.Html===""&&r(l.$buttonHeader.label).remove(),b=t.create(o,u.pluginHost);var k=r("<div/>").addClass("text-input");k.append(b.ui).appendTo(l.$buttonHeader),k.find('textarea,input[type="text"]').attr({tabindex:"-1"}).on("click",function(e){u.getAnswer(f.ObjectId)&&!f.isExclusive&&e.stopPropagation()})}return{$ui:l.$root,refresh:w,addedToPage:N,validateTextAnswer:x}}return{create:o}}),define("pluginsShared/Choice/Desktop/js/choiceView",["hbs!../templates/choiceTemplate","hbs!../templates/rowTemplate","hbs!../templates/columnTemplate","pluginsShared/Choice/Desktop/js/answerView","constants","viewUtils","jQueryFramework","underscore"],function(e,t,n,r,i,s,o,u){function a(a){function h(i){function f(e){var t=[],n=0;return u.each(e,function(e){var n=r.create(e,a,g);c.push(n),t.push(n.$ui)}),t}function h(e){var n=o(t());return n.append(f(e)),n}function p(e){var t=o(n());return t.append(f(e)),t}function d(e){var t=a.rowCount(),n=a.columnCount(),r=[],i=0;while(i<e.length){var s=e.slice(i,i+n);r.push(h(s)),i+=n}return r}function v(e){var t=a.columnCount(),n=[],r=Math.floor(e.length/t),i=e.length%t,s=0;while(s<e.length){var o=i>0,u=o?r+1:r;o&&(i-=1);var f=e.slice(s,s+u);n.push(p(f)),s+=u}return n}function m(){return a.isVerticalLayout()?v(i.AnswerCollection):d(i.AnswerCollection)}function g(){u.each(c,function(e){e.refresh()})}return l=s.grabElements(e()),l.$container.append(m()),g(),l.$root}function p(){function t(e){var t=r(e)?250:f;return u.reduce(e,function(e,n){var r=Math.max(t,o(n).width());return r>e?r:e},0)}function n(e){return u.reduce(e,function(e,t){var n=o(t).height();return n>e?n:e},0)}function r(e){return e.find(".text-input").length>0}function s(e){a.isVerticalLayout()?p(e):h(e),g(e)}function h(r){var i=r.find(".row"),s=r.find("img"),u=r.find(".button"),f=0,l,c;d(u),l=Math.min(a.getMaxButtonWidth(),Math.max(t(u.find(".button-body")),t(u.find(".button-header"))+1)),v(u),c=l+20,u.width(l),i.each(function(t,r){u=o(r).find(".button"),m(o(r))||u.find(".button-body").css("display","none");var i=n(u.find(".button-body"))-e,s=n(u.find(".button-header")),a=0;u.each(function(e,t){var n=o(t).children(".button-body"),r=o(t).children(".button-header");r.width(l),r.css("min-height",s),n.width(l),n.height(i),n.children(".image-container").width(Math.round(l)),n.children(".image-container").height(Math.round(i)),o(t).css("min-height",i+s),a+=c}),f=Math.max(a+1,f)}),i.width(f),r.find(".button-container").width(f)}function p(r){var i=r.find(".button"),s=r.find(".column"),u=r.find("img"),f=0,l,c;m(r)||i.find(".button-body").css("display","none"),d(i),l=Math.min(a.getMaxButtonWidth(),Math.max(t(u),t(i.find(".button-header"))+1)),c=l+20,f=c*s.length+1,s.width(c),v(i),i.each(function(e,t){var n=o(t).children(".button-body"),r=o(t).children(".button-header");r.width(l),n.width(l),n.children(".image-container").width(Math.floor(l)),o(t).width(l)}),s.first().find(".button").each(function(t,r){var i=s.find(".button:nth-child("+(t+1)+")");m(i)||i.find(".button-body").css("display","none");var o=n(i.find(".button-header")),u=n(i.find(".button-body"))-e;i.find(".button-header").css("min-height",o),i.find(".button-body").height(Math.round(u)),i.find(".button-body").children(".image-container").height(Math.round(u)),i.css("min-height",u+o)}),r.find(".button-container").width(f)}function d(e){e.each(function(e,t){o(t).find(".text-input").length>0&&o(t).find("textarea").hide()})}function v(e){e.each(function(e,t){o(t).find(".text-input").length>0&&o(t).find("textarea").show()})}function m(e){return e.find("img").length>0}function g(e){e.find(".image").each(function(e,t){var n=o(t).parent().width()-o(t).width(),r=o(t).parent().height()-o(t).parent().next(".text-input").outerHeight()-o(t).height();i.IsRtlContentDirection?o(t).css({right:Math.max(n/2,0),top:Math.max(r/2,0)}):o(t).css({left:Math.max(n/2,0),top:Math.max(r/2,0)})})}var e=3;u.each(c,function(e){e.addedToPage()}),s(l.$root),typeof callback=="function"&&callback()}function d(){var e=!0;return u.each(c,function(t){e=e&&t.validateTextAnswer()}),e}var f=125,l=null,c=[];return{createView:h,addedToPage:p,areAnswersValid:d}}return{create:a}}),define("pluginsShared/Choice/Desktop/js/choiceViewModel",["underscore","data"],function(e,t){function n(n){function h(t,r){e.each(o.AnswerCollection,function(e){t===e.ObjectId?s.setAnswer(e.ObjectId,r?!0:!m(t)):(r||e.Exclusive)&&s.setAnswer(e.ObjectId,!1)}),n.completionStatusChanged()}function p(){var t=!1;return e.each(o.AnswerCollection,function(e){e.IsText&&(t=!0)}),t}function d(){var e=a>=2?Math.max((_PAGE_MAX-_BUTTON_PADDING*a)/a,_BUTTON_MIN):r;return e}function v(){return i}function m(e){return s.getAnswer(e)}function g(){var n=!o.Required;return e.each(o.AnswerCollection,function(e){n=n||t.isSelectedByAnswerIdStepId(e.ObjectId,o.ObjectId)}),n}var r=720,i=500;_BUTTON_MIN=125,_BUTTON_PADDING=20,_PAGE_MAX=927,_COLUMNS_MAX=6;var s=n.dataStore,o=n.questionDefinition,u=!!o.AllowMultipleSelection,a=parseInt(o.AnswerColumns),f=parseInt(o.AnswerRows),l=o.AnswerOrientation===1,c=o.AnswerCollection.length;return a==0&&f==0?(a=_COLUMNS_MAX,f=Math.ceil(c/a),l=!1):a==0?a=Math.ceil(c/f):f==0&&(f=Math.ceil(c/a)),a>_COLUMNS_MAX&&(a=_COLUMNS_MAX,f=Math.ceil(c/_COLUMNS_MAX)),{toggle:h,getAnswer:m,columnCount:function(){return a},rowCount:function(){return f},isMultiChoice:function(){return u},isVerticalLayout:function(){return l},getMaxButtonWidth:d,getMaxImageHeight:v,isComplete:g,pluginHost:n}}return{create:n}}),define("pluginsShared/Choice/Desktop/js/choiceButtons",["./choiceView","./choiceViewModel"],function(e,t){function n(n){function r(){return s.createView(n.questionDefinition)}var i=t.create(n),s=e.create(i);return{createView:r,addedToPage:function(){s.addedToPage()},areAnswersValid:function(){return s.areAnswersValid()}}}return{create:n}}),define("plugins/ExtendedQuestions/SingleChoicePlugin/Scripts/main",["jQueryFramework","constants","pluginsShared/Choice/Desktop/js/choiceButtons"],function(e,t,n){var r=function(e){return e.RespondingPlugin==="SingleChoicePlugin"},i=function(e){var t=n.create(e),r=e.questionDefinition,i=function(){if(!r.Required&&t.areAnswersValid())return!0;var n=0;for(var i=0,s=r.AnswerCollection.length;i<s;i++){var o=r.AnswerCollection[i];e.dataStore.getAnswer(o.ObjectId,r)&&n++}var u=!1;return n==1&&(u=!0),u=u&&t.areAnswersValid(),u},s=function(){t.addedToPage&&t.addedToPage()};return{isComplete:i,createView:t.createView,getObjectId:function(){return r.ObjectId},addedToPage:s}};return{create:i,shouldHandleQuestion:r}}),define("hbs!plugins/ExtendedQuestions/SingleChoiceDropDownPlugin/templates/dropdownAnswerView",["handlebars"],function(e){return e.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression;s+='﻿<li id="',(o=n.answerId)?o=o.call(t,{hash:{},data:i}):(o=t.answerId,o=typeof o===u?o.apply(t):o),s+=a(o)+'" tabindex="0" class="dropdown-option answer-font-family" data-value="',(o=n.text)?o=o.call(t,{hash:{},data:i}):(o=t.text,o=typeof o===u?o.apply(t):o),s+=a(o)+'" role="option" aria-setsize="',(o=n.setsize)?o=o.call(t,{hash:{},data:i}):(o=t.setsize,o=typeof o===u?o.apply(t):o),s+=a(o)+'" aria-posinset="',(o=n.position)?o=o.call(t,{hash:{},data:i}):(o=t.position,o=typeof o===u?o.apply(t):o),s+=a(o)+'">',(o=n.text)?o=o.call(t,{hash:{},data:i}):(o=t.text,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+="</li>",s})}),define("plugins/ExtendedQuestions/SingleChoiceDropDownPlugin/Scripts/main",["jQueryFramework","utils","viewUtils","hbs!../templates/dropdownAnswerView"],function(e,t,n,r){var i=function(e){return e.RespondingPlugin==="SingleChoiceDropDownPlugin"},s=function(i){var s=i.questionDefinition,o=[],u,a=function(){if(!s.Required)return!0;var e=0;for(var t=0;t<o.length;t++)o[t].isSelected&&e++;return e===1?!0:!1},f=function(e){var t=e.index();l();if(t===0)e.addClass("dropdown-option-selected"),e.closest("div").find(".dropdown-default-text").html(e.text());else for(var n=0;n<o.length;n++)if(o[n].answerId===e.attr("id")){h(o[n]);break}i.completionStatusChanged()},l=function(){for(var e=0;e<o.length;e++)c(o[e])},c=function(e){e.isSelected=!1,e.element.attr("class","dropdown-option answer-font-family"),i.dataStore.setAnswer(e.answerId,!1)},h=function(e){e.element.addClass("dropdown-option-selected"),e.element.closest("div").find(".dropdown-default-text").html(e.element.text()),e.isSelected=!0,i.dataStore.setExclusiveAnswer(e.answerId)},p=function(){for(var e=0;e<o.length;e++){var t=o[e],n=i.dataStore.getAnswer(t.answerId);if(n){h(t);break}}},d=function(){var t=function(e,t){t?e.attr("aria-expanded",!1):e.attr("aria-expanded",!0)};u=e("<div />").addClass("dropdown-container");var a=e('<div tabindex="0">').addClass("dropdown-default-option").attr("role","combobox").attr("aria-labelledby","questionText_"+s.ObjectId).attr("aria-expanded",!1),l=e("<div>"+i.getLocalizedString("CustomComboBoxString")+"</div>").addClass("dropdown-default-text answer-font-family"),c=e("<div />").addClass("dropdown-arrow");a.append(l).append(c),u.append(a),u.append('<ul class="single-choice-dropdown"></ul>').attr("role","listbox");var h=function(t,i){var u=r({answerId:t.ObjectId,text:n.removeC1ParagraphMargin(t.Html),position:i+2,setsize:s.AnswerCollection.length+1}),a=e(u);return o.push({answerId:t.ObjectId,element:a,hasOpenEnd:!1}),a},d=e('<li tabindex="0">'+i.getLocalizedString("CustomComboBoxString")+"</li>");d.addClass("dropdown-option answer-font-family").attr("role","option").attr("aria-setsize",s.AnswerCollection.length+1).attr("aria-posinset",1),u.find("ul").append(d);for(var v=0;v<s.AnswerCollection.length;v++)u.find("ul").append(h(s.AnswerCollection[v],v));return u.find("div.dropdown-default-option").on("click",function(n){n.stopPropagation(),u.find("ul").toggle(),t(e(n.currentTarget),u.find("ul").is(":hidden"))}),u.find("div.dropdown-default-option").on("keyup",function(n){n.stopPropagation();if(n.which===e.ui.keyCode.ENTER||n.which===e.ui.keyCode.SPACE)u.find("ul").toggle(),t(e(n.currentTarget),u.find("ul").is(":hidden"))}),u.find("ul").on("click","li",function(n){var r=e(this);n.stopPropagation(),u.find("ul").children("li").removeClass("dropdown-option-selected"),u.find("ul").toggle(),f(r),t(u.find("div.dropdown-default-option"),u.find("ul").is(":hidden"))}),u.find("ul").on("keyup","li",function(n){var r=e(this);n.stopPropagation();if(n.which==13||n.which==32)u.find("ul").children("li").removeClass("dropdown-option-selected"),u.find("ul").toggle(),f(r),t(u.find("div.dropdown-default-option"),u.find("ul").is(":hidden"));n.keyCode===e.ui.keyCode.UP&&r.prev().focus(),n.keyCode===e.ui.keyCode.DOWN&&r.next().focus()}),e("html").on("click",function(e){u.find("ul").hide(),t(u.find("div.dropdown-default-option"),u.find("ul").is(":hidden"))}),p(),u},v=function(){var n=e(t.formatString("#pluginRoot_{0}",[s.ObjectId])).parent().parent().find(".questionheader div").first();n.attr("id","questionText_"+s.ObjectId);var r=u.find("ul"),i=r.width();u.find("div.dropdown-default-option").width(r.width()-12+"px");var o=0,a=setInterval(function(){if(i!==r.width()){u.find("div.dropdown-default-option").width(r.width()-12+"px"),clearInterval(a);return}if(o>=20){clearInterval(a);return}++o},50)};return{isComplete:a,createView:d,getObjectId:function(){return s.ObjectId},addedToPage:v}};return{create:s,shouldHandleQuestion:i}}),define("plugins/ExtendedQuestions/MultipleChoicePlugin/Scripts/main",["jQueryFramework","pluginsShared/Choice/Desktop/js/choiceButtons"],function(e,t){var n=function(e){return e.RespondingPlugin==="MultipleChoicePlugin"},r=function(n){var r=t.create(n),i=n.questionDefinition,s=function(){function t(){for(var e=0,t=i.AnswerCollection.length;e<t;e++){var r=i.AnswerCollection[e];if(n.dataStore.getAnswer(r.ObjectId,i))return!0}return!1}var s=n.dataStore.isValidResponse([i],i.AnswerCollection,i.Required?1:0,1,i.ApplyMinMaxLimits?i.MinimumSelection:1,i.ApplyMinMaxLimits?i.MaximumSelection:i.AnswerCollection.length,i.Required),o=e("#"+i.ObjectId+" .questionErrorMsg");return o&&o.toggle(!s&&t()),s&&r.areAnswersValid()},o=function(){r.addedToPage&&r.addedToPage()};return{isComplete:s,createView:r.createView,getObjectId:function(){return i.ObjectId},addedToPage:o}};return{create:r,shouldHandleQuestion:n}}),define("hbs!pluginsShared/Grid/Desktop/templates/gridTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){return this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{},'<div class="grid-container">\r\n	<div class="grid-head-container" data-template-element-id="head"></div>\r\n</div>'})}),define("hbs!pluginsShared/Grid/Desktop/templates/rowTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function c(e,t){return'role="group"'}function h(e,t){return'role="radiogroup"'}function p(e,t){var r="",i,s;r+='\r\n        <div class="row-label-image imagePlaceholder" style="width:',(i=n.Width)?i=i.call(e,{hash:{},data:t}):(i=e.Width,i=typeof i===a?i.apply(e):i),r+=f(i)+"px;height:",(i=n.Height)?i=i.call(e,{hash:{},data:t}):(i=e.Height,i=typeof i===a?i.apply(e):i),r+=f(i)+'px"><img src="',(i=n.Image)?i=i.call(e,{hash:{},data:t}):(i=e.Image,i=typeof i===a?i.apply(e):i),r+=f(i)+'" alt="'+f((i=(i=(i=(i=e.Row,i==null||i===!1?i:i.CustomRowProperties),i==null||i===!1?i:i.VcSharedImage),i==null||i===!1?i:i.AltText),typeof i===a?i.apply(e):i))+'" /></div>\r\n        ',s=n.unless.call(e,e.IsImageOnly,{hash:{},inverse:l.noop,fn:l.program(6,d,t),data:t});if(s||s===0)r+=s;return r+="\r\n        ",r}function d(e,t){var n="",r,i;n+='\r\n        <div class="row-label-text answer-font-family answer-font-color">',i=(r=(r=e.Row,r==null||r===!1?r:r.Html),typeof r===a?r.apply(e):r);if(i||i===0)n+=i;return n+="</div>\r\n        ",n}function v(e,t){return'\r\n    <div class="marker-home selected">\r\n        <div class="marker single selected" tabindex="0" data-attribute-code="" role="radio" aria-checked="true"><div class="selected-icon"></div></div>\r\n    </div>\r\n    '}function m(e,t,r){var i="",s;i+='\r\n    <div class="grid-cell">\r\n        ',s=n["if"].call(e,r.Multichoice,{hash:{},inverse:l.programWithDepth(y,t,e),fn:l.programWithDepth(g,t,e),data:t});if(s||s===0)i+=s;return i+="\r\n    </div>\r\n    ",i}function g(e,t,n){var r="",i;return r+='\r\n            <div class="marker multi" tabindex="0" data-attribute-code="'+f((i=e.ObjectId,typeof i===a?i.apply(e):i))+'" aria-labelledby="col-label-'+f((i=n.ObjectId,typeof i===a?i.apply(e):i))+'" role="checkbox" aria-checked="false"><div class="selected-icon"></div></div>\r\n        ',r}function y(e,t,n){var r="",i;return r+='\r\n            <div class="marker single" data-attribute-code="'+f((i=e.ObjectId,typeof i===a?i.apply(e):i))+'" aria-labelledby="col-label-'+f((i=n.ObjectId,typeof i===a?i.apply(e):i))+'" role="radio" aria-checked="false"><div class="selected-icon"></div></div>\r\n        ',r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this;s+='<div class="grid-row" id="#row_'+f((o=(o=t.Row,o==null||o===!1?o:o.ObjectId),typeof o===a?o.apply(t):o))+'" aria-labelledby="row-label-'+f((o=(o=t.Row,o==null||o===!1?o:o.ObjectId),typeof o===a?o.apply(t):o))+'" ',u=n["if"].call(t,t.Multichoice,{hash:{},inverse:l.program(3,h,i),fn:l.program(1,c,i),data:i});if(u||u===0)s+=u;s+='>\r\n    <div class="row-label" id="row-label-'+f((o=(o=t.Row,o==null||o===!1?o:o.ObjectId),typeof o===a?o.apply(t):o))+'">\r\n        ',u=n["if"].call(t,(o=(o=(o=t.Row,o==null||o===!1?o:o.CustomRowProperties),o==null||o===!1?o:o.VcSharedImage),o==null||o===!1?o:o.AssetUrl),{hash:{},inverse:l.program(6,d,i),fn:l.program(5,p,i),data:i});if(u||u===0)s+=u;s+="\r\n    </div>\r\n    ",u=n.unless.call(t,t.Multichoice,{hash:{},inverse:l.noop,fn:l.program(8,v,i),data:i});if(u||u===0)s+=u;s+="\r\n    ",u=n.each.call(t,t.Columns,{hash:{},inverse:l.noop,fn:l.programWithDepth(m,i,t),data:i});if(u||u===0)s+=u;return s+="\r\n\r\n</div>",s})}),define("pluginsShared/Grid/Desktop/js/choiceGridRowView",["hbs!../templates/rowTemplate","jQueryFramework","handlebars","desktop/imageUtils","images"],function(e,t,n,r,i){function s(n,s){function w(i){c=t(e({Row:f,Columns:a,Multichoice:u,IsImageOnly:l,Id:i,Image:d,Width:m,Height:g}));if(p){var s=c.find("img");s.imagesLoaded().done(function(){c.find(".row-label-image").removeClass("imagePlaceholder"),v<1&&r.renderExpandOverlay(s.parent(),s.parents(".row-label").children(".row-label-text").text(),p)}),s.show()}return c.find(".grid-cell").each(function(e,n){var r=u&&a[e].Exclusive,i=t(n).find(".marker");r&&(t(n).addClass("exclusive"),i.addClass("exclusive")),(e+1)%2&&t(n).addClass("alternate");var s=x(i);D(s)&&C(s)}),c.find(".row-label-text").css("width",n.getLabelWidth()),h=!0,c}function E(){c.find(".marker").on("click",function(e){var t=x(e.target);!u||!T(t).hasClass("selected")?C(t):k(t)}),c.find(".marker.single").on("keyup",function(e){var n,r=constants.IsRtlContentDirection;e.keyCode===t.ui.keyCode.RIGHT?r?n=t(this).parent().prev().find(".marker"):n=t(this).parent().next().find(".marker"):e.keyCode===t.ui.keyCode.LEFT&&(r?n=t(this).parent().next().find(".marker"):n=t(this).parent().prev().find(".marker")),n&&n.length>0&&(C(x(n)),n.focus())}).on("keydown",function(e){(e.keyCode===t.ui.keyCode.RIGHT||e.keyCode===t.ui.keyCode.LEFT)&&e.preventDefault()}),c.find(".marker.multi").on("keyup",function(e){if(e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER){e.stopPropagation(),e.preventDefault();var n=x(this);o.indexOf(n)>=0?k(n):C(n)}}).on("keydown",function(e){e.keyCode===t.ui.keyCode.ENTER&&e.preventDefault()}),c.find(".grid-cell,.marker-home").on("click",function(e){var n=t(e.target).find(".marker"),r=x(n);!u||!T(r).hasClass("selected")?C(r):k(r)})}function S(e){return T(e).hasClass("exclusive")}function x(e){return t(e).attr("data-attribute-code")}function T(e){return N(e).parent()}function N(e){return c.find(".marker[data-attribute-code='"+e+"']")}function C(e){if(typeof e=="undefined")return;!u||S(e)?L():u&&!S(e)&&A(e),T(e).addClass("selected");var t=N(e);t.attr("aria-checked","true"),t.addClass("selected"),u||t.attr("tabindex","0"),h&&(M(e),H())}function k(e){var t=N(e);T(e).removeClass("selected"),t.removeClass("selected"),t.attr("aria-checked","false"),h&&(_(e),H())}function L(){var e=c.find(".marker");e.attr("checked","false"),c.find(".selected").removeClass("selected"),u||e.removeAttr("tabindex")}function A(e){c.find(".grid-cell.exclusive.selected").each(function(n,r){var i=x(t(r).find(".marker"));i!==e&&k(i)})}function O(){return o}function M(e){u?(o||(o=[]),S(e)?o=[e]:(o.indexOf(e)===-1&&o.push(e),t.each(o,function(t,n){S(n)&&n!==e&&o.splice(o.indexOf(n),1)}))):o=e}function _(e){if(!u)return;o.indexOf(e)>=0&&o.splice(o.indexOf(e),1)}function D(e){return u?o.indexOf(e)>=0:e===o}function P(){return f.ObjectId}function H(){c.trigger("change",[P(),o])}var o=s.Value,u=n.isMultichoice,a=n.getColumns(),f=s.Row,l=f.CustomRowProperties.VcSharedDisplayText==="false",c=null,h=!1,p=f.CustomRowProperties.VcSharedImage?f.CustomRowProperties.VcSharedImage.AssetUrl:null,d=null,v=null,m=null,g=null,y=n.getLabelWidth();if(p){var b=f.CustomRowProperties.VcSharedImage;v=b.Width>y?y/b.Width:1,m=b.Width*v,g=b.Height*v,d=i.getEqfImageUrl(b,m,g)}return{createView:w,addedToPage:E,getName:P,getValue:O}}return{create:s}}),define("hbs!pluginsShared/Grid/Desktop/templates/headerTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression;s+='<div class="grid-header">\r\n    <div class="header-label answer-font-family answer-font-color" id="col-label-',(o=n.Id)?o=o.call(t,{hash:{},data:i}):(o=t.Id,o=typeof o===u?o.apply(t):o),s+=a(o)+'">',(o=n.Label)?o=o.call(t,{hash:{},data:i}):(o=t.Label,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+="</div>\r\n</div>",s})}),define("pluginsShared/Grid/Desktop/js/choiceGridHeaderView",["hbs!../templates/headerTemplate","jQueryFramework"],function(e,t){function n(n){function r(){var r=[],i=n.getLabelWidth(),s=n.getColumnWidth(),o=t(e({Label:""}));o.addClass("row-label-placeholder").find(".header-label").css("width",i).removeAttr("id"),r.push(o);if(!n.isMultichoice){var u=t(e({Label:""}));u.addClass("marker-placeholder").find(".header-label").removeAttr("id"),r.push(u)}return t.each(n.getColumns(),function(n,i){var o=t(e({Label:i.Html,Id:i.ObjectId}));(n+1)%2&&o.addClass("alternate"),o.find(".header-label").css("width",s),r.push(o)}),r}function i(){}return{createView:r,addedToPage:i}}return{create:n}}),define("pluginsShared/Grid/js/choiceGridErrorMsg",["jQueryFramework","utils"],function(e,t){var n=function(e){var n=e.getRowCount(),r=e.getMinimumSelection(),i=e.getMaximumSelection(),s=e.getRows().length,o=e.getColumns().length,u=constants.IsMobile,a=n>=s;if(r===1&&i>1&&o>i&&n>=1){if(!a)return u?t.formatString(e.getLocalizedString("ErrorAtMostAnswersOrMoreQuestions"),[i,n]):t.formatString(e.getLocalizedString("ErrorAtMostAnswersOrMoreRows"),[i,n]);if(a&&s>1)return u?t.formatString(e.getLocalizedString("ErrorAtMostAnswersEachQuestion"),[i]):t.formatString(e.getLocalizedString("ErrorAtMostAnswersEachRow"),[i]);if(a&&s===1)return t.formatString(e.getLocalizedString("ErrorAtMostAnswers"),[i])}if(r===i&&r>1&&i>1&&o>=2&&n>=1||r>1&&r===o){if(!a)return u?t.formatString(e.getLocalizedString("ErrorMustSelectAnswersOrMoreQuestions"),[r,n]):t.formatString(e.getLocalizedString("ErrorMustSelectAnswersOrMoreRows"),[r,n]);if(a&&s>1)return u?t.formatString(e.getLocalizedString("ErrorMustSelectAnswersEachQuestion"),[r]):t.formatString(e.getLocalizedString("ErrorMustSelectAnswersEachRow"),[r]);if(a&&s===1)return t.formatString(e.getLocalizedString("ErrorMustSelectAnswers"),[r])}if(o===1||r===1&&i===1&&o>=1&&s>=1){if(!a)return u?t.formatString(e.getLocalizedString("ErrorSelectOneAnswerOrMoreQuestions"),[n]):t.formatString(e.getLocalizedString("ErrorSelectOneAnswerOrMoreRows"),[n]);if(a&&s>1)return u?e.getLocalizedString("ErrorSelectOneAnswerEachQuestion"):e.getLocalizedString("ErrorSelectOneAnswerEachRow");if(a&&s===1)return e.getLocalizedString("ErrorSelectOneAnswer")}if((r>1&&i>=o&&n>=1||r===1&&i===o&&o>1)&&(r!==1||i!==o)){if(!a)return u?t.formatString(e.getLocalizedString("ErrorSelectAtLeastAnswersOrMoreQuestions"),[r,n]):t.formatString(e.getLocalizedString("ErrorSelectAtLeastAnswersOrMoreRows"),[r,n]);if(a&&s>1)return u?t.formatString(e.getLocalizedString("ErrorSelectAtLeastAnswersEachQuestion"),[r]):t.formatString(e.getLocalizedString("ErrorSelectAtLeastAnswersEachRow"),[r]);if(a&&s===1)return t.formatString(e.getLocalizedString("ErrorSelectAtLeastAnswers"),[r])}if(r===0&&i===0&&o>1||r===1&&i===o){if(!a)return u?t.formatString(e.getLocalizedString("ErrorSelectAtLeastOneAnswerOrMoreQuestions"),[n]):t.formatString(e.getLocalizedString("ErrorSelectAtLeastOneAnswerOrMoreRows"),[n]);if(a&&s>1)return u?t.formatString(e.getLocalizedString("ErrorSelectAtLeastOneAnswerEachQuestion"),[]):t.formatString(e.getLocalizedString("ErrorSelectAtLeastOneAnswerEachRow"),[]);if(a&&s===1)return t.formatString(e.getLocalizedString("ErrorSelectAtLeastOneRow"),[])}if(r>0&&i<o&&r!=i){if(!a)return u?t.formatString(e.getLocalizedString("ErrorSelectBetweenAnswersOrMorQuestions"),[r,i,n]):t.formatString(e.getLocalizedString("ErrorSelectBetweenAnswersOrMoreRows"),[r,i,n]);if(a&&s>1)return u?t.formatString(e.getLocalizedString("ErrorSelectBetweenAnswersEachQuestion"),[r,i]):t.formatString(e.getLocalizedString("ErrorSelectBetweenAnswersEachRow"),[r,i]);if(a&&s===1)return t.formatString(e.getLocalizedString("ErrorSelectBetweenAnswers"),[r,i])}};return{getErrorMessage:n}}),define("pluginsShared/Grid/Desktop/js/choiceGridView",["hbs!../templates/gridTemplate","./choiceGridRowView","./choiceGridHeaderView","event!enableDirty","jQueryFramework","desktop/imageUtils","pluginsShared/Grid/js/choiceGridErrorMsg","constants"],function(e,t,n,r,i,s,o,u){function a(s){function l(){return i("#"+s.id+" .questionErrorMsg")}function c(){function c(e){var t=l();t&&t.toggle(!e)}var h=[],p="grid"+Date.now();s.onValidate(c),a=n.create(s),f=i(e()),f.find(".grid-head-container").append(a.createView(p)),i.each(s.getRows(),function(e,n){var i=t.create(s,{Value:s.getSelected(n.ObjectId),Row:n,Columns:s.getColumns(),IsMultichoice:s.isMultichoice,Id:p});u.push(i);var o=i.createView(p);o.on("change",function(e,t,n){s.setSelected(t,n),r.publish()}),h.push(o)}),f.append(h);if(s.repeatHeader>0){var d=0;f.find(".grid-row").each(function(e){d++,d%s.repeatHeader===0&&e<u.length-1&&i(this).addClass("before-repeated-header").after(i("<div/>").addClass("grid-head-container"))})}return s.isMultichoice&&l().text(o.getErrorMessage(s)),f}function h(){function e(){var e=f.children(".grid-head-container").first();f.children(".grid-head-container").slice(1).each(function(t,n){i(n).append(e.clone().children())})}a.addedToPage(),i.each(u,function(e,t){t.addedToPage()}),s.repeatHeader>0&&e()}var u=[],a=null,f=null;return{createView:c,addedToPage:h}}return{create:a}}),define("pluginsShared/Grid/Desktop/js/choiceGridModel",["data"],function(e){function t(t){function l(e,t){i?d(e,t):p(e,t)}function c(t){var r=[];for(var s=0;s<n.AnswerCollection.length;s++)e.isSelectedByAnswerIdStepId(n.AnswerCollection[s].ObjectId,t)&&r.push(n.AnswerCollection[s].ObjectId);return i?r:r.length?r[0]:null}function h(t){var n=e.selectedInputsByQuestionId(t);n.val(!1)}function p(t,n){h(t);var r=e.selectedByAnswerIdStepId(n,t);r.val(!0)}function d(t,r){h(t);for(var i=0;i<n.AnswerCollection.length;i++){var s=r.indexOf(n.AnswerCollection[i].ObjectId);if(s>=0){var o=r[s],u=e.selectedByAnswerIdStepId(o,t);u.val(!0)}}}function v(){return n.AnswerCollection}function m(){return n.WorkflowStepCollection}function g(){return n.RequiredRowCount}function y(){return n.MinimumSelection}function b(){return n.MaximumSelection}function w(){var e=Math.max(2,v().length),t=(e+1)*f,n=o-t-u,r=Math.floor(n/e),i=Math.max(a,Math.min(u,r));return i===a?o-a*e-t:u}function E(){var e=Math.max(2,v().length),t=(e+1)*f,n=o-t-u,r=Math.floor(n/e),i=Math.max(a,Math.min(u,r));return i}function S(){var e=t.dataStore.isValidResponse(n.WorkflowStepCollection,n.AnswerCollection,n.RequiredRowCount,n.WorkflowStepCollection.length,n.AllowMultipleSelection?n.ApplyMinMaxLimits?n.MinimumSelection:1:1,n.AllowMultipleSelection?n.ApplyMinMaxLimits?n.MaximumSelection:n.AnswerCollection.length:1,n.Required);return s&&typeof s=="function"&&s(e),e}var n=t.questionDefinition,r=n.RepeatHeaderEvery?parseInt(n.RepeatHeaderEvery):0,i=!!n.AllowMultipleSelection,s=null,o=i?927:885,u=150,a=40,f=21;return{getSelected:c,setSelected:l,repeatHeader:r,isMultichoice:i,getColumns:v,getRows:m,getLabelWidth:w,getColumnWidth:E,id:n.ObjectId,isComplete:S,onValidate:function(e){s=e},getRowCount:g,getMaximumSelection:b,getMinimumSelection:y,getLocalizedString:t.getLocalizedString}}return{create:t}}),define("pluginsShared/Grid/Desktop/js/choiceGrid",["./choiceGridView","./choiceGridModel"],function(e,t){function n(n){var r=t.create(n),i=e.create(r);return{createView:i.createView,addedToPage:i.addedToPage,isComplete:r.isComplete}}return{create:n}}),define("plugins/ExtendedQuestions/SingleChoiceGridPlugin/Scripts/main",["jQueryFramework","pluginsShared/Grid/Desktop/js/choiceGrid"],function(e,t){var n=function(e){return e.RespondingPlugin==="SingleChoiceGridPlugin"},r=function(e){var n=e.questionDefinition,r=t.create(e);return{isComplete:r.isComplete,createView:r.createView,addedToPage:r.addedToPage,getObjectId:function(){return n.ObjectId}}};return{shouldHandleQuestion:n,create:r}}),define("plugins/ExtendedQuestions/MultipleChoiceGridPlugin/Scripts/main",["jQueryFramework","pluginsShared/Grid/Desktop/js/choiceGrid"],function(e,t){var n=function(e){return e.RespondingPlugin==="MultipleChoiceGridPlugin"},r=function(e){var n=e.questionDefinition,r=t.create(e);return{isComplete:r.isComplete,createView:r.createView,addedToPage:r.addedToPage,getObjectId:function(){return n.ObjectId}}};return{shouldHandleQuestion:n,create:r}}),define("hbs!pluginsShared/RankOrder/Desktop/templates/rankOrderTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){return" has-images"}function c(e,t){return" no-text"}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div id="',(o=n.Id)?o=o.call(t,{hash:{},data:i}):(o=t.Id,o=typeof o===u?o.apply(t):o),s+=a(o)+'" class="rankorder-container',o=n["if"].call(t,t.HasImages,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.ImageOnly,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='">\r\n    <div class="row-container"></div>\r\n    <div class="answer-container"></div>\r\n</div>',s})}),define("hbs!pluginsShared/RankOrder/Desktop/templates/rowTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function c(e,t){return' aria-disabled="true" tabindex="-1" '}function h(e,t){return' tabindex="0" '}function p(e,t){var n,r;return r=(n=(n=e.Row,n==null||n===!1?n:n.Html),typeof n===a?n.apply(e):n),r||r===0?r:""}function d(e,t){var n="",r;return n+='\r\n    <div class="row-image imagePlaceholder" style="width:'+f((r=(r=e.Image,r==null||r===!1?r:r.Width),typeof r===a?r.apply(e):r))+"px; height:"+f((r=(r=e.Image,r==null||r===!1?r:r.Height),typeof r===a?r.apply(e):r))+'px">\r\n        <img src="'+f((r=(r=e.Image,r==null||r===!1?r:r.Url),typeof r===a?r.apply(e):r))+'" alt="'+f((r=(r=e.Image,r==null||r===!1?r:r.AltText),typeof r===a?r.apply(e):r))+'" />\r\n    </div>\r\n    ',n}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this;s+='<div class="rank-row" id="#row_'+f((o=(o=t.Row,o==null||o===!1?o:o.ObjectId),typeof o===a?o.apply(t):o))+'" data-attribute-id="'+f((o=(o=t.Row,o==null||o===!1?o:o.ObjectId),typeof o===a?o.apply(t):o))+'" role="button" ',u=n["if"].call(t,t.Value,{hash:{},inverse:l.program(3,h,i),fn:l.program(1,c,i),data:i});if(u||u===0)s+=u;s+='>\r\n    <div class="row-draggable" role="presentation"></div>\r\n    <div class="row-text answer-font-family answer-font-color">',u=n.unless.call(t,t.IsImageOnly,{hash:{},inverse:l.noop,fn:l.program(5,p,i),data:i});if(u||u===0)s+=u;s+="</div>\r\n    ",u=n["if"].call(t,t.Image,{hash:{},inverse:l.noop,fn:l.program(7,d,i),data:i});if(u||u===0)s+=u;return s+="\r\n</div>",s})}),define("hbs!pluginsShared/RankOrder/Desktop/templates/dragHelperTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\r\n    <div class="drag-image" style="width:'+a((r=(r=e.Image,r==null||r===!1?r:r.Width),typeof r===u?r.apply(e):r))+"px;height:"+a((r=(r=e.Image,r==null||r===!1?r:r.Height),typeof r===u?r.apply(e):r))+'px">\r\n        <img src="'+a((r=(r=e.Image,r==null||r===!1?r:r.Url),typeof r===u?r.apply(e):r))+'" alt="'+a((r=(r=e.Image,r==null||r===!1?r:r.AltText),typeof r===u?r.apply(e):r))+'" width="'+a((r=(r=e.Image,r==null||r===!1?r:r.Width),typeof r===u?r.apply(e):r))+'" height="'+a((r=(r=e.Image,r==null||r===!1?r:r.Height),typeof r===u?r.apply(e):r))+'" />\r\n    </div>\r\n    ',n}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="drag-helper" aria-hidden="true">\r\n    <div class="drag-draggable"></div>\r\n    <div class="drag-text answer-font-family answer-font-color">',(o=n.Html)?o=o.call(t,{hash:{},data:i}):(o=t.Html,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+="</div>\r\n    ",o=n["if"].call(t,t.Image,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\r\n</div>",s})}),define("pluginsShared/RankOrder/Desktop/js/rankOrderImages",["jQueryFramework","images"],function(e,t){function s(t){e.each(t.getRows(),function(e,t){if(t.CustomRowProperties&&t.CustomRowProperties.VcSharedImage&&t.CustomRowProperties.VcSharedImage.AssetUrl){var n=new Image,r=new Image;n.src=a(t).Url,r.src=l(t).Url}})}function o(e,n){if(!e||!e.CustomRowProperties||!e.CustomRowProperties.VcSharedImage||!e.CustomRowProperties.VcSharedImage.AssetUrl)return null;var r={Url:e.CustomRowProperties.VcSharedImage.AssetUrl,Width:e.CustomRowProperties.VcSharedImage.Width,Height:e.CustomRowProperties.VcSharedImage.Height,AltText:e.CustomRowProperties.VcSharedImage.AltText,Scale:1};if(!n)return r;var i=Math.min(r.Width>n.width?n.width/r.Width:1,r.Height>n.height?n.height/r.Height:1);if(!!n.minWidth||!!n.minHeight)i=Math.max(!!n.minWidth&&r.Width*i<n.minWidth?n.minWidth/r.Width:i,!!n.minHeight&&r.Height*i<n.minHeight?n.minHeight/r.Height:i);return i<1&&(r.Width*=i,r.Height*=i,r.Scale=i,r.Url=t.generateAssetManagerUrl(r.Url,r.Width,r.Height)),r}function u(e){return o(e)}function a(e){return o(e,n)}function f(e){return o(e,r)}function l(e){return o(e,i)}function c(e){return e.CustomRowProperties&&e.CustomRowProperties.VcSharedDisplayText==="false"}var n={width:60,height:60},r={width:208,height:208},i={width:60,height:40,minWidth:40,minHeight:40};return{preload:s,getImageProperties:u,getDragHelperImageProperties:a,getRowImageProperties:f,getAnswerImageProperties:l,isImageOnly:c}}),define("pluginsShared/RankOrder/Desktop/js/rankOrderRowView",["hbs!../templates/rowTemplate","hbs!../templates/dragHelperTemplate","jQueryFramework","handlebars","desktop/imageUtils","./rankOrderImages"],function(e,t,n,r,i,s){function o(r,o){function p(t){l=n(e({Row:f,IsImageOnly:s.isImageOnly(f),Id:t,Image:h,Value:u}));if(h){var r=l.find("img");r.imagesLoaded().done(function(){l.find(".row-image").removeClass("imagePlaceholder"),h.Scale<1&&i.renderExpandOverlay(r.parent(),r.parents(".rank-row").children(".row-text").text(),s.getImageProperties(f).Url)})}return l}function d(){if(l.draggable("option","disabled"))return;l.attr({"aria-disabled":!0,tabindex:"-1"}),l.off("click keyup"),l.draggable("disable"),l.find(".overlay-expand").hide(),l.blur()}function v(){function e(){var e=r.getNextEmptyRank();e&&(d(),l.trigger("change",[f.ObjectId,e]))}if(!l.draggable("option","disabled"))return;l.removeAttr("aria-disabled"),l.attr({tabindex:"0"}),l.draggable("enable"),l.find(".overlay-expand").show(),l.on("click",function(t){e()}),l.on("keyup",function(t){if(t.keyCode===n.ui.keyCode.SPACE||t.keyCode===n.ui.keyCode.ENTER)t.stopPropagation(),t.preventDefault(),l.nextAll(":not(.ui-draggable-disabled)").first().focus(),e()}).on("keydown",function(e){e.keyCode===n.ui.keyCode.ENTER&&e.preventDefault()})}function m(){l.draggable({containment:n("#"+r.id),appendTo:a,cursorAt:{top:r.hasImages()?44:14,left:r.hasImages()?44:104},helper:function(){var e=n(t({Html:s.isImageOnly(f)?"":f.Html,Image:s.getDragHelperImageProperties(f)}));return e},start:function(e,t){c=!0,d()},stop:function(e,t){c=!1,setTimeout(function(){r.getAnswer(f.ObjectId)||v()},1)},disabled:!0}),u||v()}var u=o.Value,a="#"+o.ContainerId,f=o.Row,l=null,c=!1,h=null;return h=s.getRowImageProperties(f),{createView:p,addedToPage:m,enable:v,disable:d,dragging:function(e){if(typeof e=="undefined")return c;c=e},id:f.ObjectId}}return{create:o}}),define("hbs!pluginsShared/RankOrder/Desktop/templates/answerTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function c(e,t){return' aria-disabled="true" tabindex="-1" '}function h(e,t){return' tabindex="0" '}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this;s+='<div class="rank-answer" id="#rank_'+f((o=(o=t.Answer,o==null||o===!1?o:o.ObjectId),typeof o===a?o.apply(t):o))+'">\r\n    <div class="answer-index">',(u=n.Index)?u=u.call(t,{hash:{},data:i}):(u=t.Index,u=typeof u===a?u.apply(t):u),s+=f(u)+'</div>\r\n    <div class="answer-box">\r\n        <div class="answer-controls">\r\n            <div class="answer-control up" role="button" aria-label="',(u=n.UpButtonLabel)?u=u.call(t,{hash:{},data:i}):(u=t.UpButtonLabel,u=typeof u===a?u.apply(t):u),s+=f(u)+'" ',u=n["if"].call(t,t.First,{hash:{},inverse:l.program(3,h,i),fn:l.program(1,c,i),data:i});if(u||u===0)s+=u;s+='></div>\r\n            <div class="answer-control down" role="button" aria-label="',(u=n.DownButtonLabel)?u=u.call(t,{hash:{},data:i}):(u=t.DownButtonLabel,u=typeof u===a?u.apply(t):u),s+=f(u)+'" ',u=n["if"].call(t,t.Last,{hash:{},inverse:l.program(3,h,i),fn:l.program(1,c,i),data:i});if(u||u===0)s+=u;return s+='></div>\r\n            <div class="answer-control clear" role="button" aria-label="',(u=n.RemoveButtonLabel)?u=u.call(t,{hash:{},data:i}):(u=t.RemoveButtonLabel,u=typeof u===a?u.apply(t):u),s+=f(u)+'" tabindex="0"></div>\r\n        </div>\r\n    </div>\r\n</div>',s})}),define("hbs!pluginsShared/RankOrder/Desktop/templates/answerContentTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function c(e,t){var r="",i;r+='\r\n    <div class="answer-text answer-font-family answer-font-color">',(i=n.Html)?i=i.call(e,{hash:{},data:t}):(i=e.Html,i=typeof i===a?i.apply(e):i);if(i||i===0)r+=i;return r+="</div>\r\n    ",r}function h(e,t){var n="",r;return n+='\r\n    <div class="answer-image imagePlaceholder">\r\n        <img src="'+f((r=(r=e.Image,r==null||r===!1?r:r.Url),typeof r===a?r.apply(e):r))+'" alt="'+f((r=(r=e.Image,r==null||r===!1?r:r.AltText),typeof r===a?r.apply(e):r))+'" width="'+f((r=(r=e.Image,r==null||r===!1?r:r.Width),typeof r===a?r.apply(e):r))+'" height="'+f((r=(r=e.Image,r==null||r===!1?r:r.Height),typeof r===a?r.apply(e):r))+'" />\r\n    </div>\r\n    ',n}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this;s+='<div class="answer-content" data-attribute-id="'+f((o=(o=t.Row,o==null||o===!1?o:o.ObjectId),typeof o===a?o.apply(t):o))+'">\r\n    <div class="answer-draggable" role="presentation"></div>\r\n    ',u=n.unless.call(t,t.IsImageOnly,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(u||u===0)s+=u;s+="\r\n    ",u=n["if"].call(t,t.Image,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(u||u===0)s+=u;return s+="\r\n</div>",s})}),define("pluginsShared/RankOrder/Desktop/js/rankOrderAnswerView",["hbs!../templates/answerTemplate","hbs!../templates/answerContentTemplate","hbs!../templates/dragHelperTemplate","jQueryFramework","handlebars","./rankOrderImages","desktop/imageUtils"],function(e,t,n,r,i,s,o){function u(i,u){function g(t){return h=r(e({Index:a,Answer:f,Id:t,First:a===1,Last:c,UpButtonLabel:i.getString("UpButtonLabel"),DownButtonLabel:i.getString("DownButtonLabel"),RemoveButtonLabel:i.getString("RemoveButtonLabel")})),u.Row&&y(u.Row),h}function y(e){e!==d&&d&&i.getAnswer(d.ObjectId)===f.ObjectId&&i.unsetAnswer(d.ObjectId);if(e===d)return;d=e,h.find(".answer-content").remove();if(!d)return;i.setAnswer(d.ObjectId,f.ObjectId),p=s.getAnswerImageProperties(d);var n=r(t({Row:e,Html:s.isImageOnly(d)?"":e.Html.replace(/<br>/g," "),IsImageOnly:!i.hasText(),Image:p}));h.find(".answer-box").prepend(n),S(n);if(p){var u=h.find("img");u.imagesLoaded().done(function(){h.find(".answer-image").removeClass("imagePlaceholder"),p.Scale<1&&o.renderExpandOverlay(u.parent(),u.parents(".answer-content").children(".answer-text").text(),s.getImageProperties(d).Url)})}}function b(){v=d?d.ObjectId:null}function w(){y(v?i.getRow(v):null)}function E(){return v}function S(e){e.draggable({containment:r("#"+i.id),appendTo:l,cursorAt:{top:i.hasImages()?44:14,left:i.hasImages()?44:104},helper:function(){var e=r(n({Html:s.isImageOnly(d)?"":d.Html,Image:s.getDragHelperImageProperties(d)}));return e},start:function(e,t){x(d.ObjectId),m=d,y(null)},stop:function(e,t){T(m.ObjectId),setTimeout(function(){i.getAnswer(m.ObjectId)||L(m.ObjectId)},1)}})}function x(e){h.trigger("row.dragstart",[e])}function T(e){h.trigger("row.dragstop",[e])}function N(e,t){h.trigger("change",[e,t])}function C(e,t){h.trigger("swap",[e,t])}function k(e,t,n){h.trigger("replace",[e,t,n])}function L(e){h.trigger("clear",[e])}function A(){h.trigger("restore")}function O(){function e(e){var t=i.getPreviousAnswer(f.ObjectId);if(!t)return;C(f.ObjectId,t.ObjectId);var n=h.prev(".rank-answer").find(".answer-control.up");n.focus(),e||n.blur()}function t(e){var t=i.getNextAnswer(f.ObjectId);if(!t)return;C(f.ObjectId,t.ObjectId);var n=h.next(".rank-answer").find(".answer-control.down");n.focus(),e||n.blur()}function n(){var e=d.ObjectId;y(null),L(e)}function s(r,i){if(r.hasClass("clear")){n();return}if(r.hasClass("up")){e(i);return}if(r.hasClass("down")){t(i);return}}h.find(".answer-control").on("click",function(e){s(r(e.target))}).on("keyup",function(e){if(e.keyCode===r.ui.keyCode.SPACE||e.keyCode===r.ui.keyCode.ENTER)e.stopPropagation(),e.preventDefault(),s(r(e.target),!0)}).on("keydown",function(e){e.keyCode===r.ui.keyCode.ENTER&&e.preventDefault()}),h.find(".answer-box").droppable({classes:{"ui-droppable-hover":"answer-droppable-hover"},over:function(e,t){!d||k(null,d.ObjectId,f.ObjectId)},out:function(e,t){A()},drop:function(e,t){var n=r(t.draggable).attr("data-attribute-id");!d||k(null,d.ObjectId,f.ObjectId),N(n,f.ObjectId)}})}var a=u.Index,f=u.Answer,l="#"+u.ContainerId,c=!!u.IsLast,h=null,p=null,d=null,v=null,m=null;return{createView:g,addedToPage:O,setAnswer:y,saveState:b,restoreState:w,getSavedRowId:E}}return{create:u}}),define("pluginsShared/RankOrder/Desktop/js/rankOrderView",["hbs!../templates/rankOrderTemplate","./rankOrderRowView","./rankOrderAnswerView","./rankOrderImages","event!enableDirty","jQueryFramework"],function(e,t,n,r,i,s){function o(o){function c(){function r(){if(l)return;s.each(a,function(e,t){t.saveState()}),l=!0}function c(){if(!l)return;s.each(a,function(e,t){t.restoreState()}),s.each(u,function(e,t){o.getAnswer(e)||t.dragging()?t.disable():t.enable()}),l=!1}function h(e){var t=s("#"+o.id+" .questionErrorMsg");return t&&t.toggle(!e),e}var p=[],d=[],v="rankOrder"+Date.now();return o.onValidate(h),f=s(e({Id:v,HasImages:o.hasImages(),ImageOnly:o.hasImages()&&!o.hasText()})),s.each(o.getRows(),function(e,n){var r=t.create(o,{Value:o.getAnswer(n.ObjectId),Row:n,ContainerId:v});u[n.ObjectId]=r;var s=r.createView(v);s.on("change",function(e,t,r){r&&a[r].setAnswer(n),i.publish()}),p.push(s)}),s.each(o.getRanks(),function(e,t){var s=n.create(o,{Index:e+1,IsLast:e===o.getRanks().length-1,Row:o.getRowByAnswerId(t.ObjectId),Answer:t,ContainerId:v});a[t.ObjectId]=s;var f=s.createView(v);f.on("change",function(e,t,n){n&&(s.setAnswer(o.getRow(t)),i.publish(),l=!1)}).on("clear",function(e,t){u[t].enable(),i.publish()}).on("swap",function(e,t,n){var r=o.getRowByAnswerId(t),i=o.getRowByAnswerId(n),u=a[n];if(!r&&!i)return;s.setAnswer(i),u.setAnswer(r)}).on("replace",function(t,n,i,f){function l(e,t,n){var r=o.getRowByAnswerId(t),i=o.getRow(e);a[t].setAnswer(i);if(r){var s=n(t);s?l(r.ObjectId,s.ObjectId,n):u[r.ObjectId].enable()}}r();var c=!o.getNextEmptyRank();n?s.setAnswer(o.getRow(n)):s.setAnswer(null);if(c){u[i].enable();return}var h=o.getNextEmptyRank(e),p=o.getPreviousEmptyRank(e),d=o.getNextAnswer(f),v=o.getPreviousAnswer(f);v&&a[v.ObjectId].getSavedRowId()===i?l(i,v.ObjectId,o.getPreviousAnswer):!h&&p||!d?l(i,v.ObjectId,o.getPreviousAnswer):l(i,d.ObjectId,o.getNextAnswer)}).on("restore",function(e){c()}).on("row.dragstart",function(e,t){u[t].dragging(!0)}).on("row.dragstop",function(e,t){u[t].dragging(!1)}),d.push(f)}),f.children(".row-container").append(p),f.children(".answer-container").append(d),f}function h(){function e(){var e=0;f.find(".rank-row").each(function(t,n){s(n).css({"float":"left"}),e=Math.max(e,s(n).height())}),f.find(".rank-row").height(e)}r.preload(o),s.each(u,function(e,t){t.addedToPage()}),s.each(a,function(e,t){t.addedToPage()}),f.find(".row-container").width()<f.find(".rank-row").width()*2&&e()}var u={},a={},f=null,l=!1;return{createView:c,addedToPage:h}}return{create:o}}),define("pluginsShared/RankOrder/js/rankOrderModel",["data","jQueryFramework"],function(e,t){function n(n){function a(e,t){s[e]=t,x()}function f(e){delete s[e],x()}function l(e){return s[e]}function c(){return r.AnswerCollection.slice(0,r.WorkflowStepCollection.length)}function h(){return r.WorkflowStepCollection}function p(e){var n=null,r=c();return t.each(r,function(t,i){if(i.ObjectId===e)return n=t>0?r[t-1]:null,!1}),n}function d(e){var n=null,r=c();return t.each(r,function(t,i){if(i.ObjectId===e)return n=t<r.length-1?r[t+1]:null,!1}),n}function v(e){if(!e)return null;var n=null;return t.each(h(),function(t,r){if(r.ObjectId===e)return n=r,!1}),n}function m(e){var n=null;return t.each(s,function(t,r){if(e===r)return n=v(t),!1}),n}function g(e){var n=null;return t.each(c(),function(r,i){if(!!e&&e>=r)return!0;var o=!0;t.each(s,function(e,t){if(t===i.ObjectId)return o=!1,!1});if(o)return n=i.ObjectId,!1}),n}function y(e){if(e===0)return null;var t=c();for(var n=e?e-1:t.length-1;n>=0;n--){var r=!0;for(var i in s)if(s[i]===t[n].ObjectId){r=!1;break}if(r)return t[n].ObjectId}return null}function b(){var e=0;return t.each(c(),function(n,r){t.each(s,function(t,n){if(n===r.ObjectId)return e++,!1})}),e}function w(){return r.ItemsToRank?Math.min(r.ItemsToRank,h().length):h().length}function E(){return r.MustRankAllItems}function S(e){return n.getLocalizedString(e)}function x(){t.each(h(),function(n,r){t.each(c(),function(t,n){var i=e.selectedByAnswerIdStepId(n.ObjectId,r.ObjectId);i.val(s[r.ObjectId]===n.ObjectId)})})}function T(e){var t=b(),n=t>=w()||t===0&&!E();return!e&&i&&typeof i=="function"&&(n=i(n)),n}var r=n.questionDefinition,i=null,s={},o=!1,u=!1;return function(){t.each(h(),function(n,r){r.CustomRowProperties&&r.CustomRowProperties.VcSharedImage&&r.CustomRowProperties.VcSharedImage.AssetUrl&&(o=!0),r.CustomRowProperties&&r.CustomRowProperties.VcSharedDisplayText!=="false"&&r.Html&&(u=!0),t.each(c(),function(t,n){var i=e.selectedByAnswerIdStepId(n.ObjectId,r.ObjectId);i.val()==="true"&&(s[r.ObjectId]=n.ObjectId)})})}(),{id:r.ObjectId,setAnswer:a,unsetAnswer:f,getRanks:c,getRows:h,getRow:v,getRowByAnswerId:m,getAnswer:l,getNextAnswer:d,getPreviousAnswer:p,itemsToRank:w,isRequired:E,getNextEmptyRank:g,getPreviousEmptyRank:y,getRankedCount:b,getString:S,hasImages:function(){return o},hasText:function(){return u},isComplete:T,onValidate:function(e){i=e}}}return{create:n}}),define("pluginsShared/RankOrder/Desktop/js/rankOrder",["./rankOrderView","pluginsShared/RankOrder/js/rankOrderModel"],function(e,t){function n(n){var r=t.create(n),i=e.create(r);return{createView:i.createView,addedToPage:i.addedToPage,isComplete:r.isComplete}}return{create:n}}),define("plugins/ExtendedQuestions/RankOrderPlugin/Scripts/main",["pluginsShared/RankOrder/Desktop/js/rankOrder"],function(e){var t=function(e){return e.RespondingPlugin==="RankOrderPlugin"},n=function(t){var n=t.questionDefinition,r=e.create(t);return{isComplete:r.isComplete,createView:r.createView,addedToPage:r.addedToPage,getObjectId:function(){return n.ObjectId}}};return{shouldHandleQuestion:t,create:n}}),define("plugins/ExtendedQuestions/AllocationPlugin/Scripts/main",["utils","data","constants","event!enableDirty","jQueryFramework","localization"],function(e,t,n,r,i,s){var o=function(e){return e.RespondingPlugin==="AllocationPlugin"},u=function(e,t,n,r){return{id:e,label:r,slider:t,textArea:n,leftOffset:0,maxWidth:t.width(),rangeWidth:function(){return t.find(".ui-slider-range").width()},startWidth:0}},a=function(t){var r={},o=[],a=function(){var e=i("#"+t.ObjectId),s=e.find(".vc_slider");for(var a=0;a<s.length;a++){var f=s[a],l=i("#"+n.TextAreaPrefix+f.id),c=i("#vc_al_"+f.id).text();r[f.id]=u(f.id,i(f),i(l),c),o.push(f.id)}},f=function(){var t=0;return i.each(o,function(){var n=s.parseFloat(r[this].textArea.val());t=e.add(t,n)}),t},l=function(){a();var e=!0,n=i("#"+t.ObjectId+" .questionErrorMsg"),r=f();return e&&t.MustUseFullAmount==1&&(e=t.AmountToAllocate==r),n.toggle(!e),e};return{getNextEnabled:l}},f=function(o,a,f){var l={},c=[],h=function(e){var t=f.getLocalizedString("AccessibilitySliderHandle"),n=f.getLocalizedString("AccessibilitySliderSkip");i(e).slider({range:"min",max:o.AmountToAllocate,step:1,value:0}),i(e).find(".ui-slider-handle").attr("id","h_"+e.id).attr("title",e.offsetParent.textContent+" "+t).attr("aria-label",n).addClass("handleAll handleBlue"),i(e).find(".ui-slider-range").addClass("sliderBlue"),i(e).draggable()},p=function(e){var t=i("#"+a.TextAreaPrefix+e);return i(t).focus(function(){this.select()}),t.val(0),t},d=function(){var t=i("#"+o.ObjectId),n=t.find(".vc_slider"),r=t.find(".allocationLegendMiddle"),s=t.find(".allocationLegendRight");r.text(e.localizeNumber(o.AmountToAllocate/2)),s.text(e.localizeNumber(o.AmountToAllocate));for(var a=0;a<n.length;a++){var f=n[a];i(f).droppable(),h(f);var d=p(f.id),v=i("#vc_al_"+f.id).text();l[f.id]=u(f.id,i(f),i(d),v),c.push(f.id)}},v=function(t,n){var r=i(this)[0].id,u=e.localizeNumber(n.value);l[r].textArea.val(u);var f=B(),c=e.sub(f,o.AmountToAllocate);if(c>=0){var h=i("#"+o.ObjectId),p=h.find(".vc_slider"),d=0;for(var v=0;v<p.length;v++){var m=p[v];if(r!=m.id){var g=i("#"+a.TextAreaPrefix+m.id);d=e.add(d,s.parseFloat(g.val()))}}u=e.localizeNumber(e.sub(o.AmountToAllocate,d)),l[r].textArea.val(u)}},m=function(e,t){var n=i(this)[0].id;T(n),H()},g=function(e){var t=l[e],n=t.rangeWidth();t.startWidth=n},y=function(e,t){var n=i(this)[0].id;g(n)},b=function(){i.each(c,function(){l[this].slider.bind("slide",v).bind("slidestop",m).bind("slidestart",y),l[this].textArea.bind("keyup",D),l[this].textArea.bind("change",_)})},w=function(e,t){l[e].textArea.val(t);var n=l[e].slider;q(n,s.parseFloat(t))},E=function(){for(var e=0;e<o.WorkflowStepCollection.length;e++){var n=o.WorkflowStepCollection[e].ObjectId,r=o.AnswerAmount.ObjectId,i=t.selectedByAnswerIdStepId(r,n);if(i.val()=="true"){var s=t.inputByAnswerIdStepId(r,n);if(s){var u=s.val();w(n,u)}}}},S=function(){var t=0;return i.each(c,function(){l[this].slider.unbind("slide",v).unbind("slidestop",m).unbind("slidestart",y),l[this].textArea.unbind("keyup",D),l[this].textArea.unbind("change",_);var n=l[this].textArea.val(),r=s.parseFloat(n);isNaN(r)||(t=e.add(t,r))}),t},x=function(){var e=0,t=0;i.each(c,function(){var n=l[this].textArea.val(),r=s.parseFloat(n);isNaN(r)||(e+=r),t+=l[this].rangeWidth()});var n=0;i.each(c,function(){var r=l[this],i=I(r.slider),s=r.rangeWidth();A(r,e),O(r,n),M(r,t-s-n),q(r.slider,i),n+=s})},T=function(e){var t=S(),n=!0,r=l[e],s=r.leftOffset,o=s+r.rangeWidth(),u=r.rangeWidth()-r.startWidth;i.each(c,function(){var i=l[this],a=I(i.slider),f=i.leftOffset,c=i.rangeWidth();if(this!=e){var h=N();A(i,t);var p=f;a==0&&(p=h),a>0&&s<=f&&(f<=o||o<=f)&&(p=f+u),O(i,p);var d=C(i,c,h);d=Math.max(0,d),a==0&&p>0&&M(i,d),a>0&&M(i,d),q(i.slider,a);var v=N();v>0&&v>r.maxWidth&&(n=!1)}}),n||k(),L(),b()},N=function(){var t=0,n=0;return i.each(c,function(){var e=this;n=l[e].maxWidth,t+=l[e].rangeWidth()}),t-n>1&&e.log("i am over the range by :"+(t-n)),Math.min(t,n)},C=function(e,t,n){var r=e.leftOffset+t,i=n-r;return i},k=function(){i.each(c,function(){var e=l[this];O(e,0),M(e,0)})},L=function(){var e=B(),t=o.AmountToAllocate;e==0&&k(),e==t&&i.each(c,function(){var e=l[this],t=s.parseFloat(e.textArea.val());t==0&&(O(e,e.maxWidth),M(e,0))})},A=function(e,t){var n=e.slider,r=I(n),i=Math.max(o.AmountToAllocate-t+r,r);n.slider("option","max",i)},O=function(e,t){var n=e.slider,r=e.maxWidth;t=Math.min(t,r),n.css("margin-left",t),e.leftOffset=t},M=function(e,t){var n=e.slider;n.css("margin-right",t)},_=function(t){var n=s.parseFloat(i(this).val());isNaN(n)||(i(this).val(e.localizeNumber(n)),j())},D=function(t){if(e.isSpecialKeyCode(t))return;var n=i(this)[0].id.replace(a.TextAreaPrefix,""),r=l[n].slider,o=I(r),u=i(this).val();u==""&&(u="0",i(this).val(u),i(this).select());var f=s.parseFloat(u);if(isNaN(f)||!P()||f<0){i(this).val(e.localizeNumber(o)),i(this).select();return}if(o==f)return;g(n),q(r,f),T(n),H()},P=function(){var e=B();return e<=o.AmountToAllocate?!0:!1},H=function(){var e=B();F(e),j(),r.publish()},B=function(){var t=0;return i.each(c,function(){var n=s.parseFloat(l[this].textArea.val());t=e.add(t,n)}),t},j=function(){for(var e=0;e<o.WorkflowStepCollection.length;e++){var r=o.WorkflowStepCollection[e].ObjectId,s=o.AnswerAmount.ObjectId,u=t.inputByAnswerIdStepId(s,r);if(u){var a=i("#"+n.TextAreaPrefix+r).val();u.val(a);if(a.length!=0){var f=t.selectedByAnswerIdStepId(s,r);f.val(!0)}}}},F=function(t){var n=o.AmountToAllocate,r=a.AllocationAmountMessageLabel.replace("{0}",e.localizeNumber(t));r=r.replace("{1}",e.localizeNumber(n)),o.UnitOfMeasurePosition==a.UnitOfMeasureBeforePosition&&(r=r.replace("{2}",o.UnitOfMeasure),r=r.replace("{3}","")),o.UnitOfMeasurePosition==a.UnitOfMeasureAfterPosition&&(r=r.replace("{3}",o.UnitOfMeasure),r=r.replace("{2}",""));var s=i("#"+a.TextAreaMessagePrefix+o.ObjectId);s.text(r);var u=i("#"+a.TextAreaPrefix+o.ObjectId+".allocationAmountMessage");u.text(r)},I=function(e){return parseFloat(e.slider("option","value"))},q=function(e,t){e.slider("option","value",t)},R=function(){d(),E(),x(),H(),b()};return{hookUpControl:R}},l=function(e,t){var r=f(e,n,t);r.hookUpControl()},c=function(e){return a(e).getNextEnabled()},h=function(e){var t=e.questionDefinition,r=function(){var e=i("<div/>").addClass("allocationTemplate answer-font-family answer-font-color"),r=t.WorkflowStepCollection.length,s=t.ObjectId,o=t.AmountToAllocate,u=o/2,a=i("<div/>").addClass("allocationLegendTop fltleft"),f=i("<div/>").addClass("allocationLegendBottom fltleft"),l=i("<div/>").addClass("allocationLegendLeft").text("0"),c=i("<div/>").addClass("allocationLegendMiddle").text(u),h=i("<div/>").addClass("allocationLegendRight").text(o),p=i("<div/>").addClass("allocationLegendLeft").text("0"),d=i("<div/>").addClass("allocationLegendMiddle").text(u),v=i("<div/>").addClass("allocationLegendRight").text(o);a.append(l),a.append(c),a.append(h),f.append(p),f.append(d),f.append(v);var m=i("<div/>").addClass("allocationContainer fltleft");for(var g=0;g<r;g++){var y=t.WorkflowStepCollection[g].ObjectId,b=t.WorkflowStepCollection[g].Html,w=i("<div/>").addClass("allocationViewModel fltleft"),E=i("<div/>").addClass("allocationSliderBgDiv").html("&nbsp;"),S=i("<div/>").attr("id","vc_al_"+y).addClass("allocationHtmlDiv allocationAllDiv answer-font-family answer-font-color").append(b),x=i("<div/>").attr("id","vc_as_"+y).addClass("allocationSliderDiv allocationAllDiv"),T=i("<div/>").addClass("allocationUnitDiv allocationUnitLeftDiv allocationAllDiv").text(t.UnitOfMeasure),N=i("<div/>").addClass("allocationUnitDiv allocationUnitRightDiv allocationAllDiv").text(t.UnitOfMeasure),C=i("<div/>").addClass("allocationTextAreaDiv allocationAllDiv").append(i("<input>").attr("type","text").attr("name",n.TextAreaPrefix+y).attr("id",n.TextAreaPrefix+y).attr("title",b).addClass("allocationTextArea"));x.append(i("<div/>").attr("id",y).addClass("vc_slider")),x.append(E),t.UnitOfMeasurePosition===0?(w.append(S),w.append(x),w.append(T),w.append(C)):(w.append(S),w.append(x),w.append(C),w.append(N)),m.append(w)}var k=i("<div/>").addClass("allocationAmountMessage").attr("name",n.TextAreaPrefix+s).attr("id",n.TextAreaPrefix+s);return e.append(a),e.append(m),e.append(f),e.append(k),e};return{isComplete:function(){return c(t)},createView:r,addedToPage:function(){l(t,e)},getObjectId:function(){return t.ObjectId}}};return{shouldHandleQuestion:o,create:h}}),define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){if(e.indexOf("/EQF/")!==-1)return!0;var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!plugins/ExtendedQuestions/NumericSliderPlugin/Scripts/numericSlider.html!strip",[],function(){return'<div class="ns_numeric_slider">\r\n  <div class="ns_slider_outer">\r\n    <div class="ns_slider_middle">\r\n     <div class="ns_thumb_wrapper">\r\n      <div class="ns_thumb_home">\r\n        <div class="ns_thumb"></div>\r\n      </div>\r\n     </div>\r\n     <div class="ns_slider_inner">\r\n        <div class="ns_slider"></div>\r\n        <div class="ns_ticks answer-font-family answer-font-color"></div>\r\n     </div>\r\n    </div>\r\n    <div class="ns_value_wrapper">\r\n      <input class="ns_value" type="text" size="3">\r\n    </div>\r\n    <div class="ns_error"></div>\r\n  </div>\r\n</div>\r\n'}),define("plugins/ExtendedQuestions/NumericSliderPlugin/Scripts/numericSlider",["jQueryFramework","text!./numericSlider.html!strip","localization"],function(e,t,n){function i(){var e=n.parseFloat(this.value);!isNaN(e)&&f.call(this,e)&&(this.silent=!0,this.$editable.val(n.formatFloat(e,this.decimalPlaces)),this.value=null,this.$element.trigger("slidechange",{value:e}),this.silent=!1)}function s(){var e=(window.outerWidth-8)/window.innerWidth;this.isZoomed=e<=.92||e>1.09}function o(e){return e/this.zoomFactor}function u(){this.hasError=!0;var e=this.pluginHost.getLocalizedString("NotInRange")||"That value is not in range";this.$error.html(e).show()}function a(){this.hasError=!1,this.$error.hide()}function f(e){return e>=this.minValue&&e<=this.maxValue}function l(e){this.silent||(this.value=e,this.$element.trigger("numericSlider:changing")),a.call(this),this.silent=!1}function c(n){var r=this,i=n,s=e(t);this.isOver=!1;var o=0;s.find(".ns_thumb").on("focus",function(e,t){s.find(".ns_thumb").css({outline:"2px solid #a2c4fb"})}),s.find(".ns_thumb").draggable({axis:"x",revert:function(){return r.slidedValue===r.value?!1:(r.slidedValue===null?r.$home.trigger("click"):r.$element.trigger("slidechange",{ui:s.find(".ui-slider-handle"),value:r.slidedValue}),!1)},containment:"#"+r.question.ObjectId+" .ns_slider_middle",drag:function(e,t){var n=r.$slider.offset().left;r.lastPos=e.originalEvent.pageX,r.isZoomed&&(t.position.left=r.lastPos-n+50);var i=r.$thumb.width()/2;if((r.isOver||e.originalEvent.pageX-i<r.$slider.offset().left+r.$slider.width())&&e.originalEvent.pageX>r.$slider.offset().left){r.$slider.data("uiSlider").elementSize={width:r.$slider.width(),height:r.$slider.height()},r.$slider.data("uiSlider").elementOffset=r.$slider.offset();var o=r.$slider.data("uiSlider")._normValueFromMouse({x:e.originalEvent.pageX,y:e.originalEvent.pageY});r.slidedValue=o,r.$element.trigger("slide",{ui:s.find(".ui-slider-handle"),value:o})}else r.slidedValue=e.originalEvent.pageX<r.$slider.offset().left?r.minValue:r.maxValue,r.value=null,r.$editable.val(r.slidedValue)}}),s.find(".ns_slider").slider({animate:"fast",min:r.minValue,max:r.maxValue,step:Math.pow(10,r.decimalPlaces*-1)}),s.find(".ui-slider-handle").fadeTo(0,0),h.call(r,s),s.find(".ns_slider").on("mousedown",function(t,n){s.find(".ns_slider_middle").on("mouseover",function(t,n){var i=r.$slider.offset().left;r.$thumb.css("left",t.pageX-i+45),e(this).on("mousemove",function(e,t){r.$thumb.css("left",e.pageX-i+45)})})}),e(document).mouseup(function(e,t){s.find(".ns_slider_middle").off(),s.find(".ns_slider").off("mousemove")}),s.find(".ns_slider_inner").droppable({accept:".ns_thumb",tolerance:"touch",over:function(e,t){r.isOver=!0},out:function(e,t){r.isOver=!1},drop:function(e,t){r.slidedValue===null?r.$home.trigger("click"):r.$element.trigger("slidechange",{ui:s.find(".ui-slider-handle"),value:r.slidedValue})}});var u=i.getLocalizedString("AccessibilitySliderHandle"),a=i.getLocalizedString("AccessibilitySliderSkip");s.find("a").each(function(){e(this).attr("tabindex","0").attr("title",u).attr("aria-label",a)}),s.find("a").focus(function(){s.find(".ns_thumb").css("outline","2px solid #a2c4fb")}),s.find("a").focusout(function(){s.find(".ns_thumb").css("outline","none")}),this.$element.html(s)}function h(t){var n=this,r=[];switch(n.tickOption){case"None":return;case"EndAndMidPoints":r=[n.minValue,(n.minValue+n.maxValue)/2,n.maxValue];break;default:r=[n.minValue,n.maxValue]}var i=Math.round(100/(r.length-1)*10)/10,s="";e.each(r,function(e,t){s+='<span style="left: '+e*i+'%">'+"<ins>"+t+"</ins></span>"}),t.find(".ns_ticks").html(s).find("span").filter(":first, :last").addClass("ns_end_tick").end().filter(":last").addClass("ns_last_tick").end().filter(":odd").addClass("ns_odd_tick")}function p(t,n){var r=this,i=null,s=0,u=0;if(n){var a=r.$sliderContainer.find(".ns_ticks span ins").filter(function(){return e(this).text()===t.toString()}).parent();if(a.length>0){i=a.position(),s=o.call(r,i.top)+14,u=(t===r.maxValue?-1:0)+45;if(!this.isZoomed)u+=o.call(r,i.left);else{var f=(t-r.minValue)/(r.maxValue-r.minValue)*100;u+=r.$slider.outerWidth()*f/100}}else{var f=(t-r.minValue)/(r.maxValue-r.minValue)*100;u+=r.$slider.outerWidth()*f/100+45,i={top:0,left:u}}}else i=t,s=0,u=0;r.$thumb.css("position","relative").css("top",s),this.isZoomed?this.$thumb.css({left:u}):this.$thumb.animate({left:u},"fast")}var r={name:"numericSlider",value:null,init:function(t){var r=this;this.silent=!1,this.slidedValue=null,this.pluginHost=t,this.question=t.questionDefinition,this.minValue=Number(this.question.CustomQuestionProperties.Minimum),this.maxValue=Number(this.question.CustomQuestionProperties.Maximum),this.decimalPlaces=Number(this.question.CustomQuestionProperties.DecimalPlaces),this.tickOption=this.question.CustomQuestionProperties.ScaleValues;var i="<div></div>";return this.$element=e(i),c.call(this,t),this.$home=this.$element.find(".ns_thumb_home"),this.$thumb=this.$home.find(".ns_thumb"),this.$sliderContainer=this.$element.find(".ns_slider_outer"),this.$slider=this.$element.find(".ns_slider"),this.$handle=this.$slider.find(".ui-slider-handle"),this.$editable=this.$element.find(".ns_value"),this.$editable.attr("title",t.getLocalizedString("AccessibilityInput")),this.$error=this.$element.find(".ns_error"),this.hasError=!1,this.isZoomed=!1,this.zoomFactor=1,s.call(this),e(window).resize(function(){s.call(r)}),this.$thumb.on("click",function(e){e.stopPropagation()}),this.$home.on("click",function(){r.$editable.val(""),a.call(r),r.$thumb.unbind("mousemove"),r.$element.trigger("numericSlider:home")}),this.$element.on("numericSlider:home",function(t){r.value!==null&&p.call(r,e(this).position(),!1),r.value=null,e(t.target).trigger("numericSlider:changed")}),this.$element.on("slidechange",function(e,t){var i=t.value<r.maxValue?t.value:r.maxValue;p.call(r,i,!0),r.value!==i&&r.$editable.val(n.formatFloat(i,r.decimalPlaces)),r.value=i,r.$slider.trigger("numericSlider:changed")}),this.$element.on("slide",function(e,t){l.call(r,t.value)}),this.$element.on("numericSlider:changing",function(){r.$editable.val(n.formatFloat(r.value,r.decimalPlaces))}),this.$editable.on("keyup",function(t){if(t.keyCode===37||t.keyCode===39)return;var i=e(this).val(),s=n.parseFloat(i);!isNaN(s)&&f.call(r,s)?(a.call(r),r.silent=!0,r.value=s,r.$slider.slider("option","value",s)):i===""?(a.call(r),r.$element.trigger("numericSlider:home")):isNaN(s)?(u.call(r),r.$element.trigger("numericSlider:home")):r.value&&!f.call(r,s)?(u.call(r),r.$element.trigger("numericSlider:home")):window.setTimeout(function(){i=r.$editable.val(),s=n.parseFloat(i),i!==""&&(isNaN(s)||!f.call(r,s))&&(u.call(r),r.$element.trigger("numericSlider:home"))},800)}),this},ui:function(){return this.$element},setAnswer:function(e){this.value=e,this.callback=i},getLocalizedValue:function(){return n.formatFloat(this.value,this.decimalPlaces)},addedToPage:function(){if(this.callback){var e=this;setTimeout(function(){e.callback.call(e)},200)}}};return function(){return e.extend({},r)}}),define("plugins/ExtendedQuestions/NumericSliderPlugin/Scripts/main",["jQueryFramework","./numericSlider"],function(e,t){var n=function(e){return e.RespondingPlugin==="NumericSliderPlugin"},r=function(n){var r=new t,i=function(){return n.questionDefinition.Required?r.value!==null&&r.value!==undefined:!r.hasError},s=function(){var t=function(e){n.dataStore.setOpenEndText(r.getLocalizedValue()),n.completionStatusChanged(),e.stopPropagation()},i="#"+n.questionDefinition.ObjectId;e(i).bind("numericSlider:changing",t),e(i).bind("numericSlider:changed",t);var s=function(){var e=n.dataStore.getOpenEndText();e&&(r.setAnswer(e),n.dataStore.setOpenEndText(r.getLocalizedValue()))};return r.init(n),s(),r.ui()},o=function(){r.addedToPage()};return{isComplete:i,createView:s,addedToPage:o,getObjectId:function(){return n.questionDefinition.ObjectId}}};return{create:r,shouldHandleQuestion:n}}),define("text!plugins/ExtendedQuestions/ScaleSliderPlugin/Scripts/scaleSlider.html!strip",[],function(){return'<div class="ss_scale_slider">\r\n            <table class="ss_grid_container" dir="ltr">\r\n              <thead>\r\n                <tr class="ss_grid_header">\r\n                  <th class="ss_header_label"></th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr class="ss_row_slider">\r\n                  <td class="ss_slider_thumb">\r\n                    <div class="ss_thumb_offscale ss_thumb_home">\r\n                      <div class="ss_thumb"></div>\r\n                    </div>\r\n                  </td>\r\n                  <td class="ss_slider_inner">\r\n                    <div class="ss_slider"></div>\r\n                    <div class="ss_scales ss_ticks ss_scale_values"></div>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        '}),define("plugins/ExtendedQuestions/ScaleSliderPlugin/Scripts/scaleSlider",["jQueryFramework","text!./scaleSlider.html!strip","viewUtils","constants"],function(e,t,n,r){function s(){var e=(window.outerWidth-8)/window.innerWidth;this.isZoomed=e<=.92||e>1.09}function o(e){return e/this.zoomFactor}function u(){var t=this.$element.find("[data-object-id='"+this.value+"']");e(t).trigger("click")}function a(){var t=this;e.each(this.onScaleValues,function(e,n){if(n===t.value)return t.value=null,t.$slider.trigger("slidechange",{value:e+1}),!1})}function f(n){var r=this,i=e(t),s=i.find(".ss_thumb").parents(".ss_row_slider").first();i.find(".ss_thumb").draggable({axis:"x",containment:s,drag:function(e,t){var n=r.$slider.offset().left,i=50;r.lastPos=e.originalEvent.pageX,r.isZoomed&&(t.position.left=r.lastPos-n+i);var s=r.$slider.width()*r.zoomFactor;if(r.isOver){var o=r.maxValue-1,u=s/o,a=r.lastPos-n;r.slidedValue=Math.round((a+u)/u)}else r.slidedValue=null}}),h.call(this,i);var o=n.getLocalizedString("AccessibilitySliderTableSummary");i.find(".ss_grid_container").addClass("ss_with_offscale_"+r.offScaleValues.length).attr("summary",o),i.find(".ss_slider").slider({animate:"fast",min:r.minValue,max:r.maxValue,step:1}).attr("data-object-id",r.question.ObjectId),i.find(".ui-slider-handle").fadeTo(0,0),i.find(".ss_slider_thumb, .ss_offscale").droppable({accept:".ss_thumb",drop:function(t,n){var r=e(this).find(".ss_thumb_offscale");r.trigger("offScale:changed",r.data("object-id"))}}),i.find(".ss_slider_inner").droppable({accept:".ss_thumb",tolerance:"intersect",over:function(e,t){r.isOver=!0},out:function(e,t){r.isOver=!1},drop:function(e,t){r.slidedValue===null?r.$home.trigger("click"):r.$slider.trigger("slidechange",{value:r.slidedValue})}});var u=n.getLocalizedString("AccessibilitySliderHandle");i.find("a").each(function(){e(this).attr("tabindex","0"),e(this).hasClass("ui-slider-handle")&&e(this).attr("title",u)}),i.find("a").focus(function(){i.find(".ss_thumb").css("outline","2px solid #a2c4fb")}),i.find("a").focusout(function(){i.find(".ss_thumb").css("outline","none")}),this.$element.html(i)}function l(e,t){var n=this,r=null,i=0,s=0,u=n.$sliderContainer.find("td.ss_slider_thumb").width()-14;if(t){var a=n.$sliderContainer.find(".ss_scales.ss_ticks span:nth-child("+e+")");r=a.position(),i=o.call(n,r.top)+14,s=(e===n.maxValue?-1:0)+u;if(!this.isZoomed)s+=o.call(n,r.left);else{var f=a.attr("style").match(/left: ([0-9]+.*[0-9]*)%/)[1]/100;s+=n.$sliderContainer.find(".ss_scales.ss_ticks.ss_scale_values").outerWidth()*f}}else{r=e,i=0;var l=n.$sliderContainer.offset();s=o.call(n,r.left)-parseInt(n.$thumb.parents(".ss_slider_thumb").css("padding-left"),10)-o.call(n,l.left)}n.$thumb.css("position","relative").css("top",i),this.isZoomed?this.$thumb.css({left:s}):this.$thumb.animate({left:s},"fast")}function c(e){return e>=2}function h(t){var n=this,r=n.question.AnswerCollection,i=[],s="",o="",u=0;for(var a=0,f=r.length;a<f;a++)(r[a].CustomAnswerProperties.OffScale==="false"||r[a].CustomAnswerProperties.OffScale===undefined)&&u++;e.each(r,function(e,t){if(t.CustomAnswerProperties.OffScale!=="false"&&t.CustomAnswerProperties.OffScale!==undefined||!c(u)){var r=t.Html||"";n.offScaleValues.push(t.ObjectId),s+='<th class="ss_header_label ss_label_off_scale answer-font-family answer-font-color" data-value="'+t.ObjectId+'">'+r+"</th>",o+='<td class="ss_offscale"><div data-object-id="'+t.ObjectId+'" class="ss_thumb_offscale"/></div></td>'}else n.onScaleValues.push(t.ObjectId),i.push(t)}),this.minValue=1,this.maxValue=i.length;var l="",h="",p=5,d=3;i.length===5&&i[1].Html===""&&i[3].Html===""&&(p=3);var v=this.maxValue>p?d:this.maxValue,m=n.maxValue%2!==0?Math.ceil(n.maxValue/2):null;if(c(u)){var g=Math.round(100/(i.length-1)*1e3)/1e3;e.each(i,function(e,t){var r;if(n.maxValue<=p||e===0||e+1===n.maxValue||e+1===m)r=t.Html||"";if(typeof r!="undefined"||!m&&e===d)r=r||"",h+='<th class="ss_header_label ss_label_on_scale ss_label_'+v+' answer-font-family answer-font-color"  data-value="'+(e+1)+'">'+r+"</th>";var i=n.showTickLabels?e+1:"";l+='<span class="answer-font-family answer-font-color" style="left: '+e*g+'%">'+"<ins>"+i+"</ins></span>"}),t.find(".ss_slider_inner").attr("colspan",v)}else t.find(".ss_slider_inner").css("display","none");t.find(".ss_grid_header").append(h).find("th.ss_label_on_scale").filter(":first").addClass("ss_first_label").end().filter(":last").addClass("ss_last_label").end(),t.find(".ss_ticks").html(l).find("span").filter(":first, :last").addClass("ss_end_tick").end().filter(":last").addClass("ss_last_tick").end().filter(":odd").addClass("ss_odd_tick"),m&&t.find(".ss_ticks").find("span").filter(":nth-child("+m+")").addClass("ss_mid_tick"),t.find(".ss_grid_header").append(s),t.find(".ss_row_slider").append(o)}var i={name:"scaleSlider",value:null,init:function(t){var r=this;this.onScaleValues=[],this.offScaleValues=[],this.scalePosition,this.pluginHost=t,this.question=t.questionDefinition,this.showTickLabels=this.question.CustomQuestionProperties.ShowScaleValues==="true"?!0:!1;var i="<div></div>";this.$element=e(i),f.call(this,t),this.$home=this.$element.find(".ss_thumb_home"),this.$homePos=this.$home.position(),this.$offScale=this.$element.find(".ss_thumb_offscale"),this.$offScaleContainers=this.$element.find(".ss_offscale"),this.$thumb=this.$home.find(".ss_thumb"),this.$slider=this.$element.find(".ss_slider"),this.$sliderContainer=this.$element.find(".ss_row_slider"),this.$handle=this.$slider.find(".ui-slider-handle"),this.isZoomed=!1,this.zoomFactor=1,s.call(this),e(window).resize(function(){s.call(r)});var o=e('<span class="accessibleLabel visually-hidden">'+t.getLocalizedString("AccessibilitySliderSetLabel")+"</span>");o.css("position","absolute");var u=e('<span class="accessibleValue visually-hidden"></span>');return u.css("position","absolute"),this.$handle.append(o),this.$handle.append(u),this.$handle.css("position","relative"),this.$thumb.on("click",function(e){e.stopPropagation()}),this.$offScale.on("click",function(i){var s=e(i.target).data("object-id");e(this).trigger("offScale:changed",s);for(var o=0;o<r.question.AnswerCollection.length;o++)if(s==r.question.AnswerCollection[o].ObjectId)var u=n.stripHtml(r.question.AnswerCollection[o].Html);r.$slider.find(".accessibleLabel").text(t.getLocalizedString("AccessibilitySliderSetOffscaleLabel")),r.$slider.find(".accessibleValue").text(u)}),this.$offScale.on("offScale:changed",function(t,n){l.call(r,e(this).offset(),!1),r.value=n,e(t.target).trigger("scaleSlider:changed")}),this.$element.on("slidechange",function(i,s){function c(){o=s.value<r.onScaleValues.length?s.value:r.maxValue,u=r.onScaleValues[o-1],l.call(r,o,!0),r.value=u,r.$slider.trigger("scaleSlider:changed"),h()}function h(){for(var e=0;e<r.question.AnswerCollection.length;e++)if(u==r.question.AnswerCollection[e].ObjectId)var i=n.stripHtml(r.question.AnswerCollection[e].Html);r.$slider.find(".accessibleLabel").text(t.getLocalizedString("AccessibilitySliderSetLabel")),r.$slider.find(".accessibleValue").text(i)}var o,u;if(i.originalEvent&&i.originalEvent.type==="keyup"){var a;switch(i.which){case 37:if(r.value===null||r.value===undefined)return;if(r.value===r.onScaleValues[0]){r.value=null;var f=r.$home;e(f).trigger("click"),h();return}if(r.isSliderSetToOnScale(r.value)&&r.value!==r.onScaleValues[0]&&r.onScaleValues.length>1){r.value=r.getNextOnScaleId("left"),r.$slider.trigger("scaleSlider:changed"),l.call(r,r.scalePosition,!0),h();return}if(r.isSliderSetToOffScale(r.value)&&r.value===r.offScaleValues[0]){r.value=r.onScaleValues[r.onScaleValues.length-1],r.$slider.trigger("scaleSlider:changed"),l.call(r,r.maxValue,!0),h();return}if(r.isSliderSetToOffScale(r.value)&&r.value!=r.offScaleValues[0]){r.value=r.getNextOffScaleId("left"),a=r.$element.find("[data-object-id='"+r.value+"']"),e(a).trigger("click"),h();return}break;case 39:if(r.value===null||r.value===undefined){r.value=r.onScaleValues[0],r.$slider.trigger("scaleSlider:changed"),l.call(r,r.minValue,!0),h();return}if(r.isSliderSetToOnScale(r.value)&&r.onScaleValues.length>1&&r.value!=r.onScaleValues[r.onScaleValues.length-1]){r.value=r.getNextOnScaleId("right"),r.$slider.trigger("scaleSlider:changed"),l.call(r,r.scalePosition,!0),h();return}if(r.value===r.onScaleValues[r.onScaleValues.length-1]&&r.offScaleValues.length!=0){r.value=r.offScaleValues[0],a=r.$element.find("[data-object-id='"+r.value+"']"),e(a).trigger("click"),h();return}if(r.isSliderSetToOffScale(r.value)&&r.value!=r.offScaleValues[r.offScaleValues.length-1]){r.value=r.getNextOffScaleId("right"),a=r.$element.find("[data-object-id='"+r.value+"']"),e(a).trigger("click"),h();return}if(r.isSliderSetToOffScale(r.value)&&r.value==r.offScaleValues[r.offScaleValues.length-1])return}c()}else c()}),this},ui:function(){return this.$element},isSliderSetToOnScale:function(e){var t=!1;for(var n=0;n<this.onScaleValues.length;n++)if(e===this.onScaleValues[n]){t=!0;break}return t},getNextOnScaleId:function(e){var t;switch(e){case"right":for(var n=0;n<this.onScaleValues.length-1;n++)this.value===this.onScaleValues[n]&&(t=this.onScaleValues[n+1],this.scalePosition=n+2);break;case"left":for(var r=1;r<this.onScaleValues.length;r++)this.value===this.onScaleValues[r]&&(t=this.onScaleValues[r-1],this.scalePosition=r)}return t},isSliderSetToOffScale:function(e){var t=!1;for(var n=0;n<this.offScaleValues.length;n++)if(e===this.offScaleValues[n]){t=!0;break}return t},getNextOffScaleId:function(e){var t;switch(e){case"right":for(var n=0;n<this.offScaleValues.length-1;n++)this.value===this.offScaleValues[n]&&(t=this.offScaleValues[n+1]);break;case"left":for(var r=1;r<this.offScaleValues.length;r++)this.value===this.offScaleValues[r]&&(t=this.offScaleValues[r-1])}return t},isAnswerSetToOffscale:function(e){var t=this.question.AnswerCollection,n=0;for(var r=0,i=t.length;r<i;r++)(t[r].CustomAnswerProperties.OffScale==="false"||t[r].CustomAnswerProperties.OffScale===undefined)&&n++;return e.CustomAnswerProperties.OffScale==="true"||n<2},setAnswer:function(e){this.value=e.ObjectId,this.callback=this.isAnswerSetToOffscale(e)?u:a},addedToPage:function(){if(this.callback){var e=this;setTimeout(function(){e.callback.call(e)},200)}}};return function(){return e.extend({},i)}}),define("plugins/ExtendedQuestions/ScaleSliderPlugin/Scripts/main",["jQueryFramework","./scaleSlider"],function(e,t){var n=function(e){return e.RespondingPlugin==="ScaleSliderPlugin"},r=function(n){var r=new t,i=function(){return!n.questionDefinition.Required||r.value?!0:!1},s=function(){var t=function(e){e.Selected=!0,r.setAnswer(e),n.dataStore.setExclusiveAnswer(e.ObjectId)},i=function(e){n.dataStore.setExclusiveAnswer(r.value),n.completionStatusChanged()},s="#"+n.questionDefinition.ObjectId;e(s).bind("scaleSlider:changed",i);var o=function(){e.each(n.questionDefinition.AnswerCollection,function(e,r){var i=n.dataStore.getAnswer(r.ObjectId);i&&t(r)})};return r.init(n),o(),r.ui()},o=function(){r.addedToPage()};return{isComplete:i,createView:s,addedToPage:o,getObjectId:function(){return n.questionDefinition.ObjectId}}};return{create:r,shouldHandleQuestion:n}}),define("text!plugins/ExtendedQuestions/ScaleSliderGridPlugin/Scripts/scaleSliderGrid.html!strip",[],function(){return'<div class="ssg_scale_slider">\r\n            <table class="ssg_grid_container" dir="ltr">\r\n              <tr class="ssg_grid_header">\r\n                <th class="ssg_header_label ssg_empty_thumb"></th>\r\n              </tr>\r\n              <tr class="ssg_row_slider">\r\n                <td class="ssg_slider_thumb">\r\n                  <div class="ssg_thumb_offscale ssg_thumb_home">\r\n                    <div class="ssg_thumb"></div>\r\n                  </div>\r\n                </td>\r\n                <td class="ssg_slider_inner">\r\n                  <div class="ssg_slider"></div>\r\n                  <div class="ssg_scales ssg_ticks ssg_scale_values answer-font-family answer-font-color"></div>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n        '}),define("plugins/ExtendedQuestions/ScaleSliderGridPlugin/Scripts/scaleSliderGrid",["jQueryFramework","text!./scaleSliderGrid.html!strip","viewUtils","constants"],function(e,t,n,r){function s(){var e=(window.outerWidth-8)/window.innerWidth;this.isZoomed=e<=.92||e>1.09}function o(e){return e/this.zoomFactor}function u(e){this.isLocked=e}function a(){return this.values[this.$sliderContainer.data("object-id")]}function f(e){this.value=e,this.values[this.$sliderContainer.data("object-id")]=e;for(var t=0;t<this.question.AnswerCollection.length;t++)if(e==this.question.AnswerCollection[t].ObjectId)var r=n.stripHtml(this.question.AnswerCollection[t].Html);this.$sliderContainer.find(".accessibleLabel").text(this.pluginHost.getLocalizedString("AccessibilitySliderSetLabel")),this.$sliderContainer.find(".accessibleValue").text(r)}function l(t){return e(t).hasClass("ssg_row_slider")?t:e(t).parents(this.selector.sliderContainer).first()}function c(e){var t=this.$element.find(this.selector.sliderContainer+"[data-object-id='"+e+"']");h.call(this,t)}function h(t){if(this.isLocked)return;this.$sliderContainer=e(l.call(this,t)),this.$slider=this.$sliderContainer.find(this.selector.slider),this.$thumb=this.$sliderContainer.find(this.selector.thumb),this.$handle=this.$sliderContainer.find(this.selector.handle),this.value=a.call(this)}function p(t){c.call(this,t.rowId);var n=this.$sliderContainer.find("[data-object-id='"+t.answerId+"']");e(n).trigger("click")}function d(t){var n=this;n.values[t.rowId]=t.answerId,e.each(this.onScaleValues,function(e,r){if(r===t.answerId)return c.call(n,t.rowId),n.value=null,n.$slider.trigger("slidechange",{value:e+1}),!1})}function v(n){var r=this,i=e(t),s=i.find(".ssg_grid_container"),o=e(s);b.call(this,o);var a=o.find(".ssg_grid_header"),f=e(a),c=o.find(".ssg_row_slider"),p=e(c);c.remove();var d=0;e.each(r.question.WorkflowStepCollection,function(t,n){r.question.RepeatHeaderEvery>0&&d!==0&&d%r.question.RepeatHeaderEvery===0&&e(i.find(".ssg_grid_container")).append(e(f).clone()),d++,e(p).attr("data-object-id",n.ObjectId),e(p).find(".ssg_answer").html(n.Html).attr("scope","row");var s=e(p).clone();e(i.find(".ssg_grid_container")).append(s),m.call(r,s)});var v=i.find(".ssg_grid_header");v.first().addClass("ssg_first_header"),v.find("th").attr("scope","col");var g=n.getLocalizedString("AccessibilityGridTableSummary");i.find(".ssg_grid_container").addClass("ssg_with_offscale_"+r.offScaleValues.length).attr("summary",g),i.find(".ssg_slider").slider({animate:"fast",min:r.minValue,max:r.maxValue,step:1,start:function(){h.call(r,this),u.call(r,!0)},stop:function(e,t){u.call(r,!1)}}).attr("data-object-id",r.question.ObjectId),i.find(".ui-slider-handle").fadeTo(0,0),i.find(".ssg_answer, .ssg_slider_thumb, .ssg_offscale").droppable({accept:".ssg_thumb",drop:function(t,n){var i=e(this).find(r.selector.offScale).data("object-id"),s=i!==undefined&&i!==null?r.$sliderContainer.find(r.selector.offScale+'[data-object-id="'+i+'"]'):r.$sliderContainer.find(r.selector.offScale+r.selector.home);s.trigger("offScale:changed"),u.call(r,!1)}}),i.find(".ssg_slider_inner").droppable({accept:".ssg_thumb",tolerance:"intersect",over:function(e,t){r.isOver=!0},out:function(e,t){r.isOver=!1},drop:function(t,n){var i=l.call(r,n.draggable);r.slidedValue===null?e(i).find(r.selector.home).trigger("click"):r.$slider.trigger("slidechange",{value:r.slidedValue,fromDrag:!0}),u.call(r,!1),h.call(r,this)}});var y=n.getLocalizedString("AccessibilitySliderHandle");i.find("a").each(function(){e(this).attr("tabindex","0");if(e(this).hasClass("ui-slider-handle")){e(this).attr("title",y);var t=e('<span class="liveRegion" aria-live="assertive" aria-atomic="true"><span class="accessibleLabel visually-hidden">'+n.getLocalizedString("AccessibilitySliderSetLabel")+'</span><span class="accessibleValue visually-hidden"></span></span>');e(this).append(t)}}),i.find("a").focus(function(){e(this).parent().parent().parent().find(".ssg_thumb").css("outline","2px solid #a2c4fb")}),i.find("a").focusout(function(){e(this).parent().parent().parent().find(".ssg_thumb").css("outline","none")}),this.$element.html(i)}function m(e){var t=this,n=e.find(".ssg_thumb").parents(".ssg_row_slider").first();e.find(".ssg_thumb").draggable({axis:"x",containment:n,start:function(){h.call(t,this),u.call(t,!0)},drag:function(e,n){var r=t.$slider.offset().left;t.lastPos=e.originalEvent.pageX,t.isZoomed&&(n.position.left=t.lastPos-r+50);var i=t.$slider.width()*t.zoomFactor;if(t.isOver){var s=t.maxValue-1,o=i/s,u=t.lastPos-r;t.slidedValue=Math.round((u+o)/o)}else t.slidedValue=null}})}function g(e,t){var n=this,i=null,s=0,u=0;if(t){var a=n.$sliderContainer.find(".ssg_slider_thumb").width(),f=n.$sliderContainer.find(".ssg_scales.ssg_ticks span:nth-child("+e+")");i=f.position(),s=o.call(n,i.top)+14,u=(e===n.maxValue?-1:0)+a+12;if(!this.isZoomed)u+=o.call(n,i.left);else{var l=f.attr("style").match(/left: ([0-9]+.*[0-9]*)%/)[1]/100;u+=n.$sliderContainer.find(".ssg_scales.ssg_ticks.ssg_scale_values").outerWidth()*l}}else{i=e,s=0;var c=n.$sliderContainer.offset();u=o.call(n,i.left)-parseInt(n.$thumb.parents(".ssg_slider_thumb").css("padding-left"),10)-o.call(n,c.left),r.IsRtlContentDirection||(u-=n.$sliderContainer.find("th.ssg_answer").outerWidth())}n.$thumb.css("position","relative").css("top",s),this.isZoomed?this.$thumb.css({left:u}):this.$thumb.animate({left:u},"fast")}function y(e){return e>=2}function b(t){var n=this,i=n.question.AnswerCollection,s=[],o="",u="",a="&nbsp;",f=0;for(var l=0,c=i.length;l<c;l++)(i[l].CustomAnswerProperties.OffScale==="false"||i[l].CustomAnswerProperties.OffScale===undefined)&&f++,i[l].Html===""&&(i[l].Html=a);e.each(i,function(e,t){t.CustomAnswerProperties.OffScale!=="false"&&t.CustomAnswerProperties.OffScale!==undefined||!y(f)?(n.offScaleValues.push(t.ObjectId),o+='<th class="ssg_header_label ssg_label_off_scale answer-font-family answer-font-color" data-value="'+t.ObjectId+'">'+t.Html+"</th>",u+='<td class="ssg_offscale"><div data-object-id="'+t.ObjectId+'" class="ssg_thumb_offscale"/></div></td>'):(n.onScaleValues.push(t.ObjectId),s.push(t))}),this.minValue=1,this.maxValue=s.length;var h="",p="",d=5,v=3,m=this.maxValue>d?v:this.maxValue,g=n.maxValue%2!==0?Math.ceil(n.maxValue/2):null;if(y(f)){var b=Math.round(100/(s.length-1)*10)/10;e.each(s,function(e,t){var r="";if(n.maxValue<=d||e===0||e+1===n.maxValue||e+1===g)r=t.Html;if(r!==""||!g&&e===v)p+='<th class="ssg_header_label ssg_label_on_scale ssg_label_'+m+' answer-font-family answer-font-color"  data-value="'+(e+1)+'">'+r+"</th>";var i=n.showTickLabels?e+1:"";h+='<span style="left: '+e*b+'%">'+"<ins>"+i+"</ins></span>"}),t.find(".ssg_slider_inner").attr("colspan",m)}else t.find(".ssg_slider_inner").css("display","none");var w='<th class="ssg_header_label ssg_empty_answer"></th>',E='<th class="ssg_answer answer-font-family answer-font-color">This is the answer</th>',S=t.find(".ssg_grid_header"),x=t.find(".ssg_row_slider");S.append(p).find("th.ssg_label_on_scale").filter(":first").addClass("ssg_first_label").end().filter(":last").addClass("ssg_last_label").end(),s.length===5&&s[1].Html===a&&s[3].Html===a&&t.find(".ssg_grid_header th.ssg_label_5").addClass("expand"),t.find(".ssg_ticks").html(h).find("span").filter(":first, :last").addClass("ssg_end_tick").end().filter(":last").addClass("ssg_last_tick").end().filter(":odd").addClass("ssg_odd_tick"),g&&t.find(".ssg_ticks").find("span").filter(":nth-child("+g+")").addClass("ssg_mid_tick"),S.append(o),x.append(u),r.IsRtlContentDirection?(S.append(w),x.append(E)):(S.prepend(w),x.prepend(E))}var i={name:"scaleSliderGrid",answeredCount:0,seen:{},init:function(t){var r=this;this.onScaleValues=[],this.offScaleValues=[],this.values=[],this.isLocked=!1,this.callbacks=[],this.pluginHost=t,this.question=t.questionDefinition,this.showTickLabels=this.question.CustomQuestionProperties.ShowScaleValues==="true"?!0:!1;var i="<div></div>";return this.$element=e(i),v.call(this,t),this.selector={sliderContainer:".ssg_row_slider",slider:".ssg_slider",thumb:".ssg_thumb",handle:".ui-slider-handle",offScale:".ssg_thumb_offscale",home:".ssg_thumb_home"},this.$home=this.$element.find(this.selector.home),this.$sliderContainers=this.$element.find(this.selector.sliderContainer),this.$sliders=this.$element.find(this.selector.slider),this.$thumbs=this.$element.find(this.selector.thumb),this.$offScales=this.$element.find(this.selector.offScale),this.$offScaleContainers=this.$element.find(".ssg_offscale"),this.isZoomed=!1,this.zoomFactor=1,s.call(this),e(window).resize(function(){s.call(r)}),this.$sliderContainers.on("mouseover",function(e){h.call(r,this)}),this.$thumbs.on("click",function(e){e.stopPropagation()}),this.$offScales.on("click",function(i){h.call(r,this);var s=e(i.target).data("object-id");e(this).trigger("offScale:changed",s);for(var o=0;o<r.question.AnswerCollection.length;o++)if(s==r.question.AnswerCollection[o].ObjectId)var u=n.stripHtml(r.question.AnswerCollection[o].Html);r.$slider.find(".accessibleLabel").text(t.getLocalizedString("AccessibilitySliderSetOffscaleLabel")),r.$slider.find(".accessibleValue").text(u)}),this.$offScales.on("offScale:changed",function(t,n){g.call(r,e(this).offset(),!1),f.call(r,e(this).data("object-id"));var i="scaleSliderGrid:"+(r.value!==undefined?"answered":"unanswered");r.$sliderContainer.trigger(i)}),this.$sliders.on("slidechange",function(t,n){var i;if(t.originalEvent&&t.originalEvent.type==="keyup"){var s;switch(t.which){case 37:if(r.value===null||r.value===undefined)return;if(r.value===r.onScaleValues[0]){i=null,f.call(r,i);var o=e(t.target).parent().parent().find(".ssg_thumb_home");e(o).trigger("click");return}if(r.isSliderSetToOnScale(r.value)&&r.value!==r.onScaleValues[0]&&r.onScaleValues.length>1){i=r.getNextOnScaleId("left"),f.call(r,i),r.$slider.trigger("scaleSlider:changed"),g.call(r,r.scalePosition,!0);return}if(r.isSliderSetToOffScale(r.value)&&r.value===r.offScaleValues[0]){i=r.onScaleValues[r.onScaleValues.length-1],f.call(r,i),r.$slider.trigger("scaleSlider:changed"),g.call(r,r.maxValue,!0);return}if(r.isSliderSetToOffScale(r.value)&&r.value!=r.offScaleValues[0]){i=r.getNextOffScaleId("left"),f.call(r,i),s=e(t.target).parent().parent().find("[data-object-id='"+i+"']"),e(s).trigger("click");return}break;case 39:if(r.value===null||r.value===undefined){i=r.onScaleValues[0],f.call(r,i),r.$slider.trigger("scaleSliderGrid:answered"),g.call(r,r.minValue,!0);return}if(r.isSliderSetToOnScale(r.value)&&r.onScaleValues.length>1&&r.value!=r.onScaleValues[r.onScaleValues.length-1]){i=r.getNextOnScaleId("right"),f.call(r,i),r.$slider.trigger("scaleSliderGrid:answered"),g.call(r,r.scalePosition,!0);return}if(r.value===r.onScaleValues[r.onScaleValues.length-1]&&r.offScaleValues.length!=0){i=r.offScaleValues[0],f.call(r,i),h.call(r,this),s=e(t.target).parent().parent().find("[data-object-id='"+i+"']"),e(s).trigger("click");return}if(r.isSliderSetToOffScale(r.value)&&r.value!=r.offScaleValues[r.offScaleValues.length-1]){i=r.getNextOffScaleId("right"),f.call(r,i),s=e(t.target).parent().parent().find("[data-object-id='"+i+"']"),e(s).trigger("click");return}if(r.isSliderSetToOffScale(r.value)&&r.value==r.offScaleValues[r.offScaleValues.length-1])return}}var u=n.value<r.onScaleValues.length?n.value:r.maxValue;i=r.onScaleValues[u-1],g.call(r,u,!0),f.call(r,i),e(t.target).trigger("scaleSliderGrid:answered")}),this.$sliderContainers.on("scaleSliderGrid:answered",function(t,n){var i=e(this).data("object-id");r.seen[i]||(r.seen[i]=!0,r.answeredCount+=1),n||e(t.target).trigger("scaleSliderGrid:changed",{questionId:i,answerId:r.value})}),this.$sliderContainers.on("scaleSliderGrid:unanswered",function(t){var n=e(this).data("object-id");r.seen[n]&&(r.seen[n]=!1,r.answeredCount-=1),r.$sliderContainer.trigger("scaleSliderGrid:changed",{questionId:n,answerId:r.value})}),this},ui:function(){return this.$element},isSliderSetToOnScale:function(e){var t=!1;for(var n=0;n<this.onScaleValues.length;n++)if(e===this.onScaleValues[n]){t=!0;break}return t},getNextOnScaleId:function(e){var t;switch(e){case"right":for(var n=0;n<this.onScaleValues.length-1;n++)this.value===this.onScaleValues[n]&&(t=this.onScaleValues[n+1],this.scalePosition=n+2);break;case"left":for(var r=1;r<this.onScaleValues.length;r++)this.value===this.onScaleValues[r]&&(t=this.onScaleValues[r-1],this.scalePosition=r)}return t},isSliderSetToOffScale:function(e){var t=!1;for(var n=0;n<this.offScaleValues.length;n++)if(e===this.offScaleValues[n]){t=!0;break}return t},getNextOffScaleId:function(e){var t;switch(e){case"right":for(var n=0;n<this.offScaleValues.length-1;n++)this.value===this.offScaleValues[n]&&(t=this.offScaleValues[n+1]);break;case"left":for(var r=1;r<this.offScaleValues.length;r++)this.value===this.offScaleValues[r]&&(t=this.offScaleValues[r-1])}return t},_isAnswerSetToOffscale:function(e){var t=this.question.AnswerCollection,n=0;for(var r=0,i=t.length;r<i;r++)(t[r].CustomAnswerProperties.OffScale==="false"||t[r].CustomAnswerProperties.OffScale===undefined)&&n++;return e.CustomAnswerProperties.OffScale==="true"||n<2},setAnswer:function(e,t){this.seen[e]=!0,this.answeredCount+=1,this.callbacks.push({method:this._isAnswerSetToOffscale(t)?p:d,param:{rowId:e,answerId:t.ObjectId}})},addedToPage:function(){var t=this;this.callbacks.length>0&&setTimeout(function(){e.each(t.callbacks,function(e,n){n.method.call(t,n.param)})},200),t.$slider=t.$sliders.first()}};return function(){return e.extend({},i)}}),define("plugins/ExtendedQuestions/ScaleSliderGridPlugin/Scripts/main",["jQueryFramework","./scaleSliderGrid"],function(e,t){var n=function(e){return e.RespondingPlugin==="ScaleSliderGridPlugin"},r=function(n){var r=new t,i=function(){var t=!n.questionDefinition.Required&&r.answeredCount==0||r.answeredCount>=n.questionDefinition.RequiredRowCount||r.answeredCount==n.questionDefinition.WorkflowStepCollection.length,i=e("#"+n.questionDefinition.ObjectId+" .questionErrorMsg");return i&&i.toggle(!t),t},s=function(){var t=function(e,t){r.setAnswer(e,t),n.dataStore.setAnswerForRow(e,t.ObjectId,!0)},i=function(t){e.each(n.questionDefinition.AnswerCollection,function(e,r){n.dataStore.setAnswerForRow(t,r.ObjectId,!1)})},s=function(e,t){var r=t.questionId,s=t.answerId;s?(i(r),n.dataStore.setAnswerForRow(r,s,!0)):i(r),n.completionStatusChanged()},o="#"+n.questionDefinition.ObjectId;e(o).bind("scaleSliderGrid:changed",s);var u=function(){e.each(n.questionDefinition.WorkflowStepCollection,function(r,i){e.each(n.questionDefinition.AnswerCollection,function(e,r){var s=n.dataStore.getAnswerForRow(i.ObjectId,r.ObjectId);s&&t(i.ObjectId,r)})})};return r.init(n),u(),r.ui()},o=function(){r.addedToPage()};return{isComplete:i,createView:s,addedToPage:o,getObjectId:function(){return n.questionDefinition.ObjectId}}};return{create:r,shouldHandleQuestion:n}}),define("hbs!pluginsShared/CardSort/Desktop/templates/cardSortTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){return'\r\n        <div class="category-column col1"></div>\r\n        <div class="category-column col2"></div>\r\n    '}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="cardsort-container" id="cardsort_',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'" data-template-element-id="cardsortContainer">\r\n    <div class="cardsort-categories" data-template-element-id="categories">\r\n    ',o=n["if"].call(t,t.smallMode,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\r\n    </div>\r\n</div>",s})}),define("hbs!pluginsShared/CardSort/Desktop/templates/cardTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\r\n    <div class="img-container">\r\n        <div class="img-overlay-container" style="width:',(i=n.imgWidth)?i=i.call(e,{hash:{},data:t}):(i=e.imgWidth,i=typeof i===u?i.apply(e):i),r+=a(i)+"px;height:",(i=n.imgHeight)?i=i.call(e,{hash:{},data:t}):(i=e.imgHeight,i=typeof i===u?i.apply(e):i),r+=a(i)+'px">\r\n            <img src=',(i=n.imagePath)?i=i.call(e,{hash:{},data:t}):(i=e.imagePath,i=typeof i===u?i.apply(e):i),r+=a(i)+' class="imagePlaceholder" data-template-element-id="cardImage" alt="',(i=n.altText)?i=i.call(e,{hash:{},data:t}):(i=e.altText,i=typeof i===u?i.apply(e):i),r+=a(i)+'" width="',(i=n.imgWidth)?i=i.call(e,{hash:{},data:t}):(i=e.imgWidth,i=typeof i===u?i.apply(e):i),r+=a(i)+'" height="',(i=n.imgHeight)?i=i.call(e,{hash:{},data:t}):(i=e.imgHeight,i=typeof i===u?i.apply(e):i),r+=a(i)+'"/>\r\n        </div>\r\n    </div>\r\n    ',r}function c(e,t){var r="",i;r+="\r\n    ",i=n["if"].call(e,e.noImage,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+='\r\n    <div class="card-label-container">\r\n        <div class="card-label answer-font-family">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+="</div>\r\n    </div>\r\n    ",r}function h(e,t){return"\r\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="card" id=',(o=n.name)?o=o.call(t,{hash:{},data:i}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+">\r\n    ",o=n["if"].call(t,t.hasImage,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\r\n    ",o=n["if"].call(t,t.hasLabel,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='\r\n    <div class="card-header">\r\n        <span class="drag-icon" role="presentation"></span>\r\n        <div class="card-count">\r\n            <span data-template-element-id="cardNumber">',(o=n.index)?o=o.call(t,{hash:{},data:i}):(o=t.index,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>/<span data-template-element-id="cardTotal">',(o=n.total)?o=o.call(t,{hash:{},data:i}):(o=t.total,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n        </div>\r\n        <div class="controls-holder">\r\n            <div class="x-icon" data-template-element-id="cardX" role="button" aria-label="',(o=n.removeLabel)?o=o.call(t,{hash:{},data:i}):(o=t.removeLabel,o=typeof o===u?o.apply(t):o),s+=a(o)+'" tabindex="0" />\r\n        </div>\r\n    </div>\r\n</div>',s})}),define("pluginsShared/CardSort/Desktop/js/cardsortImages",["jQueryFramework","images"],function(e,t){function o(t){e.each(t.getRows(),function(e,t){if(t.CustomRowProperties&&t.CustomRowProperties.VcSharedImage&&t.CustomRowProperties.VcSharedImage.AssetUrl){var n=new Image,r=new Image;n.src=f(t).Url,r.src=c(t).Url}})}function u(e,n){if(!e||!e.CustomRowProperties||!e.CustomRowProperties.VcSharedImage||!e.CustomRowProperties.VcSharedImage.AssetUrl)return null;var r={Url:e.CustomRowProperties.VcSharedImage.AssetUrl,Width:e.CustomRowProperties.VcSharedImage.Width,Height:e.CustomRowProperties.VcSharedImage.Height,AltText:e.CustomRowProperties.VcSharedImage.AltText,Scale:1};if(!n)return r;var i=Math.min(r.Width>n.width?n.width/r.Width:1,r.Height>n.height?n.height/r.Height:1);if(!!n.minWidth||!!n.minHeight)i=Math.max(!!n.minWidth&&r.Width*i<n.minWidth?n.minWidth/r.Width:i,!!n.minHeight&&r.Height*i<n.minHeight?n.minHeight/r.Height:i);return i<1&&(r.Width*=i,r.Height*=i,r.Scale=i,r.Url=t.generateAssetManagerUrl(r.Url,r.Width,r.Height)),r}function a(e){return u(e)}function f(e){return u(e,n)}function l(e,t){return u(e,t?i:r)}function c(e){return u(e,s)}function h(e){return e.CustomRowProperties&&e.CustomRowProperties.VcSharedDisplayText==="false"}var n={width:90,height:90},r={width:275,height:247},i={width:205,height:177},s={width:60,height:50,minWidth:40,minHeight:40};return{preload:o,getImageProperties:a,getDragHelperImageProperties:f,getRowImageProperties:l,getAnswerImageProperties:c,isImageOnly:h}}),define("pluginsShared/CardSort/Desktop/js/cardView",["hbs!../templates/cardTemplate","./cardsortImages","desktop/imageUtils","jQueryFramework"],function(e,t,n,r){function i(i,s,o){function p(s){h=t.getRowImageProperties(i.properties,s),l=!!h,c=!l||!t.isImageOnly(i.properties),u=r(e({hasImage:l,noImage:!l,imagePath:l&&h.Url,hasLabel:c,imgWidth:l&&h.Width,imgHeight:l&&h.Height,label:i.getLabel(),name:i.getName(),altText:l&&h.AltText,index:i.getIndex(),total:i.getTotal(),removeLabel:o.RemoveCard}));if(l){var a=u.find("img");a.imagesLoaded().done(function(){u.find("img").removeClass("imagePlaceholder"),h.Scale<1&&n.renderExpandOverlay(a.parent(),c?i.getLabel():"",t.getImageProperties(i.properties).Url)}),u.addClass("has-image")}else u.addClass("no-image");return!s||u.addClass("sm"),u}function d(){function e(e){return e.type!=="keyup"||e.keyCode!==r.ui.keyCode.SPACE&&e.keyCode!==r.ui.keyCode.ENTER?!1:(e.stopPropagation(),e.preventDefault(),!0)}var t=u.find(".card-label"),n=u.find(".x-icon");n.on("click keyup",function(t){(t.type==="click"||e(t))&&u.trigger("remove-card",i.getName())}),n.keypress(function(e){e.keyCode===r.ui.keyCode.ENTER&&e.preventDefault()}),u.draggable({containment:r(f+" .cardsort-container"),cursorAt:{top:l?40:20,left:l?40:100},appendTo:f+" .cardsort-container",helper:function(){var e=r("<div/>").addClass("card-drag-helper answer-font-family");if(l){e.addClass("has-image");var t=r("<div/>").addClass("img-overlay-container").append(u.find("img").clone()),n=r("<div/>").addClass("img-container").append(t);e.append(n)}else e.addClass("no-image").append(r("<span/>").addClass("drag-icon")).append(r("<div/>").addClass("card-label").text(r(this).find(".card-label").text()));return e},start:function(e,t){u.css("visibility","hidden");if(l){var n=t.helper.find(".img-container"),r=n.find("img");!r[0].complete||typeof r[0].naturalWidth!="undefined"&&r[0].naturalWidth===0?r.on("load",function(){m(n)}):m(n)}u.trigger("card-dragstart",[i.getName(),t.helper])},stop:function(e,t){u.trigger("card-dragstop",[i.getName(),t.helper])}}),i.isSorted()?g():v()}function v(){var e=5,t=24,r=28,i;if(l){var s=u.find(".img-container"),o=u.find(".img-overlay-container");o.css({width:"",height:""}),i=(s.height()-o.height())/2,o.css({left:0,top:i,width:"",height:""});var a=u.find(".card-label");a[0]&&a[0].scrollHeight>a.height()&&a.addClass("small"),h.Scale>=1&&n.removeOverlay(o)}else{var f=u.find(".card-label-container"),a=f.children(".card-label");a[0].scrollHeight>a.height()&&a.toggleClass("small",!0),i=(u.height()-f.height())/2,f.css("top",i)}}function m(e){var t=e.find(".img-overlay-container"),n=t.children("img"),r=(e.height()-n.height())/2,i=(e.width()-n.width())/2,s={top:r},o=constants.IsRtlContentDirection?"right":"left";s[o]=i,n.css(s),t.css({left:0,top:0,width:e.width(),height:e.height()})}function g(){var e=u.find(".magnify-icon");if(l)m(u.find(".img-container")),u.find(".card-label-container").css("top",""),h.Scale>=1&&n.renderExpandOverlay(u.find(".img-overlay-container"),c?i.getLabel():"",h.Url);else{var t=u.find(".card-label-container");t.css("top","")}}function y(e){g(),i.setCategory(e)}function b(){v(),i.setCategory("")}function w(e){var t=u.find(".x-icon");e?(u.css("visibility","visible"),u.draggable("enable"),t.attr("tabindex","0"),u.css("cursor","")):(u.draggable("disable"),t.attr("tabindex","-1"),u.css("cursor","default"))}var u,a=!1,f=s,l=!1,c=!0,h;return{createView:p,addedToPage:d,getCategory:function(){return i.getCategory()},isSorted:function(){return i.isSorted()},setEnabled:w,addedToStack:b,addedToCategory:y,getName:function(){return i.getName()},getView:function(){return u}}}return{create:i}}),define("hbs!pluginsShared/CardSort/Desktop/templates/categoryTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression;s+='<div class="category" data-attribute-code="',(o=n.code)?o=o.call(t,{hash:{},data:i}):(o=t.code,o=typeof o===u?o.apply(t):o),s+=a(o)+'">\r\n    <div class="category-header" data-template-element-id="categoryHeader">\r\n        <span class="header-text answer-font-family">',(o=n.headerText)?o=o.call(t,{hash:{},data:i}):(o=t.headerText,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+='</span>\r\n        <span class="vci-font-icon ACadd header-plus" data-template-element-id="headerPlus" tabindex="0" role="button" aria-label="',(o=n.addCardLabel)?o=o.call(t,{hash:{},data:i}):(o=t.addCardLabel,o=typeof o===u?o.apply(t):o),s+=a(o)+'"></span>\r\n    </div>\r\n    <div class="category-cards-holder" data-template-element-id="categoryHolder" />\r\n</div>',s})}),define("pluginsShared/CardSort/Desktop/js/categoryView",["hbs!../templates/categoryTemplate","jQueryFramework"],function(e,t){function n(n,r,i){function u(r,o){s=t(e({headerText:n.getLabel(),code:n.getCode(),addCardLabel:i.AddCard})),!o||s.addClass("sm");var u=s.find(".category-cards-holder");return r!==null&&typeof r!="undefined"&&r.length&&t.each(r,function(e,t){u.append(t.createView(o))}),s}function a(){function e(e){return e.type!=="keyup"||e.keyCode!==t.ui.keyCode.SPACE&&e.keyCode!==t.ui.keyCode.ENTER?!1:(e.stopPropagation(),e.preventDefault(),!0)}var r=s.find(".category-header"),i=s.find(".header-plus"),u=s.find(".category-cards-holder");r.hover(function(){i.addClass("hover")},function(){i.removeClass("hover")}),r.on("click keyup",function(t){t.stopPropagation(),(t.type==="click"||e(t))&&s.trigger("category-add",n.getCode())}),r.keypress(function(e){e.keyCode===t.ui.keyCode.ENTER&&e.preventDefault()}),u.droppable({accept:o+" .card",tolerance:"pointer",drop:function(e,t){u.removeClass("hovered").css("height","auto"),s.trigger("category-drop",n.getCode())},over:function(e,t){var n=u.height()+t.helper[0].clientHeight;u.addClass("hovered").css({height:n})},out:function(e,t){u.removeClass("hovered").css("height","auto")}})}function f(e){var t=s.find(".category-cards-holder"),r={top:0,opacity:1},i=constants.IsRtlContentDirection?"right":"left";r[i]=0,t.append(e.getView().stop(!0).css(r).detach()),e.addedToCategory(n.getCode())}function l(e){e?s.find(".header-plus").attr("tabindex",0):s.find(".header-plus").attr("tabindex",-1)}var s,o=r;return{createView:u,addedToPage:a,setEnabled:l,addCard:f,getCode:function(){return n.getCode()},getView:function(){return s}}}return{create:n}}),define("hbs!pluginsShared/CardSort/Desktop/templates/stackTemplate",["handlebars"],function(e){return e.template(function(e,t,n,r,i){return this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{},'<div class="cardsort-cards"></div>'})}),define("pluginsShared/CardSort/Desktop/js/stackView",["hbs!../templates/stackTemplate","jQueryFramework"],function(e,t){function n(){function a(r,i){return n=t(e({})),r!==null&&typeof r!="undefined"&&r.length&&(u=r,t.each(r,function(e,t){n.prepend(t.createView(i))})),!i||n.addClass("sm"),n}function f(){l(!0)}function l(e){function l(e){var n={top:o,opacity:0},r=constants.IsRtlContentDirection?"right":"left";n[r]=0,e.animate(n,i,s,function(){t(this).css("visibility","hidden")})}function p(e){var t={top:o+r*Math.abs(d-a),opacity:1},n=constants.IsRtlContentDirection?"right":"left";t[n]=r*Math.abs(d-a),e.css({visibility:"visible"}).animate(t,i,s)}var u=n.find(".card");u.finish();var a=Math.min(u.length,3),f=u.length-a;for(var d=a;d>0;d--)if(!e)p(u.filter(":nth-last-child("+d+")"));else{var v={top:o+r*Math.abs(d-a)},m=constants.IsRtlContentDirection?"right":"left";v[m]=r*Math.abs(d-a),u.filter(":nth-last-child("+d+")").css(v).css({visibility:"visible",opacity:1})}if(f>0)for(var g=0;g<f;g++)if(!e)l(u.eq(g));else{var v={visibility:"hidden",opacity:0,top:o},m=constants.IsRtlContentDirection?"right":"left";v[m]=0,u.eq(g).css(v)}c(),h()}function c(){n.find(".card").each(function(e,n){var r=parseInt(t(n).find(".card-count span:eq(1)").text());t(n).find(".card-count span:eq(0)").text(r-e)})}function h(){t.each(u,function(e,t){e===0?t.setEnabled(!0):t.setEnabled(!1)})}function p(e){u.unshift(e);var t=e.getView().css({visibility:"hidden"}).detach(),i={top:o+r*Math.min(u.length,4)},s=constants.IsRtlContentDirection?"right":"left";i[s]=r*Math.min(u.length,4),t.css(i),n.append(t),e.addedToStack()}function d(){return u.shift()}var n,r=10,i=300,s="easeOutSine",o=50,u=[];return{createView:a,addedToPage:f,updateView:l,addCard:p,getTopCard:d,enableTopCard:h,length:function(){return u.length},getView:function(){return n}}}return{create:n}}),define("pluginsShared/CardSort/js/cardViewModel",["jQueryFramework"],function(e){function t(e,t,n){var r=e,i=!1,s="";return{getName:function(){return r.ObjectId},isSorted:function(){return!!s},getCategory:function(){return s},setCategory:function(e){s=e},getLabel:function(){return r.Html},getIndex:function(){return t},getTotal:function(){return n},properties:r}}return{create:t}}),define("pluginsShared/CardSort/js/categoryViewModel",["jQueryFramework"],function(e){function t(t){function i(e){r.push(e),e.setCategory(n)}function s(t){e.each(r,function(e,n){if(t===n)return t.setCategory(""),!1})}var n=t.ObjectId,r=[];return{getCode:function(){return n},getLabel:function(){return t.Html},addCard:i,removeCard:s}}return{create:t}}),define("pluginsShared/CardSort/js/cardsortViewModel",["./cardViewModel","./categoryViewModel","jQueryFramework"],function(e,t,n){function r(r){function u(){n.each(i,function(e,t){n.each(s,function(e,n){r.dataStore.setAnswerForRow(t.getName(),n.getCode(),n.getCode()===t.getCategory())})}),r.completionStatusChanged()}function a(){var e=f(),t=!r.questionDefinition.Required&&e===0||e>=r.questionDefinition.RequiredRowCount||e>=r.questionDefinition.WorkflowStepCollection.length,i=n("#"+r.questionDefinition.ObjectId+" .questionErrorMsg");return i&&i.toggle(!t),t}function f(){var e=0;return n.each(i,function(t,n){n.getCategory()&&e++}),e}var i=[],s=[],o={};return n.each(r.questionDefinition.WorkflowStepCollection,function(t,n){i.push(e.create(n,t+1,r.questionDefinition.WorkflowStepCollection.length))}),n.each(r.questionDefinition.AnswerCollection,function(e,n){s.push(t.create(n))}),n.each(i,function(e,t){n.each(s,function(e,n){r.dataStore.getAnswerForRow(t.getName(),n.getCode())&&t.setCategory(n.getCode())})}),{getCards:function(){return i},getCategories:function(){return s},getProperties:function(){return r.questionDefinition},getRows:function(){return r.questionDefinition.WorkflowStepCollection},validate:a,save:u}}return{create:r}}),define("pluginsShared/CardSort/Desktop/js/cardsortView",["hbs!../templates/cardSortTemplate","pluginsShared/CardSort/Desktop/js/cardView","pluginsShared/CardSort/Desktop/js/categoryView","pluginsShared/CardSort/Desktop/js/stackView","pluginsShared/CardSort/Desktop/js/cardsortImages","pluginsShared/CardSort/js/cardsortViewModel","viewUtils","jQueryFramework"],function(e,t,n,r,i,s,o,u){function a(a){function g(){var r=u(e({name:a.questionDefinition.ObjectId,smallMode:b()})),i=[];u.each(l.getCards(),function(e,n){var r=t.create(n,f,m);h.push(r),n.isSorted()||i.push(r)}),r.prepend(c.createView(i,b()));var s=r.find(".cardsort-categories");return b()&&s.addClass("sm"),u.each(l.getCategories(),function(e,t){var i=n.create(t,f,m);p.push(i),b()&&(e%2?s=r.find(".category-column.col2"):s=r.find(".category-column.col1"));var o=u.map(h,function(e,n){if(e.getCategory()===t.getCode())return e});s.append(i.createView(o,b()))}),v=r,r}function y(){function r(){u.each(h,function(e,t){t.setEnabled(!1)}),u.each(p,function(e,t){t.setEnabled(!1)})}function s(){c.enableTopCard(),u.each(h,function(e,t){t.isSorted()&&t.setEnabled(!0)}),u.each(p,function(e,t){t.setEnabled(!0)})}function a(e,t){if(c.length()===0)return;var n=w(t),r=c.getTopCard(),i=y(r.getView());r.getView().css("visibility","hidden"),n.addCard(r),l.save(),E(r,i,function(){r.setEnabled(!0),c.updateView()})}function f(n,r){if(e===null)return;var i=e;e.isSorted()||(i=c.getTopCard());var s=e.getView();s.css("visiblity","hidden");var o=w(r),u=y(t?t:s);o.addCard(e),l.save(),E(e,u,function(){i.setEnabled(!0),c.updateView()}),e=null,t=null}function d(n,r,i){e=b(r),e.isSorted()||S(),t=i}function m(n,r,i){var s=b(r),o=y(i);x(),s.isSorted()?e!==null&&(c.addCard(s),l.save(),E(s,o,function(){c.updateView()})):E(s,o,function(){c.updateView()}),e=null,t=null}function g(e,t){var n=b(t),r=n.getView();r.css({visibility:"hidden"});var i=y(n.getView());c.addCard(n),l.save(),E(n,i,function(){c.updateView()})}function y(e){return{left:e.position().left,top:e.position().top,width:e.width(),height:e.height()}}function b(e){return h.reduce(function(t,n){return n.getName()===e?n:t})}function w(e){return p.reduce(function(t,n){return n.getCode()===e?n:t})}function E(e,t,r){var i=150,s="easeOutSine",o=e.getView(),a=y(o),f=u("<div/>").addClass("card-animation-shim").css(t).appendTo(n.$root);f.animate(a,{duration:i,easing:s,queue:!1,complete:function(){f.remove(),!r||r()}})}function S(){c.getView().animate({opacity:.6},100)}function x(){c.getView().animate({opacity:1},100)}function T(){var e=50,t=e,r=n.$root.find(".category-header");r.each(function(e,n){t=Math.max(u(n).height(),t)}),t>e&&r.each(function(e,n){u(n).css("height",t)})}function N(){u.each(h,function(e,t){t.addedToPage();var n=t.getView();n.on("zoom-start",r),n.on("zoom-stop",s),n.on("card-dragstart",d),n.on("card-dragstop",m),n.on("remove-card",g)}),u.each(p,function(e,t){t.addedToPage();var n=t.getView();n.on("category-add",a),n.on("category-drop",f)}),T(),c.addedToPage()}var e=null,t=null,n=o.grabElements(v);i.preload(l),N()}function b(){return l.getCategories().length>3}var f="#pluginRoot_"+a.questionDefinition.ObjectId,l=s.create(a),c=r.create(),h=[],p=[],d,v,m={AddCard:a.getLocalizedString("AddCard"),RemoveCard:a.getLocalizedString("RemoveCard")};return{createView:g,addedToPage:y,isComplete:l.validate}}return{create:a}}),define("plugins/ExtendedQuestions/CardSortPlugin/Scripts/main",["pluginsShared/CardSort/Desktop/js/cardsortView"],function(e){var t=function(e){return e.RespondingPlugin==="CardSortPlugin"},n=function(t){var n=e.create(t),r=function(){return n.createView()},i=function(){n.addedToPage()};return{isComplete:n.isComplete,createView:r,addedToPage:i,getObjectId:function(){return t.questionDefinition.ObjectId}}};return{create:n,shouldHandleQuestion:t}}),define("pluginsShared/MediaPlayer/Desktop/mediaPlayer",["jQueryFramework","constants","event!enableDirty"],function(e,t,n){var r=function(e){var t=e.playerSizeType.split("x")[0],n=e.playerSizeType.split("x")[1];return{width:t,height:n}},i=function(i,s){var o=!1,u=s.CustomQuestionProperties,a=i,f=r(u),l=u.AudioUpload,c;u.MediaURL&&(l=/\.(?:wav|mp3|aac|m4a|f4a|ogg|oga)$/i.test(a.file));if(u.MediaURL){var h=/^(https?\:\/\/)?(www\.youtube\.com|youtu\.?be)\/.+$/;c=a.file.match(h)}var p=(l?"audio":"video")+s.ObjectId;t.IsMobile&&(a.fluid=!0,a.nativeControlsForTouch=!1),l&&(a.height="30px",a.width=f.width,a.controlBar={fullscreenToggle:!1}),!l&&!t.IsMobile&&(a.width=f.width,a.height=f.height),a.controls="true",a.preload="auto";var d=function(){var n;return t.IsMobile?n=l?e("<audio />").height("30px").css("padding","0"):e("<video />").addClass("vjs-big-play-centered"):n=l?e("<audio />"):e("<video />").addClass("vjs-big-play-centered"),n.addClass("video-js vjs-default-skin").attr("id",p),n.contextmenu(function(e){e.preventDefault()}),u.showPlayback.toLowerCase()==="false"&&n.addClass("no-playback"),u.showDuration.toLowerCase()==="false"&&n.addClass("no-duration"),s.RespondingPlugin==="UrlMediaPlayerPlugin"&&c?a.sources=[{type:"video/youtube",src:a.file}]:a.sources=[{type:"video/mp4",src:a.file}],n},v=function(){videojs(p,a).ready(function(){var r=this;l&&(e(".vjs-audio .vjs-big-play-button").css({display:"none"}),e(".vjs-audio > .vjs-control-bar").css({display:"flex"})),t.IsMobile&&(e(".video-js .ui-btn-hidden").removeClass("ui-btn-hidden"),e(".video-js span.ui-btn-inner").remove(),e(".video-js .ui-btn.ui-shadow.ui-btn-corner-all.ui-btn-up-c").removeClass("ui-btn ui-shadow ui-btn-corner-all ui-btn-up-c")),r.on("ended",function(){o=!0,n.publish(),u.autoLoad.toLowerCase()==="true"&&(t.IsMobile?e(".nextButton").find("button").click():e("#Next").click())})})};return{createView:d,addedToPage:v,isComplete:function(){return u.disableNextButton.toLowerCase()==="true"?o:!0}}};return{create:i}}),define("plugins/ExtendedQuestions/VideoPlayerPlugin/Scripts/main",["jQueryFramework","pluginsShared/MediaPlayer/Desktop/mediaPlayer"],function(e,t){var n=function(e){return e.RespondingPlugin==="VideoPlayerPlugin"},r=function(e){var n=function(e){var t="";if(e.VideoUpload.AssetUrl){var n=e.VideoUpload.AssetUrl.split(".");if(n.pop()!=="mp4"){for(var r=0;r<n.length;r++)t+=n[r]+".";t+="mp4"}else t=e.VideoUpload.AssetUrl}return{file:t}},r=e.questionDefinition,i=n(r.CustomQuestionProperties),s=t.create(i,r);return{isComplete:s.isComplete,getObjectId:function(){return r.ObjectId},createView:s.createView,addedToPage:s.addedToPage}};return{create:r,shouldHandleQuestion:n}}),define("plugins/ExtendedQuestions/UrlMediaPlayerPlugin/Scripts/main",["jQueryFramework","pluginsShared/MediaPlayer/Desktop/mediaPlayer"],function(e,t){var n=function(e){return e.RespondingPlugin==="UrlMediaPlayerPlugin"},r=function(e){var n=function(e){return{file:e.MediaURL}},r=e.questionDefinition,i=n(r.CustomQuestionProperties),s=t.create(i,r);return{isComplete:s.isComplete,getObjectId:function(){return r.ObjectId},createView:s.createView,addedToPage:s.addedToPage}};return{create:r,shouldHandleQuestion:n}}),define("plugins/ExtendedQuestions/AudioPlayerPlugin/Scripts/main",["jQueryFramework","pluginsShared/MediaPlayer/Desktop/mediaPlayer"],function(e,t){var n=function(e){return e.RespondingPlugin==="AudioPlayerPlugin"},r=function(e){var n=function(e){return{file:e.AudioUpload.AssetUrl}},r=e.questionDefinition,i=n(r.CustomQuestionProperties),s=t.create(i,r);return{isComplete:s.isComplete,getObjectId:function(){return r.ObjectId},createView:s.createView,addedToPage:s.addedToPage}};return{create:r,shouldHandleQuestion:n}}),define("pluginsShared/AssetUploader/progressbar",["jQueryFramework"],function(e){"use strict";function t(t){function s(e){r.text(e)}function o(e){i.text(e+"%"),n.progressbar("value",e)}function u(){n.progressbar("destroy"),n.off(),n.remove()}function a(){n.show(),s(""),o(0)}var n=e("<div />").css("width",t.width()-30),r=e("<div/>").addClass("ui-progressbar-label"),i=e("<div/>").addClass("ui-progressbar-percent");return t.append(n),n.progressbar(),n.append(r),n.append(i),s("Uploading..."),o(0),i.text(0),{setLabel:s,setValue:o,init:a,destroy:u}}return{create:t}}),function(e){typeof define=="function"&&define.amd?define("lib/fileupload/jquery.fileupload",["jQueryFramework"],e):typeof exports=="object"?e(require("jquery"),require("jquery-ui/widget")):e(window.jQuery)}(function(e){function t(t){var n=t==="dragover";return function(r){r.dataTransfer=r.originalEvent&&r.originalEvent.dataTransfer;var i=r.dataTransfer;i&&e.inArray("Files",i.types)!==-1&&this._trigger(t,e.Event(t,{delegatedEvent:r}))!==!1&&(r.preventDefault(),n&&(i.dropEffect="copy"))}}e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))")).test(window.navigator.userAgent)&&!e('<input type="file">').prop("disabled"),e.support.xhrFileUpload=!!window.ProgressEvent&&!!window.FileReader,e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:undefined,fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,n){return t=this.messages[t]||t.toString(),n&&e.each(n,function(e,n){t=t.replace("{"+e+"}",n)}),t},formData:function(e){return e.serializeArray()},add:function(t,n){if(t.isDefaultPrevented())return!1;(n.autoUpload||n.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&n.process().done(function(){n.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,n){var r=e-this.timestamp;if(!this.bitrate||!n||r>n)this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=e;return this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var n;return e.type(t.formData)==="function"?t.formData(t.form):e.isArray(t.formData)?t.formData:e.type(t.formData)==="object"?(n=[],e.each(t.formData,function(e,t){n.push({name:e,value:t})}),n):[]},_getTotal:function(t){var n=0;return e.each(t,function(e,t){n+=t.size||1}),n},_initProgressObject:function(t){var n={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,n):t._progress=n},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,n){if(t.lengthComputable){var r=Date.now?Date.now():(new Date).getTime(),i;if(n._time&&n.progressInterval&&r-n._time<n.progressInterval&&t.loaded!==t.total)return;n._time=r,i=Math.floor(t.loaded/t.total*(n.chunkSize||n._progress.total))+(n.uploadedBytes||0),this._progress.loaded+=i-n._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(r,this._progress.loaded,n.bitrateInterval),n._progress.loaded=n.loaded=i,n._progress.bitrate=n.bitrate=n._bitrateTimer.getBitrate(r,i,n.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),n),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var n=this,r=t.xhr?t.xhr():e.ajaxSettings.xhr();r.upload&&(e(r.upload).bind("progress",function(e){var r=e.originalEvent;e.lengthComputable=r.lengthComputable,e.loaded=r.loaded,e.total=r.total,n._onProgress(e,t)}),t.xhr=function(){return r})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var n=this,r,i=t.files[0],s=t.multipart||!e.support.xhrFileUpload,o=e.type(t.paramName)==="array"?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange);if(!s||t.blob||!this._isInstanceOf("File",i))t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"';s?e.support.xhrFormDataFileUpload&&(t.postMessage?(r=this._getFormData(t),t.blob?r.push({name:o,value:t.blob}):e.each(t.files,function(n,i){r.push({name:e.type(t.paramName)==="array"&&t.paramName[n]||o,value:i})})):(n._isInstanceOf("FormData",t.formData)?r=t.formData:(r=new FormData,e.each(this._getFormData(t),function(e,t){r.append(t.name,t.value)})),t.blob?r.append(o,t.blob,i.name):e.each(t.files,function(i,s){(n._isInstanceOf("File",s)||n._isInstanceOf("Blob",s))&&r.append(e.type(t.paramName)==="array"&&t.paramName[i]||o,s,s.uploadName||s.name)})),t.data=r):(t.contentType=i.type||"application/octet-stream",t.data=t.blob||i),t.blob=null},_initIframeSettings:function(t){var n=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&n&&n!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var n=e(t.fileInput),r=t.paramName;return r?e.isArray(r)||(r=[r]):(r=[],n.each(function(){var t=e(this),n=t.prop("name")||"files[]",i=(t.prop("files")||[1]).length;while(i)r.push(n),i-=1}),r.length||(r=[n.prop("name")||"files[]"])),r},_initFormSettings:function(t){if(!t.form||!t.form.length)t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")));t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||e.type(t.form.prop("method"))==="string"&&t.form.prop("method")||"").toUpperCase(),t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var n=e.extend({},this.options,t);return this._initFormSettings(n),this._initDataSettings(n),n},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,n,r){var i=e.Deferred(),s=i.promise();return n=n||this.options.context||s,t===!0?i.resolveWith(n,r):t===!1&&i.rejectWith(n,r),s.abort=i.promise,this._enhancePromise(s)},_addConvenienceMethods:function(t,n){var r=this,i=function(t){return e.Deferred().resolveWith(r,t).promise()};n.process=function(t,s){if(t||s)n._processQueue=this._processQueue=(this._processQueue||i([this])).pipe(function(){return n.errorThrown?e.Deferred().rejectWith(r,[n]).promise():i(arguments)}).pipe(t,s);return this._processQueue||i([this])},n.submit=function(){return this.state()!=="pending"&&(n.jqXHR=this.jqXHR=r._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==!1&&r._onSend(t,this)),this.jqXHR||r._getXHRPromise()},n.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",r._trigger("fail",null,this),r._getXHRPromise(!1))},n.state=function(){if(this.jqXHR)return r._getDeferredState(this.jqXHR);if(this._processQueue)return r._getDeferredState(this._processQueue)},n.processing=function(){return!this.jqXHR&&this._processQueue&&r._getDeferredState(this._processQueue)==="pending"},n.progress=function(){return this._progress},n.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),r=n&&n.length>1&&parseInt(n[1],10);return r&&r+1},_chunkedUpload:function(t,n){t.uploadedBytes=t.uploadedBytes||0;var r=this,i=t.files[0],s=i.size,o=t.uploadedBytes,u=t.maxChunkSize||s,a=this._blobSlice,f=e.Deferred(),l=f.promise(),c,h;return!(this._isXHRUpload(t)&&a&&(o||u<s))||t.data?!1:n?!0:o>=s?(i.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",i.error])):(h=function(){var n=e.extend({},t),l=n._progress.loaded;n.blob=a.call(i,o,o+u,i.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+o+"-"+(o+n.chunkSize-1)+"/"+s,r._initXHRData(n),r._initProgressListener(n),c=(r._trigger("chunksend",null,n)!==!1&&e.ajax(n)||r._getXHRPromise(!1,n.context)).done(function(i,u,a){o=r._getUploadedBytes(a)||o+n.chunkSize,l+n.chunkSize-n._progress.loaded&&r._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o-n.uploadedBytes,total:o-n.uploadedBytes}),n),t.uploadedBytes=n.uploadedBytes=o,n.result=i,n.textStatus=u,n.jqXHR=a,r._trigger("chunkdone",null,n),r._trigger("chunkalways",null,n),o<s?h():f.resolveWith(n.context,[i,u,a])}).fail(function(e,t,i){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,r._trigger("chunkfail",null,n),r._trigger("chunkalways",null,n),f.rejectWith(n.context,[e,t,i])})},this._enhancePromise(l),l.abort=function(){return c.abort()},h(),l)},_beforeSend:function(e,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,n,r,i){var s=i._progress.total,o=i._response;i._progress.loaded<s&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:s,total:s}),i),o.result=i.result=t,o.textStatus=i.textStatus=n,o.jqXHR=i.jqXHR=r,this._trigger("done",null,i)},_onFail:function(e,t,n,r){var i=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),i.jqXHR=r.jqXHR=e,i.textStatus=r.textStatus=t,i.errorThrown=r.errorThrown=n,this._trigger("fail",null,r)},_onAlways:function(e,t,n,r){this._trigger("always",null,r)},_onSend:function(t,n){n.submit||this._addConvenienceMethods(t,n);var r=this,i,s,o,u,a=r._getAJAXSettings(n),f=function(){return r._sending+=1,a._bitrateTimer=new r._BitrateTimer,i=i||((s||r._trigger("send",e.Event("send",{delegatedEvent:t}),a)===!1)&&r._getXHRPromise(!1,a.context,s)||r._chunkedUpload(a)||e.ajax(a)).done(function(e,t,n){r._onDone(e,t,n,a)}).fail(function(e,t,n){r._onFail(e,t,n,a)}).always(function(e,t,n){r._onAlways(e,t,n,a),r._sending-=1,r._active-=1;if(a.limitConcurrentUploads&&a.limitConcurrentUploads>r._sending){var i=r._slots.shift();while(i){if(r._getDeferredState(i)==="pending"){i.resolve();break}i=r._slots.shift()}}r._active===0&&r._trigger("stop")}),i};return this._beforeSend(t,a),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),u=o.pipe(f)):(this._sequence=this._sequence.pipe(f,f),u=this._sequence),u.abort=function(){return s=[undefined,"abort","abort"],i?i.abort():(o&&o.rejectWith(a.context,s),f())},this._enhancePromise(u)):f()},_onAdd:function(t,n){var r=this,i=!0,s=e.extend({},this.options,n),o=n.files,u=o.length,a=s.limitMultiFileUploads,f=s.limitMultiFileUploadSize,l=s.limitMultiFileUploadSizeOverhead,c=0,h=this._getParamName(s),p,d,v,m,g=0;f&&(!u||o[0].size===undefined)&&(f=undefined);if(!(s.singleFileUploads||a||f)||!this._isXHRUpload(s))v=[o],p=[h];else if(!s.singleFileUploads&&!f&&a){v=[],p=[];for(m=0;m<u;m+=a)v.push(o.slice(m,m+a)),d=h.slice(m,m+a),d.length||(d=h),p.push(d)}else if(!s.singleFileUploads&&f){v=[],p=[];for(m=0;m<u;m+=1){c+=o[m].size+l;if(m+1===u||c+o[m+1].size+l>f||a&&m+1-g>=a)v.push(o.slice(g,m+1)),d=h.slice(g,m+1),d.length||(d=h),p.push(d),g=m+1,c=0}}else p=h;return n.originalFiles=o,e.each(v||o,function(s,o){var u=e.extend({},n);return u.files=v?o:[o],u.paramName=p[s],r._initResponseObject(u),r._initProgressObject(u),r._addConvenienceMethods(t,u),i=r._trigger("add",e.Event("add",{delegatedEvent:t}),u),i}),i},_replaceFileInput:function(t){var n=t.fileInput,r=n.clone(!0);t.fileInputClone=r,e("<form></form>").append(r)[0].reset(),n.after(r).detach(),e.cleanData(n.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===n[0]?r[0]:t}),n[0]===this.element[0]&&(this.element=r)},_handleFileTreeEntry:function(t,n){var r=this,i=e.Deferred(),s=function(e){e&&!e.entry&&(e.entry=t),i.resolve([e])},o=function(e){r._handleFileTreeEntries(e,n+t.name+"/").done(function(e){i.resolve(e)}).fail(s)},u=function(){a.readEntries(function(e){e.length?(f=f.concat(e),u()):o(f)},s)},a,f=[];return n=n||"",t.isFile?t._file?(t._file.relativePath=n,i.resolve(t._file)):t.file(function(e){e.relativePath=n,i.resolve(e)},s):t.isDirectory?(a=t.createReader(),u()):i.resolve([]),i.promise()},_handleFileTreeEntries:function(t,n){var r=this;return e.when.apply(e,e.map(t,function(e){return r._handleFileTreeEntry(e,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var n=t.items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(e.map(n,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var n=t.prop("webkitEntries")||t.prop("entries"),r,i;if(n&&n.length)return this._handleFileTreeEntries(n);r=e.makeArray(t.prop("files"));if(!r.length){i=t.prop("value");if(!i)return e.Deferred().resolve([]).promise();r=[{name:i.replace(/^.*\\/,"")}]}else r[0].name===undefined&&r[0].fileName&&e.each(r,function(e,t){t.name=t.fileName,t.size=t.fileSize});return e.Deferred().resolve(r).promise()},_getFileInputFiles:function(t){return t instanceof e&&t.length!==1?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var n=this,r={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(r.fileInput).always(function(i){r.files=i,n.options.replaceFileInput&&n._replaceFileInput(r),n._trigger("change",e.Event("change",{delegatedEvent:t}),r)!==!1&&n._onAdd(t,r)})},_onPaste:function(t){var n=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,r={files:[]};n&&n.length&&(e.each(n,function(e,t){var n=t.getAsFile&&t.getAsFile();n&&r.files.push(n)}),this._trigger("paste",e.Event("paste",{delegatedEvent:t}),r)!==!1&&this._onAdd(t,r))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=this,r=t.dataTransfer,i={};r&&r.files&&r.files.length&&(t.preventDefault(),this._getDroppedFiles(r).always(function(r){i.files=r,n._trigger("drop",e.Event("drop",{delegatedEvent:t}),i)!==!1&&n._onAdd(t,i)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,n){var r=e.inArray(t,this._specialOptions)!==-1;r&&this._destroyEventHandlers(),this._super(t,n),r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),n=t.pop();return t.shift(),new RegExp(t.join("/"),n)},_isRegExpOption:function(t,n){return t!=="url"&&e.type(n)==="string"&&/^\/.*\/[igm]{0,3}$/.test(n)},_initDataAttributes:function(){var t=this,n=this.options,r=this.element.data();e.each(this.element[0].attributes,function(e,i){var s=i.name.toLowerCase(),o;/^data-/.test(s)&&(s=s.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),o=r[s],t._isRegExpOption(s,o)&&(o=t._getRegExp(o)),n[s]=o)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var n=this;if(!t||this.options.disabled)return;t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,n._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n=this,r=e.Deferred(),i=r.promise(),s,o;return i.abort=function(){return o=!0,s?s.abort():(r.reject(null,"abort","abort"),i)},this._getFileInputFiles(t.fileInput).always(function(e){if(o)return;if(!e.length){r.reject();return}t.files=e,s=n._onSend(null,t),s.then(function(e,t,n){r.resolve(e,t,n)},function(e,t,n){r.reject(e,t,n)})}),this._enhancePromise(i)}t.files=e.makeArray(t.files);if(t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){typeof define=="function"&&define.amd?define("lib/fileupload/jquery.iframe-transport",["jQueryFramework"],e):typeof exports=="object"?e(require("jquery")):e(window.jQuery)}(function(e){var t=0;e.ajaxTransport("iframe",function(n){if(n.async){var r=n.initialIframeSrc||"javascript:false;",i,s,o;return{send:function(u,a){i=e('<form style="display:none;"></form>'),i.attr("accept-charset",n.formAcceptCharset),o=/\?/.test(n.url)?"&":"?",n.type==="DELETE"?(n.url=n.url+o+"_method=DELETE",n.type="POST"):n.type==="PUT"?(n.url=n.url+o+"_method=PUT",n.type="POST"):n.type==="PATCH"&&(n.url=n.url+o+"_method=PATCH",n.type="POST"),t+=1,s=e('<iframe src="'+r+'" name="iframe-transport-'+t+'"></iframe>').bind("load",function(){var t,o=e.isArray(n.paramName)?n.paramName:[n.paramName];s.unbind("load").bind("load",function(){var t;try{t=s.contents();if(!t.length||!t[0].firstChild)throw new Error}catch(n){t=undefined}a(200,"success",{iframe:t}),e('<iframe src="'+r+'"></iframe>').appendTo(i),window.setTimeout(function(){i.remove()},0)}),i.prop("target",s.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&e.each(n.formData,function(t,n){e('<input type="hidden"/>').prop("name",n.name).val(n.value).appendTo(i)}),n.fileInput&&n.fileInput.length&&n.type==="POST"&&(t=n.fileInput.clone(),n.fileInput.after(function(e){return t[e]}),n.paramName&&n.fileInput.each(function(t){e(this).prop("name",o[t]||n.paramName)}),i.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),n.fileInput.removeAttr("form")),i.submit(),t&&t.length&&n.fileInput.each(function(n,r){var i=e(t[n]);e(r).prop("name",i.prop("name")).attr("form",i.attr("form")),i.replaceWith(r)})}),i.append(s).appendTo(document.body)},abort:function(){s&&s.unbind("load").prop("src",r),i&&i.remove()}}}}),e.ajaxSetup({converters:{"iframe text":function(t){return t&&e(t[0].body).text()},"iframe json":function(t){return t&&e.parseJSON(e(t[0].body).text())},"iframe html":function(t){return t&&e(t[0].body).html()},"iframe xml":function(t){var n=t&&t[0];return n&&e.isXMLDoc(n)?n:e.parseXML(n.XMLDocument&&n.XMLDocument.xml||e(n.body).html())},"iframe script":function(t){return t&&e.globalEval(e(t[0].body).text())}}})}),define("pluginsShared/AssetUploader/fileupload",["jQueryFramework","lib/fileupload/jquery.fileupload","lib/fileupload/jquery.iframe-transport"],function(e){"use strict";function t(e,t,n,r,i){e.fileupload({url:n,type:"POST",dataType:"json",forceIframeTransport:r,global:!1,headers:{"X-WebApi-Return-Resource":"true"},formData:{postParams:JSON.stringify(t)},error:function(e){i.error(e)},add:function(e,t){i.add(t)},fail:function(e,t){i.fail(t)},done:function(e,t){i.done(t)}})}return{create:t}}),define("pluginsShared/AssetUploader/assetUploaderHelper",["jQueryFramework","utils","data","constants"],function(e,t,n,r){function a(t){function f(t){var n=e.extend({},o,t);return n}function l(e){return{tenantid:e.panelId,userid:e.userId,maxFileSizeInBytes:e.maxFileUploadSizeInBytes,useFilenameAsId:e.useFilenameAsId,transformation:{width:e.transformation.width,height:e.transformation.height,crop:e.transformation.crop,format:e.transformation.format},isSharedResource:e.isSharedResource,source:e.source,tags:e.tags}}function c(e){var t=h(e);return"."+t.join(",.")}function h(e){var t=[];for(var n=0;n<e.length;n++)e[n]==="image"?t=t.concat(s.image):e[n]==="video"?t=t.concat(s.video):e[n]==="audio"?t=t.concat(s.audio):t.push(e[n]);return t}function p(e,t){var n=t?"/"+t:"",r=(e.baseUrl+"/api/v1/tenants/{0}/assets").replace("{0}",e.panelId);return r+=n+"?token="+e.authToken,r}function d(e,t){return t+"?token="+e.authToken}function v(t){if(t&&t.length>0){var n=p(r.AssetManagerConfig,t);if(!i)e.ajax({type:"DELETE",url:n});else if((new XMLHttpRequest).withCredentials===undefined){var s=new XMLHttpRequest;s.open("DELETE",n,!0),s.send()}}}function m(e,n){var r=h(n),i=e.toLowerCase(),s=!1;for(var o=0;o<r.length;o++)if(i===r[o]){s=!0;break}return{isValid:s,message:t.getLocalizedString("WrongFileExtension")}}function g(e,n){var r=!0;return e>n&&(r=!1),{isValid:r,message:t.getLocalizedString("FileSizeValidation")}}function y(t,n){if(!e.isEmptyObject(n)){var s=p(r.AssetManagerConfig,n.filename);if(!i)e.ajax({type:"GET",url:s,success:function(e){t.success(e)},error:function(e){t.error(e)}});else{var o=new XDomainRequest;o.open("get",s),o.onload=function(){t.success(JSON.parse(o.responseText))},o.onerror=function(){t.error(JSON.parse(o.responseText))},o.send()}}}function b(e){var n=(e.jqXHR?e.jqXHR.status:e.status).toString(),r=n&&n.indexOf("2")===0;return!r||!e.result?{isValid:!1,message:t.getLocalizedString("ServerError")}:{isValid:!0,message:""}}function w(e){var n,r=t.dataStore.getOpenEndText(e);try{n=JSON.parse(r)}catch(i){n={}}return n}function E(n){var r=t.dataStore.getAnswer(t.questionDefinition.AnswerCollection[0].ObjectId);r===!0&&(!e.isEmptyObject(n)&&n.filename.length>0?t.dataStore.setOpenEndText(JSON.stringify(n)):t.dataStore.setOpenEndText(""))}function S(n,r){var i=t.questionDefinition.Required;return r&&!i?!1:!i||i&&!e.isEmptyObject(n)&&n.filename.length>0}function x(){var e=t.questionDefinition.ObjectId,r=t.questionDefinition.AnswerCollection[0].ObjectId;n.selectedByAnswerIdStepId(r,e).val(!0)}var a=[];return{isOldIe:i,mergeSettings:f,spinnerOptions:u,getFormData:l,getFileExtensionsString:c,expandFileExtensions:h,buildAssetManagerUrl:p,validateServerResult:b,validateExtension:m,validateFileSize:g,deleteImage:v,getExistingImage:y,getImageUrl:d,validate:S,load:w,save:E,setSelected:x}}var i=t.isIE9OrLess(),s={image:["jpg","jpeg","gif","png","bmp","tiff","svg","webp"],video:["mp4","avi","ogg","mov","mpg","mpeg","webm","flv","mov","ogv","3gp","3g2","wmv"],audio:["aac","m4a","f4a","mp3","ogg","oga"]},o={maxFileUploadSizeInBytes:20971520,useFilenameAsId:!1,validExtensions:s.image,transformation:{format:"jpg",quality:80,width:1e3,height:1e3,crop:{cropType:"limit"}},isSharedResource:!0,isPrivate:!0,hasAltText:!1,iFrameTransportResultPath:r.EqfBaseUrl+"/Framework/Common/js/lib/fileupload/result.html",insert:function(){},addAsset:function(){},addFail:function(){}},u={position:"absolute",lines:9,length:11,width:2,radius:6,corners:1,rotate:10,direction:1,speed:1.1,trail:42,shadow:!1,hwaccel:!0};return{create:a}}),define("pluginsShared/AssetUploader/assetUploader.desktop",["jQueryFramework","utils","./progressbar","./fileupload","./assetUploaderHelper","constants","lib/spinner/jquery.spin"],function(e,t,n,r,i,s){function o(t,o){function p(){return l.validate(u,f)}function d(){l.save(u)}function v(){if(e.isEmptyObject(u)){var t=a.find(".upload-btn-container"),n=a.find(".error-message"),r=a.find(".vc-progress-bar");t.find("button").first().text(o.getLocalizedString("ChoosePicture"));var i=t.find(".browse-container").width(),s=c/2-t.height()/2,f=c/2-i/2;a.find(".placeholder").css("width",c).css("height",c),a.find(".progress-bar").css("width",c-20),t.css({bottom:s,left:f,margin:"0 auto"}),a.find("input")[0].style.setProperty("width",i+"px","important"),n.css("bottom",s-t.height()),r.hide(),a.find("img").hide()}else a.spin(l.spinnerOptions),l.getExistingImage(h,u),a.find(".upload-btn-container").hide(),a.find("img").hide()}function m(){v()}function g(){function E(e){U.html('<span class="vci-font-icon" style="color: #51c046">&#xe646;</span>&nbsp;&nbsp;'+e),U.show()}function S(e){U.html('<span class="vci-font-icon" style="color: #B60000;"">&#xe64b;</span>&nbsp;&nbsp;'+e),U.show()}function x(e){D.hide(),_.html('<span class="vci-font-icon" style="color: #B60000;"">&#xe64b;</span>&nbsp;&nbsp;'+e),_.show()}function T(){U.hide(),_.hide()}function N(t){F.prop("disabled",t),e(P.find("input")[0]).prop("disabled",t)}function C(){D.css({position:"",left:"",top:""}),P.css("margin","")}function k(){I.show();if(!s.IsRtlContentDirection){var e=P.width();P.width(e+60)}}function L(t,r,i){var a,h;r||i?(a=r,h=i):(a=D.width(),h=D.height()),C();if(a<c&&h<c){var v=c/2-a/2;M.css("width",c).css("height",c),R.css("width",c-20),D.css({position:"relative",left:s.IsRtlContentDirection?a/2-c/2:c/2-a/2,top:c/2-h/2})}else M.css("width",a).css("height",h),a<c?(R.css("width",c-20),D.css({position:"relative",left:s.IsRtlContentDirection?a/2-c/2:c/2-a/2,top:""})):R.css("width",a-20);P.css("bottom",10).css("left",10).css("margin",""),P.find("button").first().text(o.getLocalizedString("Change")),t&&D.css("opacity","0.5"),D.fadeIn(200),P.show(),I.hide(),P.find("input")[0].style.setProperty("width",P.find("button").first().width()+12+"px","important"),N(!0),!l.isOldIe&&t?(U.hide(),R.show(),p=n.create(R),A=e("<div />").addClass("cancel-button").css("left",R.width()-20),A.html('<span class="vci-font-icon" style="color: #999;">&#xe62c;</span>'),A.click(function(){g&&(m=!0,f=!1,u={},o.completionStatusChanged(),d.abort())}),R.append(A),p.init(),p.setLabel(o.getLocalizedString("Uploading"))):R.show()}var i,p,d,m,g,y=l.mergeSettings(t),b=l.buildAssetManagerUrl(s.AssetManagerConfig),w=l.getFormData(y),A,O=e("<div />").addClass("vc-respondent-upload"),M=e("<div />").addClass("placeholder"),_=e("<div />").addClass("error-message"),D=e("<img />").addClass("preview-image").attr("alt",o.getLocalizedString("PreviewImg")),P=e("<div/>").addClass("upload-btn-container"),H=e("<div />").addClass("browse-container"),B=e("<div />").addClass("delete-container"),j=o.getLocalizedString("ChoosePicture"),F=e("<button>"+j+"</button>").attr("type","button").addClass("vci-button answer-font-family"),I=e('<button><span class="vci-font-icon">&#xe662;</span></button>').addClass("vci-button delete").attr("aria-label",o.getLocalizedString("Delete")),q=e("<input />").prop("type","file").prop("name","files[]").prop("id","vci-am-upload-file").prop("tabindex","-1").attr("title",j);q.attr("accept","image/*"),F.keyup(function(t){if(t.keyCode===13||t.keyCode===32)t.preventDefault(),e(P.find("input")[0]).click()}),H.append(F).append(q),B.append(I),P.append(H).append(B),I.hide(),I.click(function(e){e.preventDefault(),l.deleteImage(u.filename),u={},D.attr("src",""),I.hide(),o.completionStatusChanged(),v()});var R=e("<div />").addClass("vc-progress-bar"),U=e("<div />").addClass("status-message answer-font-family");R.append(U),U.hide(),_.hide();var z=function(e){f=!1;var t=e.errorThrown?e.errorThrown:e.statusText;if(t==="abort")p.destroy(),A.remove(),S(o.getLocalizedString("CancelledUpload")),N(!1);else{var n=l.validateServerResult(e);n.isValid||(p.destroy(),A.remove(),S(n.message),D.attr("src",""))}},W={add:function(t){f=!0,g=!1,T();var n=t.files[t.files.length-1],r=n.name.split(".").pop().toLowerCase(),i=l.validateExtension(r,y.validExtensions),s=l.validateFileSize(n.size,y.maxFileUploadSizeInBytes);if(!i.isValid){!e.isEmptyObject(u)||m?S(i.message):x(i.message);return}if(!s.isValid){!e.isEmptyObject(u)||m?S(s.message):x(s.message);return}if(window.FileReader!==undefined){var a=new FileReader;a.onload=function(){P.hide(),D.hide(),D.attr("src",a.result),setTimeout(function(){L(!0),l.isOldIe||q.attr("disabled","disabled")},l.validateFileSize(n.size,15728640).isValid?300:800)},a.readAsDataURL(t.files[0])}else D.attr("src",""),P.hide(),M.spin(l.spinnerOptions);setTimeout(function(){m=!1,d=t.submit(),g=!0},300),o.completionStatusChanged()},fail:function(e){z(e)},error:function(e){z(e)},done:function(e){f=!1,l.deleteImage(u.filename),u=e.result;var t=l.validateServerResult(e);if(!t.isValid){S(t.message);return}if(l.isOldIe){var n=l.getImageUrl(s.AssetManagerConfig,u.contentUrl);M.spin(!1),D.attr("src",n),L(!0,u.tags.width,u.tags.height),D.css("opacity","1"),E(o.getLocalizedString("UploadComplete")),k()}else D.css("opacity","1"),p.setValue(100),setTimeout(function(){k(),p.destroy(),A.remove(),E(o.getLocalizedString("UploadComplete"))},250);N(!1),o.completionStatusChanged()}};r.create(q,y,b,l.isOldIe,W),q.bind("fileuploadprogress",function(e,t){var n=Math.round(t.loaded/t.total*100);p&&(n===100?(p.setValue(100),A.remove()):p.setValue(n),n>40&&n<70?p.setLabel(o.getLocalizedString("AlmostThere")):n>90&&(p.setLabel(o.getLocalizedString("FinishingUp")),A.remove()))});if(l.isOldIe){var X=y.iFrameTransportResultPath+"?%s";q.fileupload("option","redirect",X)}return h={success:function(e){var t=l.getImageUrl(s.AssetManagerConfig,e.contentUri);D.hide(),D.one("load",function(){u=e,O.spin(!1),L(!1),N(!1),k(),E(o.getLocalizedString("UploadComplete"))}),D.attr("src",t)},error:function(e){u={},O.spin(!1),v(),o.completionStatusChanged()}},u=l.load(o.questionDefinition.ObjectId),l.setSelected(),M.append(D),M.append(P),M.append(_),O.append(M),O.append(R),a=O,O}var u,a,f=!1,l=i.create(o),c=300,h;return{createView:g,addedToPage:m,isComplete:p,save:d}}return{create:o}}),define("plugins/ExtendedQuestions/RespondentUploadPlugin/Scripts/main",["pluginsShared/AssetUploader/assetUploader.desktop","constants","data","event!aboutToValidate"],function(e,t,n,r){var i=function(e){return e.RespondingPlugin==="RespondentUploadPlugin"},s="vc-sparq2-survey",o="vc-sparq2-question",u="vc-sparq2-response",a=function(e,t){return"urn:"+e+":"+t},f=function(i){function f(){h.addedToPage()}var l=i.questionDefinition,c={validExtensions:["image"],source:"RespondentUploadPlugin",tags:{studyId:a(s,l.StudyId),stepId:a(o,l.ObjectId),responseId:a(u,n.currentResponseId()),questionName:l.Name,isTest:t.Testing}},h=e.create(c,i);return r.subscribe(function(){h.save()}),{createView:h.createView,isComplete:h.isComplete,addedToPage:f,getObjectId:function(){return l.ObjectId}}};return{create:f,shouldHandleQuestion:i}}),define("pluginsShared/Divider/divider",["constants","jQueryFramework","utils"],function(e,t,n){var r=function(e){return e.RespondingPlugin==="DividerPlugin"},i=function(r){var i=r.questionDefinition,s=function(){return!0};return{isComplete:s,createView:function(){var r=t("<div/>").addClass("ui divider survey-page-divider").attr({id:"divider_"+i.ObjectId,role:"separator"});return!e.IsMobile&&n.isFeatureToggleEnabled("Toggles+Q3SurveyRespondingUXImprovements")&&r.addClass("survey-page-divider-no-margin"),r},getObjectId:function(){return i.ObjectId}}};return{create:i,shouldHandleQuestion:r}}),define("plugins/ExtendedQuestions/DividerPlugin/Scripts/main",["pluginsShared/Divider/divider"],function(e){var t=function(t){return e.create(t)};return{create:t,shouldHandleQuestion:e.shouldHandleQuestion}}),define("hbs!plugins/ExtendedQuestions/NpsPlugin/Scripts/nps",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\r\n			<button type="button" class="nps-answer" data-object-id="'+a((r=e.ObjectId,typeof r===u?r.apply(e):r))+'">'+a((r=e.Html,typeof r===u?r.apply(e):r))+"</button>\r\n		",n}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='﻿<div class="nps-container">\r\n	<div class="nps-answer-container">\r\n		',o=n.each.call(t,t.answers,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\r\n		<div class="nps-label-container">\r\n			<div class="npsLabel">',(o=n.lowestValue)?o=o.call(t,{hash:{},data:i}):(o=t.lowestValue,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+='</div>\r\n			<div class="npsLabel">',(o=n.highestValue)?o=o.call(t,{hash:{},data:i}):(o=t.highestValue,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+="</div>\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n",s})}),define("hbs!plugins/ExtendedQuestions/NpsPlugin/Scripts/npsOpenEnd",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){return'\r\n			<span class="questionRequiredStar questionRequiredStarAlignment" style="display:block">*</span>\r\n		'}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<div class="nps-openend-container">\r\n	<div class="npsOpenEndLabelContainer">\r\n		',o=n["if"].call(t,t.OpenEndRequired,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\r\n		<label class="visioncritical-questiontext nps-followup-question-label" for="',(o=n.TaId)?o=o.call(t,{hash:{},data:i}):(o=t.TaId,o=typeof o===a?o.apply(t):o),s+=f(o)+'"></label>\r\n	</div>\r\n	<div class="textareaplaceholder">\r\n		<textarea id="',(o=n.TaId)?o=o.call(t,{hash:{},data:i}):(o=t.TaId,o=typeof o===a?o.apply(t):o),s+=f(o)+'" class="textanswer answer-font-color novalidation" aria-label="',(o=n.AriaLabel)?o=o.call(t,{hash:{},data:i}):(o=t.AriaLabel,o=typeof o===a?o.apply(t):o),s+=f(o)+'" maxlength="',(o=n.MaxLength)?o=o.call(t,{hash:{},data:i}):(o=t.MaxLength,o=typeof o===a?o.apply(t):o),s+=f(o)+'" rows="',(o=n.TextAreaRowsAttr)?o=o.call(t,{hash:{},data:i}):(o=t.TextAreaRowsAttr,o=typeof o===a?o.apply(t):o),s+=f(o)+'" aria-describedby="',(o=n.AriaDescribedByAttr)?o=o.call(t,{hash:{},data:i}):(o=t.AriaDescribedByAttr,o=typeof o===a?o.apply(t):o),s+=f(o)+'" placeholder="',(o=n.Placeholder)?o=o.call(t,{hash:{},data:i}):(o=t.Placeholder,o=typeof o===a?o.apply(t):o),s+=f(o)+'"></textarea>\r\n		<div class="textanswermessage" id="lengthmessage_',(o=n.ObjectId)?o=o.call(t,{hash:{},data:i}):(o=t.ObjectId,o=typeof o===a?o.apply(t):o),s+=f(o)+'"></div>\r\n	</div>\r\n	<div class="textAnswerErrorText" id="error_',(o=n.ObjectId)?o=o.call(t,{hash:{},data:i}):(o=t.ObjectId,o=typeof o===a?o.apply(t):o),s+=f(o)+'"></div>\r\n</div>',s})}),define("plugins/ExtendedQuestions/NpsPlugin/Scripts/nps",["jQueryFramework","hbs!./nps","hbs!./npsOpenEnd","utils","event!aboutToSubmit","constants"],function(e,t,n,r,i,s){var o={name:"nps",value:null,init:function(n){var r=this;this.pluginHost=n,this.question=n.questionDefinition,this.minLength=0,this.maxLength=300,r.addAnswerCollection(this.question),r.setNpsLabels(this.question),this.question.Required&&e("#"+this.question.ObjectId).find(".questionheader").append(e("<span>*</span>").addClass("questionRequiredStar").addClass("questionRequiredStarAlignment").css("display","block")),this.$npsContainer=e(t({answers:this.question.AnswerCollection,lowestValue:this.lowCustomLabel,highestValue:this.highCustomLabel})),this.$npsAnswers=this.$npsContainer.find(".nps-answer");var s=this.question.AnswerCollection[0];this.$npsContainer.find("[data-object-id="+s.ObjectId+"]").addClass("first");var o=this.question.AnswerCollection[10];return this.$npsContainer.find("[data-object-id="+o.ObjectId+"]").addClass("last"),this.$npsAnswers.on("click",function(t){t.stopPropagation(),e(this).blur();var n=e(t.target).data("object-id"),i=r.question.AnswerCollection[n];r.setAnswer(i)}),this.question.EnableOpenEnd&&(this.$npsOpenEndContainer=this.createOpenEnd(),this.$openEnd=this.$npsOpenEndContainer.find("textarea"),this.$lengthMessage=this.$npsOpenEndContainer.find(".textanswermessage"),this.$validationMessage=this.$npsOpenEndContainer.find("textAnswerErrorText"),this.$openEnd.change(function(e){event.stopPropagation(),r.$openEnd.trigger("nps:changed")}),this.$openEnd.keyup(function(e){event.stopPropagation(),r.$openEnd.trigger("nps:changed")})),i.subscribe(function(){this.$openEnd&&this.$openEnd.attr("disabled","disabled")}),this},ui:function(){return this.$npsContainer},addAnswerCollection:function(e){var t=[];for(var n=0;n<=10;n++){var r={Html:n.toString(),ShowHtmlToRespondent:!0,CustomAnswerProperties:{VcSharedImage:"",OffScale:"false"},ObjectId:n.toString()};t.push(r)}e.AnswerCollection=t},setNpsLabels:function(e){e.EnableCustomLabels?(this.lowCustomLabel=e.LowCustomLabel,this.highCustomLabel=e.HighCustomLabel):(this.lowCustomLabel=this.pluginHost.getLocalizedString("LowDefaultLabel"),this.highCustomLabel=this.pluginHost.getLocalizedString("HighDefaultLabel"))},setAnswer:function(e,t){var n=e.ObjectId,i=this.value;if(n==i)return;i!=null&&this.$npsContainer.find("[data-object-id="+i+"]").removeClass("nps-selected");var s=this.$npsContainer.find("[data-object-id="+n+"]");s.addClass("nps-selected"),this.value=n,this.question.EnableOpenEnd&&(i==null&&this.$npsContainer.append(this.$npsOpenEndContainer),this.setOpenEndLabel(),this.$openEnd.focus(),t&&this.$openEnd.val(r.htmlDecodeString(t))),s.trigger("nps:changed")},createOpenEnd:function(){var t=this.createOpenEndAnswer(),i=s.TextAreaPrefix+t.ObjectId,o=this.pluginHost.getLocalizedString("TextFieldText"),u=this.pluginHost.getLocalizedString("InfoText").replace("{0}",this.minLength).replace("{1}",this.maxLength),a=o+". "+this.question.IsOpenEndRequired+". "+u,f=r.formatString("error_{0} message_{0}",[t.ObjectId,t.ObjectId]),l=this.pluginHost.getLocalizedString("NoValidationPlaceholder");return e(n({OpenEndRequired:this.question.IsOpenEndRequired,TaId:i,AriaLabel:a,MaxLength:this.maxLength,ObjectId:t.ObjectId,TextAreaRowsAttr:t.Height,AriaDescribedByAttr:f,Placeholder:l}))},createOpenEndAnswer:function(){var e={DisplayTextAnswer:!0,Exclusive:!0,ExtensionData:{},Height:4,Html:"",IsText:!0,MaximumTextLength:300,MinimumTextLength:0,Name:"",ObjectId:"00000000-0000-0000-0000-000000000000",OverrideFlow:!1,Selected:!1,ShowHtmlToRespondent:!0,TextValidationType:0,TextValue:null,UnusedExtensions:[],ValidationObject:{Regex:"",ErrorText:"",ShowMinMaxCount:!0},Width:0};return e},setOpenEndLabel:function(){this.question.UseOpenEndGeneralLabel?this.openEndLabel=this.question.OpenEndGeneralLabel:(this.value>=0&&this.value<=6&&(this.openEndLabel=this.question.OpenEndDetractorLabel),this.value>=7&&this.value<=8&&(this.openEndLabel=this.question.OpenEndPassiveLabel),this.value>=9&&this.value<=10&&(this.openEndLabel=this.question.OpenEndPromoterLabel));var t=e(".nps-followup-question-label").html();this.openEndLabel&&this.openEndLabel.toString()!==t&&(t&&e(".nps-followup-question-label").fadeOut(0,function(){e(".nps-followup-question-label").fadeIn(100)}),this.$npsContainer.find(".nps-followup-question-label").html(this.openEndLabel))},updateCharacterCount:function(){if(!this.question.EnableOpenEnd)return;var e=this.$openEnd.val().length,t=this.maxLength-e;t.toString()!==this.$lengthMessage.html()&&this.$lengthMessage.html(t)},validateOpenEnd:function(){return this.question.EnableOpenEnd?!this.question.IsOpenEndRequired||this.$openEnd.val().length!=0:!0},addedToPage:function(){}};return function(){return e.extend({},o)}}),define("plugins/ExtendedQuestions/NpsPlugin/Scripts/main",["jQueryFramework","./nps","utils"],function(e,t,n){var r=function(e){return e.RespondingPlugin==="NpsPlugin"},i=function(r){var i=new t,s=r.questionDefinition,o=function(){i.updateCharacterCount();var e=r.dataStore.getAnswerJson();return s.Required?!!e.score&&i.validateOpenEnd():e.score?i.validateOpenEnd():!0},u=function(){var t=function(e){var t=r.questionDefinition.EnableOpenEnd?i.$openEnd.val():"",s={score:i.value,openEnd:n.htmlEncodeString(t)};r.dataStore.setAnswerJson(s),r.completionStatusChanged()},s="#"+r.questionDefinition.ObjectId;e(s).bind("nps:changed",t);var o=function(){var e=r.dataStore.getAnswerJson();if(e.score){var t=r.questionDefinition.AnswerCollection[parseInt(e.score)];i.setAnswer(t,e.openEnd)}};return i.init(r),o(),i.ui()},a=function(){i.addedToPage&&i.addedToPage()};return{isComplete:o,createView:u,getObjectId:function(){return s.ObjectId},addedToPage:a}};return{create:i,shouldHandleQuestion:r}}),define("plugins/ExtendedQuestions/MaxDiffPlugin/Scripts/maxDiff",["jQueryFramework"],function(e){var t={name:"maxDiff",init:function(e,t){return this.uiHelper=e,this.state=t,e.update(t),this},ui:function(){return this.uiHelper.$maxDiffContainer},addedToPage:function(){this.uiHelper.updateSetCss()}};return function(){return e.extend({},t)}}),define("plugins/ExtendedQuestions/MaxDiffPlugin/Scripts/maxDiffCommon",["jQueryFramework"],function(e){var t=function(e,t){const n=e.reduce(function(e,t){return e[t.ObjectId]=t,e},{}),r=[];for(var i=0;i<t.length;i++){const s=t[i],o=[];for(var u=0;u<s.length;u++)o[u]=n[s[u].Id];r[i]=o}return r},n=function(e){if(!e.questionDefinition.Required)return!0;var t=e.dataStore.getAnswerJson();return t&&t.maxDiff?t.maxDiff.completed:!1},r=function(e){return e.RespondingPlugin==="MaxDiffPlugin"},i=function(e){var t=e.dataStore.getAnswerJson();return t.maxDiff&&t.maxDiff.sets?t.maxDiff.sets:null},s=function(e,t){var n=!0;for(var r=0;r<t.state.sets.length;r++)if(!t.state.isStepCompleted(r)){n=!1;break}var i={maxDiff:{completed:n,edition:"1.0",sets:t.state.sets}};e.dataStore.setAnswerJson(i),e.completionStatusChanged()},o=function(t,n,r,i,o){return e(t).bind("maxDiff:changed",function(e){s(n,r)}),r.init(i,o),r.ui()},u=function(e){return e.questionDefinition.LeastPreferred?e.questionDefinition.LeastPreferred:e.getLocalizedString("LeastLabel")},a=function(e){return e.questionDefinition.MostPreferred?e.questionDefinition.MostPreferred:e.getLocalizedString("MostLabel")};return{prepareSets:t,isComplete:n,shouldHandleQuestion:r,createView:o,getSets:i,getMostLabel:a,getLeastLabel:u,RankValues:{Least:"Least",Most:"Most"}}}),define("hbs!plugins/ExtendedQuestions/MaxDiffPlugin/Scripts/templates/maxDiff",["handlebars"],function(e){return e.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression;s+='﻿<div class="maxdiff-wrapper">\r\n	<div class="maxdiff-header-container">\r\n        <div class="maxdiff-nav"></div>\r\n        <div class="maxdiff-header-content">\r\n            <div id="maxdiffLeastLabel" class="maxdiff-button-label">',(o=n.leastPreferred)?o=o.call(t,{hash:{},data:i}):(o=t.leastPreferred,o=typeof o===a?o.apply(t):o);if(o||o===0)s+=o;s+='</div>\r\n            <div id="maxdiffAttributeLabel" class="maxdiff-attribute">',(o=n.attributeLabel)?o=o.call(t,{hash:{},data:i}):(o=t.attributeLabel,o=typeof o===a?o.apply(t):o);if(o||o===0)s+=o;s+='</div>\r\n            <div id="maxdiffMostLabel" class="maxdiff-button-label">',(o=n.mostPreferred)?o=o.call(t,{hash:{},data:i}):(o=t.mostPreferred,o=typeof o===a?o.apply(t):o);if(o||o===0)s+=o;s+='</div>\r\n        </div>\r\n        <div class="maxdiff-nav"></div>\r\n    </div>\r\n    <div class="maxdiff-content-container">\r\n        <div class="maxdiff-nav prev">\r\n            <div id="btnMaxDiffPrev" class="nav-button-left" role="button" aria-label="',(o=n.prev)?o=o.call(t,{hash:{},data:i}):(o=t.prev,o=typeof o===a?o.apply(t):o),s+=f(o)+'" tabindex="0">\r\n                <span class="vci-font-icon back" aria-label="back icon" ></span>\r\n            </div>\r\n        </div>\r\n	    <div class="maxdiffset-container"></div>\r\n	    <div class="maxdiff-nav next">\r\n            <div id="btnMaxDiffNext" class="nav-button-right" role="button" aria-label="',(o=n.next)?o=o.call(t,{hash:{},data:i}):(o=t.next,o=typeof o===a?o.apply(t):o),s+=f(o)+'" tabindex="0">\r\n                <span class="vci-font-icon forward" aria-label="forward icon" ></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="maxdiff-progress-hint-container">\r\n        <div class="visioncritical-questiontext">\r\n            <label>'+f((o=t.setLabel,typeof o===a?o.apply(t):o))+'</label>\r\n            <label id="lblProgress"></label>\r\n        </div>\r\n        <div class="maxdiff-progress-bar" >\r\n            <div class="selected"></div>\r\n        </div>\r\n        <div id="maxdiff-hint">\r\n            <div><label id="lblHint" class="questionErrorMsg">',(u=n.hintMessage)?u=u.call(t,{hash:{},data:i}):(u=t.hintMessage,u=typeof u===a?u.apply(t):u);if(u||u===0)s+=u;return s+="</label></div>\r\n        </div>\r\n    </div>\r\n</div>",s})}),define("hbs!plugins/ExtendedQuestions/MaxDiffPlugin/Scripts/templates/maxDiffSet",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t,n){var r="",i,s;r+='\r\n    <div role="listitem" class="maxdiff-attribute-container">\r\n        <div class="maxdiff-button-label">\r\n            <div class="maxdiff-button maxdiff-least" role="checkbox" aria-labelledby="maxdiffAttributeName-'+a((i=n.setId,typeof i===u?i.apply(e):i))+"-"+a((i=t.index,typeof i===u?i.apply(e):i))+' maxdiffLeastLabel" aria-checked="false" tabindex="0" data-object-id="'+a((i=e.ObjectId,typeof i===u?i.apply(e):i))+'">\r\n                <div class="selected-icon"></div>\r\n            </div>\r\n        </div>\r\n        <div id="maxdiffAttributeName-'+a((i=n.setId,typeof i===u?i.apply(e):i))+"-"+a((i=t.index,typeof i===u?i.apply(e):i))+'" class="maxdiff-attribute">',s=(i=e.Html,typeof i===u?i.apply(e):i);if(s||s===0)r+=s;return r+='</div>\r\n        <div class="maxdiff-button-label">\r\n            <div class="maxdiff-button maxdiff-most" role="checkbox" aria-labelledby="maxdiffAttributeName-'+a((i=n.setId,typeof i===u?i.apply(e):i))+"-"+a((i=t.index,typeof i===u?i.apply(e):i))+' maxdiffMostLabel" aria-checked="false" tabindex="0" data-object-id="'+a((i=e.ObjectId,typeof i===u?i.apply(e):i))+'">\r\n                <div class="selected-icon"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    ',r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div id="set-',(o=n.setId)?o=o.call(t,{hash:{},data:i}):(o=t.setId,o=typeof o===u?o.apply(t):o),s+=a(o)+'" class="maxdiff-set" role="list" aria-labelledby="maxdiffAttributeLabel">\r\n    ',o=n.each.call(t,t.attributes,{hash:{},inverse:f.noop,fn:f.programWithDepth(l,i,t),data:i});if(o||o===0)s+=o;return s+="\r\n</div>",s})}),define("pluginsShared/Carousel/js/carousel",["jQueryFramework","constants"],function(e,t){function n(n,r){var i=n.find(r),s=n.find(r).children(),o=!1;i.addClass("carousel");var u=e("<div class='carousel-sets'></div>");u.append(s),i.children().empty(),i.append(u);var a=function(){return o},f=function(n,r){if(o)return;var u=t.IsRtlContentDirection?"right":"left";s.removeClass("active-set"),e(s[n]).addClass("active-set");var a=r&&r.slideWidth?r.slideWidth:i.width(),f=-(n*a)+"px";if(!s.css(u)||r&&typeof r.showAnimation!="undefined"&&!r.showAnimation){s.css(u,f);return}var l={};l[u]=f,o=!0,s.animate(l,"swing",function(){o=!1})},l=function(){var t=0;s.each(function(n,r){var i=e(r).height();i>t&&(t=i)}),s.css("min-height",t)};return{navigate:f,isMoving:a,refreshHeight:l}}return{init:n}}),define("plugins/ExtendedQuestions/MaxDiffPlugin/Scripts/main",["./maxDiff","./maxDiffCommon","hbs!./templates/maxDiff","hbs!./templates/maxDiffSet","pluginsShared/Carousel/js/carousel"],function(e,t,n,r,i){function s(e){var s=$(n(e.labels)),o=s.find(".maxdiffset-container");e.sets.forEach(function(t,n){var i=$(r({setId:n,attributes:e.sets[n]}));o.append(i)});var u=i.init(s,".maxdiffset-container"),a=s.find("#btnMaxDiffPrev"),f=s.find("#btnMaxDiffNext"),l=s.find(".maxdiff-button"),c=s.find("#lblProgress"),h=s.find(".maxdiff-progress-bar .selected");this.updateSetCss=function(){u.refreshHeight()},this.$maxDiffContainer=s;var p=function(e,t){e.toggle(t)},d=function(e){f.toggleClass("disabled",!e)},v=function(e,t){e&&!t.setIndChanged&&f.trigger("click"),!e&&t.setIndChanged&&(t.setIndChanged=!1)},m=function(e){u.navigate(e,{slideWidth:700})},g=function(e,t,n){var r=n?"maxdiff-least":"maxdiff-most",i="#set-"+e+" [data-object-id="+t+"]."+r;s.find(i).addClass("selected").attr("aria-checked","true")},y=function(){l.removeClass("selected").attr("aria-checked","false")},b=function(e,t){var n=$(e.target).data("object-id");if(n){var r=$(e.target).hasClass("maxdiff-least");t(n,r)}},w=function(e,t){var n=e+1;c.text(n+"/"+t);var r=n*100/t;h.width(r+"%")},E=function(){return u.isMoving()},S=function(e,t){e.which===13&&(e.preventDefault(),E()||t(e))},x=function(e,t){e.on("click",function(e){E()||t(e)}),e.keypress(function(e){S(e,t)})};this.onPrev=function(e){x(a,e)},this.onNext=function(e){x(f,e)},this.onAnswerSelected=function(e){l.keypress(function(t){S(t,function(){b(t,e)})}),l.on("click",function(t){t.stopPropagation(),b(t,e)})};var T=function(e){y();for(var n=0;n<e.sets.length;n++)for(var r=0;r<e.sets[n].length;r++)e.sets[n][r].Rank===t.RankValues.Least&&g(n,e.sets[n][r].Id,!0),e.sets[n][r].Rank===t.RankValues.Most&&g(n,e.sets[n][r].Id,!1)};this.update=function(e){T(e),m(e.currentSetInd),p(f,e.showNext()),p(a,e.showPrev()),d(e.isStepCompleted(e.currentSetInd)),w(e.currentSetInd,e.sets.length)},this.updateAnswer=function(e){T(e);var t=e.isStepCompleted(e.currentSetInd);d(t),v(t,e)},this.showRequired=function(e){$("#"+e).find(".questionheader").append($("<span>*</span>").addClass("questionRequiredStar").addClass("questionRequiredStarAlignment").css("display","block"))}}function o(e,n){this.sets=n,this.currentSetInd=0,this.setIndChanged=!1,this.required=e;var r=this;this.showPrev=function(){return this.currentSetInd!==0},this.showNext=function(){return this.currentSetInd!==this.sets.length-1},this.selectAnswer=function(e,n){var i=n?t.RankValues.Least:t.RankValues.Most;for(var s=0;s<r.sets[r.currentSetInd].length;s++)r.sets[r.currentSetInd][s].Id===e?r.sets[r.currentSetInd][s].Rank=i:r.sets[r.currentSetInd][s].Rank===i&&(r.sets[r.currentSetInd][s].Rank="")},this.isStepCompleted=function(e){var n=!1,r=!1;for(var i=0;i<this.sets[e].length;i++)this.sets[e][i].Rank===t.RankValues.Least&&(n=!0),this.sets[e][i].Rank===t.RankValues.Most&&(r=!0);return r&&n},this.isStepValid=function(e){return this.required?this.isStepCompleted(e):!0}}var u=function(n){var r=new e,i=function(e,n){var r={sets:n,labels:{leastPreferred:t.getLeastLabel(e),mostPreferred:t.getMostLabel(e),attributeLabel:e.questionDefinition.AttributeLabel,setLabel:e.getLocalizedString("SetLabel"),prev:e.getLocalizedString("Prev"),next:e.getLocalizedString("Next"),hintMessage:e.getLocalizedString("HintMessage")}};return r},u=function(){return t.isComplete(n)},a=function(){var e="#"+n.questionDefinition.ObjectId;const u=t.getSets(n),a=t.prepareSets(n.questionDefinition.WorkflowStepCollection[0].AnswerCollection,u);var f=i(n,a),l=new o(n.questionDefinition.Required,u),c=new s(f);return n.questionDefinition.Required&&c.showRequired(n.questionDefinition.ObjectId),c.onNext(function(e){e.preventDefault(),l.currentSetInd!==l.sets.length-1&&(l.oldSetInd=l.currentSetInd,l.currentSetInd++,c.update(l))}),c.onPrev(function(e){e.preventDefault(),l.currentSetInd!==0&&(l.oldSetInd=l.currentSetInd,l.currentSetInd--,l.setIndChanged=!0,c.update(l))}),c.onAnswerSelected(function(e,t){l.selectAnswer(e,t),c.updateAnswer(l),$(event.target).trigger("maxDiff:changed")}),t.createView(e,n,r,c,l)},f=function(){r.addedToPage&&r.addedToPage()};return{isComplete:u,createView:a,getObjectId:function(){return n.questionDefinition.ObjectId},addedToPage:f}};return{create:u,shouldHandleQuestion:t.shouldHandleQuestion}}),define("plugins/ExtendedQuestions/ConjointPlugin/Scripts/conjoint",["jQueryFramework"],function(e){var t={name:"conjoint",init:function(e,t){return this.uiHelper=e,this.state=t,e.update(t),this},ui:function(){return this.uiHelper.$conjointContainer},addedToPage:function(){this.uiHelper.adjustCellSize()}};return function(){return e.extend({},t)}}),define("plugins/ExtendedQuestions/ConjointPlugin/Scripts/conjointCommon",["jQueryFramework"],function(e){var t=function(e){return e.RespondingPlugin==="ConjointPlugin"},n=function(t,n,r,i){const s=e.grep(t.choiceSets,function(e){return e.id===n})[0];if(s)if(r==="none")s.noneSelected=i;else{const o=e.grep(s.profiles,function(e){return e.id===r})[0];o&&(o.isSelected=i)}},r=function(e,t,r){var i=e.dataStore.getAnswerJson();r.forEach(function(e){e.profiles.forEach(function(t){n(i,e.id,t.id,t.selected)})}),i.complete=t,e.dataStore.setAnswerJson(i),e.completionStatusChanged()},i=function(t,n,i,s,o,u){return e(t).bind("conjoint:changed",function(){r(n,o.isCompleted(),u)}),i.init(s,o),i.ui()},s=function(t,n){return e.grep(t.questionDefinition.WorkflowStepCollection,function(e){return e.ObjectId===n})[0]},o=function(e,t){const n=s(e,t);return n?n.Html:""},u=function(e,t,n){return e[t]?JSON.parse(e[t]):n},a=function(t,n,r){const i=s(t,n);if(i){const o=e.grep(i.AnswerCollection,function(e){return e.ObjectId===r})[0],a=u(o.EqfProperties,"VcProperty.VcSharedImage",null),f=u(o.EqfProperties,"VcProperty.VcSharedDisplayText",!0);return o?{text:o.Html,image:a?a.Url:null,altText:a?a.AltText:null,displayText:f}:null}return null},f=function(e,t){var n=a(e,t.attribute,t.level);return{title:o(e,t.attribute),text:n.text,image:n.image,altText:n.altText,displayText:n.displayText}},l=function(e){return{id:"none",selected:e}},c=function(e,t){return{id:t.id,attributes:t.attributeLevels.map(function(t){return f(e,t)}),selected:t.isSelected}},h=function(e,t){var n=t.profiles.map(function(t){return c(e,t)});return e.questionDefinition.CustomQuestionProperties.IncludeNoneOption&&e.questionDefinition.CustomQuestionProperties.IncludeNoneOption.toLowerCase()==="true"&&n.push(l(t.noneSelected)),{id:t.id,profiles:n}},p=function(e){return e.dataStore.getAnswerJson().choiceSets.map(function(t){return h(e,t)})},d=function(e){return!e||e.length===0?null:e[0].profiles[0].attributes.map(function(e){return e.title})};return{shouldHandleQuestion:t,createView:i,prepareSets:p,getTitles:d}}),define("hbs!plugins/ExtendedQuestions/ConjointPlugin/Scripts/templates/conjoint",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function c(e,t,r){var i="",s,o;i+='\r\n			<div id="'+f((s=t.index,typeof s===a?s.apply(e):s))+'" class="conjoint-set" role="list">\r\n				',o=n.each.call(e,e.profiles,{hash:{},inverse:l.noop,fn:l.programWithDepth(h,t,r),data:t});if(o||o===0)i+=o;return i+="\r\n			</div>\r\n			",i}function h(e,t,r){var i="",s;i+="\r\n				",s=n["if"].call(e,e.attributes,{hash:{},inverse:l.programWithDepth(g,t,r),fn:l.program(3,p,t),data:t});if(s||s===0)i+=s;return i+="\r\n				",i}function p(e,t){var r="",i,s;r+='\r\n				<div class="conjoint-item">\r\n					<ul id="'+f((i=e.id,typeof i===a?i.apply(e):i))+'">\r\n						',s=n.each.call(e,e.attributes,{hash:{},inverse:l.noop,fn:l.program(4,d,t),data:t});if(s||s===0)r+=s;return r+='\r\n					</ul>\r\n					<div class="button-box">\r\n						<a tabindex="0" aria-label="forward icon" role="button" aria-labelledby="'+f((i=e.id,typeof i===a?i.apply(e):i))+'" class="select-button" data-object-id="'+f((i=e.id,typeof i===a?i.apply(e):i))+'"></a>\r\n					</div>\r\n				</div>\r\n				',r}function d(e,t){var r="",i,s;r+='\r\n						<li class="title">\r\n							<p>',s=(i=e.title,typeof i===a?i.apply(e):i);if(s||s===0)r+=s;r+="</p>\r\n						</li>\r\n						<li>\r\n							",s=n["if"].call(e,e.image,{hash:{},inverse:l.noop,fn:l.program(5,v,t),data:t});if(s||s===0)r+=s;r+='\r\n						</li>\r\n						<li class="value">\r\n							',s=n["if"].call(e,e.displayText,{hash:{},inverse:l.noop,fn:l.program(7,m,t),data:t});if(s||s===0)r+=s;return r+="\r\n						</li>\r\n						",r}function v(e,t){var n="",r;return n+='\r\n							<div class="pic">\r\n								<img src="'+f((r=e.image,typeof r===a?r.apply(e):r))+'" title="'+f((r=e.altText,typeof r===a?r.apply(e):r))+'" alt="'+f((r=e.altText,typeof r===a?r.apply(e):r))+'"/>\r\n							</div>\r\n							',n}function m(e,t){var n="",r,i;n+="\r\n							",i=(r=e.text,typeof r===a?r.apply(e):r);if(i||i===0)n+=i;return n+="\r\n							",n}function g(e,t,n){var r="",i,s;r+='\r\n				<div class="conjoint-item">\r\n					<div class="noneItem">\r\n						<div><b>',s=(i=(i=n.labels,i==null||i===!1?i:i.none),typeof i===a?i.apply(e):i);if(s||s===0)r+=s;return r+='</b></div>\r\n					</div>\r\n					<div class="button-box">\r\n						<a tabindex="0" class="select-button" role="button" aria-labelledby="'+f((i=e.id,typeof i===a?i.apply(e):i))+'" data-object-id="'+f((i=e.id,typeof i===a?i.apply(e):i))+'"></a>\r\n					</div>\r\n				</div>\r\n				',r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this;s+='﻿<div class="conjoint-wrapper">\r\n	<div class="conjoint-content-container">\r\n		<div class="conjoint-nav prev">\r\n			<div id="btnPrev" class="nav-button-left" role="button" aria-label="'+f((o=(o=t.labels,o==null||o===!1?o:o.prev),typeof o===a?o.apply(t):o))+'" tabindex="0">\r\n				<span class="vci-font-icon back"></span>\r\n			</div>\r\n		</div>\r\n		<div class="conjointset-container">\r\n			',u=n.each.call(t,t.sets,{hash:{},inverse:l.noop,fn:l.programWithDepth(c,i,t),data:i});if(u||u===0)s+=u;return s+='\r\n		</div>\r\n		<div class="conjoint-nav next">\r\n			<div id="btnNext" class="nav-button-right" role="button" tabindex="0" aria-label="'+f((o=(o=t.labels,o==null||o===!1?o:o.next),typeof o===a?o.apply(t):o))+'">\r\n				<span class="vci-font-icon forward"></span>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	<div class="conjoint-progress-hint-container">\r\n		<div class="visioncritical-questiontext">\r\n			<label>'+f((o=(o=t.labels,o==null||o===!1?o:o.setLabel),typeof o===a?o.apply(t):o))+'</label>\r\n			<label id="lblProgress"></label>\r\n		</div>\r\n		<div class="conjoint-progress-bar">\r\n			<div class="selected"></div>\r\n		</div>\r\n		<div id="conjoint-hint">\r\n			<div><label id="lblHint" class="questionErrorMsg">'+f((o=(o=t.labels,o==null||o===!1?o:o.hintMessage),typeof o===a?o.apply(t):o))+"</label></div>\r\n		</div>\r\n	</div>\r\n</div>",s})}),define("plugins/ExtendedQuestions/ConjointPlugin/Scripts/main",["./conjoint","./conjointCommon","hbs!./templates/conjoint","pluginsShared/Carousel/js/carousel"],function(e,t,n,r){function i(e,t){var i=$(n({sets:e.sets,labels:t}));this.$conjointContainer=i;var s=r.init(i,".conjointset-container"),o=i.find("#btnPrev"),u=i.find("#btnNext"),a=i.find(".select-button"),f=i.find(".conjoint-progress-bar .selected"),l=i.find("#lblProgress"),c=e.sets[0].profiles,h=c[c.length-1].id==="none",p=e.sets[0].profiles.length;this.updateSetCss=function(){s.refreshHeight()};var d=function(e,t){e.toggle(t)},v=function(e){u.toggleClass("disabled",!e)},m=function(e){a.removeAttr("tabindex");var t="#"+e+".conjoint-set a.select-button";i.find(t).attr("tabindex",0),s.navigate(e)},g=function(e,n){var r="#"+e+".conjoint-set a[data-object-id="+n+"]",s=i.find(r);s.addClass("selected"),s.text(t.selected)},y=function(){a.removeClass("selected"),a.text(t.select)},b=function(e,t){var n=$(e.target).data("object-id");n&&t(e,n)},w=function(e,t){var n=e+1;l.text(n+"/"+t);var r=n*100/t;f.width(r+"%")},E=function(){return s.isMoving()},S=function(e,t){e.which===13&&(e.preventDefault(),E()||t(e))},x=function(e,t){e.on("click",function(e){E()||t(e)}),e.keypress(function(e){S(e,t)})};this.onPrev=function(e){x(o,e)},this.onNext=function(e){x(u,e)},this.onSelected=function(e){a.keypress(function(t){S(t,function(){b(t,e)})}),a.on("click",function(t){t.stopPropagation(),b(t,e)})};var T=function(e){y(),e.sets.forEach(function(e,t){const n=e.profiles,r=$.grep(n,function(e){return e.selected})[0];r&&g(t,r.id)})},N=function(e){return parseInt(e.replace("px",""))},C=function(e){var t=getComputedStyle(i.find(".conjoint-item")[0]),n=N(t["margin-left"]),r=N(t["margin-right"]),s=N(t["border-left-width"]),o=e[0].offsetWidth;if(o){var u=o/p-n-r-2*s,a=i.find(".conjoint-item");return a.width(u),u}},k=function(e){var t=i.find(".noneItem b")[0],n=$(t).width(),r=(e-n)/2,s=i.find(".noneItem");$(s).css({"margin-left":r})},L=function(e){$(e).each(function(){var e=$(this),t=e.children();if(t&&t.length>0){var n=h?t.length-1:t.length,r=$(t[0]).find("li").length;for(var i=0;i<r;i++){var s=[],o=0;for(var u=0;u<n;u++){var a=$(t[u]).find("li")[i];s.push(a);var f=$(s[u]).height();f>o&&(o=f)}$(s).height(o)}}})},A=function(){var e=N(getComputedStyle(i.find(".pic")[0]).height),t=i.find(".conjoint-item li img");for(var n=0;n<t.length;n++)if($(t[n]).height()>0){var r=(e-$(t[n]).height())/2;$(t[n]).css("margin-top",r)}};this.adjustCellSize=function(){var e=i.find(".conjoint-set");if(e.length!==0){var t=C(e);t&&h&&k(t),L(e),i.find(".pic").length>0&&A()}},this.update=function(e){T(e),m(e.currentSetInd),d(u,e.showNext()),d(o,e.showPrev()),v(e.isStepCompleted(e.currentSetInd)),w(e.currentSetInd,e.sets.length)},this.showRequired=function(e){$("#"+e).find(".questionheader").append($("<span>*</span>").addClass("questionRequiredStar questionRequiredStarAlignment fltleft").css("display","block"))}}function s(e,t){this.sets=t,this.currentSetInd=0,this.required=e;var n=this;this.isLastSet=function(){return this.currentSetInd===this.sets.length-1},this.showPrev=function(){return this.currentSetInd!==0},this.showNext=function(){return!n.isLastSet()},this.setNextSet=function(){n.isLastSet()||n.currentSetInd++},this.selectAnswer=function(e){n.sets[n.currentSetInd].profiles.forEach(function(t){t.selected=t.id===e})},this.isStepCompleted=function(e){return this.sets[e].profiles.some(function(e){return e.selected})},this.isCompleted=function(){return!this.sets.some(function(e,t){return!n.isStepCompleted(t)})}}var o=function(n){var r=new e,o=function(){return!r.state.required||r.state.isCompleted()},u=function(){var e="#"+n.questionDefinition.ObjectId,o=t.prepareSets(n),u={setLabel:n.getLocalizedString("SetLabel"),prev:n.getLocalizedString("Prev"),next:n.getLocalizedString("Next"),hintMessage:n.getLocalizedString("HintMessage"),select:n.getLocalizedString("Select"),selected:n.getLocalizedString("Selected"),none:n.getLocalizedString("None")},a=new s(n.questionDefinition.Required,o),f=new i(a,u);return n.questionDefinition.Required&&f.showRequired(n.questionDefinition.ObjectId),f.onNext(function(e){e.preventDefault(),a.currentSetInd!==a.sets.length-1&&(a.currentSetInd++,f.update(a))}),f.onPrev(function(e){e.preventDefault(),a.currentSetInd!==0&&(a.currentSetInd--,f.update(a))}),f.onSelected(function(e,t){a.selectAnswer(t),a.setNextSet(),f.update(a),$(e.target).trigger("conjoint:changed")}),t.createView(e,n,r,f,a,a.sets)},a=function(){r.addedToPage&&r.addedToPage()};return{isComplete:o,createView:u,getObjectId:function(){return n.questionDefinition.ObjectId},addedToPage:a}};return{create:o,shouldHandleQuestion:t.shouldHandleQuestion}}),define("hbs!plugins/ExtendedQuestions/AppointmentBookingPlugin/Scripts/appointmentBooking",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\r\n	<div class="success-message"><span class="check-icon"></span>',(i=n.alreadyCompletedMessage)?i=i.call(e,{hash:{},data:t}):(i=e.alreadyCompletedMessage,i=typeof i===u?i.apply(e):i),r+=a(i)+"</div>\r\n	",r}function c(e,t){var r="",i;r+='\r\n	<div class="calendly-inline-widget" data-url=',(i=n.eventLink)?i=i.call(e,{hash:{},data:t}):(i=e.eventLink,i=typeof i===u?i.apply(e):i);if(i||i===0)r+=i;return r+='></div>\r\n	<script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js"></script>\r\n	',r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='﻿<div class="appointment-booking-container">\r\n	',o=n["if"].call(t,t.complete,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\r\n</div>",s})}),define("plugins/ExtendedQuestions/AppointmentBookingPlugin/Scripts/appointmentBooking",["jQueryFramework","hbs!./appointmentBooking","utils"],function(e,t,n){var r={name:"appointmentBooking",appendParams:function(e,t,n){const r=e.indexOf("?")>=0?"&":"?",i=RegExp("[?|&]"+t+"=");return i.test(e)?e:e+r+t+"="+n},init:function(n){this.pluginHost=n,this.question=n.questionDefinition,this.question.Required&&e("#"+this.question.ObjectId).find(".questionheader").append(e("<span>*</span>").addClass("questionRequiredStar").addClass("questionRequiredStarAlignment").css("display","block"));var r=this.question.EventLink;return this.question.MemberId&&(r=this.appendParams(r,"name",this.question.MemberFirstName+" "+this.question.MemberLastName),r=this.appendParams(r,"first_name",this.question.MemberFirstName),r=this.appendParams(r,"last_name",this.question.MemberLastName),r=this.appendParams(r,"email",this.question.MemberEmail),r=this.appendParams(r,"utm_content",this.question.MemberId)),this.$container=e(t({complete:!1,eventLink:encodeURI(r)})),this},ui:function(){return this.$container},setCompleteState:function(n){if(n===!0){var r=this.pluginHost.getLocalizedString("AlreadyCompletedMessage");this.$container=e(t({complete:!0,alreadyCompletedMessage:r}))}},addedToPage:function(){}};return function(){return e.extend({},r)}}),define("plugins/ExtendedQuestions/AppointmentBookingPlugin/Scripts/main",["./appointmentBooking"],function(e){var t=function(e){return e.RespondingPlugin==="AppointmentBookingPlugin"},n=function(t){var n=new e,r=t.questionDefinition,i=function(){if(r.Required){var e=t.dataStore.getAnswerJson();return e.complete===!0}return!0},s=function(){window.addEventListener("message",function(e){if(e.data.event==="calendly.event_scheduled"){var n={complete:!0};t.dataStore.setAnswerJson(n),t.completionStatusChanged()}});var e=function(){var e=t.dataStore.getAnswerJson();n.setCompleteState(e.complete)};return n.init(t),e(),n.ui()},o=function(){n.addedToPage&&n.addedToPage()};return{isComplete:i,createView:s,getObjectId:function(){return r.ObjectId},addedToPage:o}};return{create:n,shouldHandleQuestion:t}}),define("hbs!plugins/ExtendedQuestions/VideoFeedbackPlugin/Scripts/videoFeedback",["handlebars"],function(e){return e.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function";s+='﻿<div class="video-feedback-container">\r\n	<input type="hidden" id="vpm-projectId" value=',(o=n.projectId)?o=o.call(t,{hash:{},data:i}):(o=t.projectId,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+=' />\r\n	<input type="hidden" id="vpm-settings" value=',(o=n.settings)?o=o.call(t,{hash:{},data:i}):(o=t.settings,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+=' />\r\n	<input type="hidden" id="vpm-additionalData" value=',(o=n.additionalData)?o=o.call(t,{hash:{},data:i}):(o=t.additionalData,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+=' />\r\n	<input type="hidden" id="vpm-deployment" value=',(o=n.deployment)?o=o.call(t,{hash:{},data:i}):(o=t.deployment,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+=' />\r\n	<div class="vpm-capture-widget"></div>\r\n	<script>\r\n		var vpm_widget_config = {\r\n			project_id: $("#vpm-projectId").val(),\r\n			settings: JSON.parse(decodeURIComponent($("#vpm-settings").val())),\r\n			additional_data: JSON.parse(decodeURIComponent($("#vpm-additionalData").val()))\r\n		};\r\n		if ($("#vpm-deployment").val() !== "/") {\r\n			vpm_widget_config.deployment = $("#vpm-deployment").val();\r\n		}\r\n	</script>\r\n	<script type="text/javascript" src="https://capture.voxpopme.net/main.js"></script>\r\n</div>',s})}),define("hbs!plugins/ExtendedQuestions/VideoFeedbackPlugin/Scripts/loading",["handlebars"],function(e){return e.template(function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\r\n	<div class="success-message"><span class="check-icon"></span>',(i=n.alreadyCompletedMessage)?i=i.call(e,{hash:{},data:t}):(i=e.alreadyCompletedMessage,i=typeof i===u?i.apply(e):i),r+=a(i)+"</div>\r\n	",r}function c(e,t){var r="",i;r+="\r\n		",i=n["if"].call(e,e.errorMessage,{hash:{},inverse:f.program(6,p,t),fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\r\n	",r}function h(e,t){var r="",i;return r+='\r\n		<div class="content-container">\r\n			<div class="error-header">',(i=n.errorHeader)?i=i.call(e,{hash:{},data:t}):(i=e.errorHeader,i=typeof i===u?i.apply(e):i),r+=a(i)+'</div>\r\n			<div class="error-message">',(i=n.errorMessage)?i=i.call(e,{hash:{},data:t}):(i=e.errorMessage,i=typeof i===u?i.apply(e):i),r+=a(i)+"</div>\r\n		</div>\r\n		",r}function p(e,t){var r="",i;return r+='\r\n		<div class="content-container">\r\n			<img src=',(i=n.loadingImage)?i=i.call(e,{hash:{},data:t}):(i=e.loadingImage,i=typeof i===u?i.apply(e):i),r+=a(i)+' alt="Loading">\r\n		</div>\r\n		',r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='﻿<div class="video-feedback-container">\r\n	',o=n["if"].call(t,t.complete,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\r\n</div>",s})}),define("plugins/ExtendedQuestions/VideoFeedbackPlugin/Scripts/videoFeedback",["jQueryFramework","hbs!./videoFeedback","hbs!./loading","constants","utils"],function(e,t,n,r,i){var s={name:"videoFeedback",init:function(t){return this.pluginHost=t,this.question=t.questionDefinition,this.question.Required&&e("#"+this.question.ObjectId).find(".questionheader").append(e("<span>*</span>").addClass("questionRequiredStar").addClass("questionRequiredStarAlignment").css("display","block")),this.$container=e(n({complete:!1,loadingImage:r.EqfBaseUrl+"/Plugins/ExtendedQuestions/VideoFeedbackPlugin/images/loading.gif"})),this},initWidget:function(n,i){const s={survey_id:i.StudyId,response_id:e("#_responseId").val(),response_sequence_id:parseInt(e("#_responseSequenceId").val(),10)||0,question_id:i.ObjectId,question_name:i.Name,question_text:e(i.Html).text(),test_response:r.Testing==="true"};i.MemberId&&(s.first_name=i.MemberFirstName,s.last_name=i.MemberLastName,s.member_id=i.MemberId);const o={locale:this.convertLocale(i.UiLanguage),show_vpm_logo:!1,min_recording_time:i.MinimumResponseDuration,max_recording_time:i.MaximumResponseDuration};return this.$container=e(t({projectId:n,settings:encodeURIComponent(JSON.stringify(o)),additionalData:encodeURIComponent(JSON.stringify(s)),deployment:i.DeploymentPod})),e(".video-feedback-container").replaceWith(this.$container),this},showError:function(){const t=this.pluginHost.getLocalizedString("ErrorHeader"),r=this.pluginHost.getLocalizedString("ErrorMessage");this.$container=e(n({complete:!1,errorHeader:t,errorMessage:r})),e(".video-feedback-container").replaceWith(this.$container)},convertLocale:function(e){const t=e.replace("-","_");switch(t){case"es_MX":return"es_ES";case"en_AU":case"en_CA":return"en_US";case"fr_CA":return"fr_FR";case"pt_BR":return"pt_PT";case"ar_SA":return"ar_AE";default:return t}},ui:function(){return this.$container},setCompleteState:function(t){if(t===!0){const r=this.pluginHost.getLocalizedString("AlreadyCompletedMessage");this.$container=e(n({complete:!0,alreadyCompletedMessage:r}))}},disableNextButton:function(t){r.IsMobile?e(".nextButton").find("button").prop("disabled",t):e("#Next").prop("disabled",t)},addedToPage:function(){}};return function(){return e.extend({},s)}}),define("plugins/ExtendedQuestions/VideoFeedbackPlugin/Scripts/common",["jQueryFramework","constants"],function(e,t){var n=function(e){return e.RespondingPlugin===t.plugins.VideoFeedback},r=function(e,t,n){const r=e+t+n;var i=0,s,o;for(s=0;s<r.length;s++)o=r.charCodeAt(s),i=(i<<5)-i+o,i|=0;return i};const i=vcStep.WorkflowStepCollection.filter(function(e){return e.RespondingPlugin==="VideoFeedbackPlugin"})[0],s=e("#_responseId").val(),o=window.vcStep.StudyId,u=i.ObjectId,a=r(s,o,u);var f=function(){const n=new URL(window.location.protocol+e("#SurveyForm").attr("action"));n.pathname+="/SaveVideoFeedback";const r=e("#SurveyForm").serializeArray().filter(function(e){return![t.DataPointPrefix,t.EventMapId].some(function(t){return e.name.startsWith(t)})||e.name.includes(i.ObjectId)}).map(function(e){return e.name+"="+e.value}).join("&");e.ajax({url:n.toString(),type:"post",headers:{token:a,surveyId:o,stepId:u},data:r})},l=function(e,t){if(t.Required){var n=e.dataStore.getAnswerJson();return n.complete===!0}return!0},c=0,h=3e3,p=window.location.protocol+"//"+window.location.hostname+"/s/study/"+o+"/videofeedback/status",d=function(){c+=1;if(c>=10){window.postMessage({event:"question_not_ready"},"*");return}e.ajax({url:p,headers:{token:a,responseId:s,stepId:u},success:function(e){e.Status==="Active"?window.postMessage({event:"question_ready",projectIdentifier:e.ProjectIdentifier},"*"):setTimeout(d,h)},error:function(){setTimeout(d,h)}})},v=function(e,t){window.addEventListener("message",function(n){if(n.data.event==="publishing")t.disableNextButton(!0);else if(n.data.event==="response_complete"){var r={complete:!0};e.dataStore.setAnswerJson(r),e.completionStatusChanged(),t.disableNextButton(!1),f()}else n.data.event==="question_ready"?t.initWidget(n.data.projectIdentifier,e.questionDefinition):n.data.event==="question_not_ready"&&t.showError()});var n=function(){var n=e.dataStore.getAnswerJson();n.complete?t.setCompleteState(!0):d()};return t.init(e),n(),t.ui()},m=function(e){return e.ObjectId};return{shouldHandleQuestion:n,isComplete:l,createView:v,getObjectId:m}}),define("plugins/ExtendedQuestions/VideoFeedbackPlugin/Scripts/main",["./videoFeedback","./common"],function(e,t){var n=function(n){var r=new e,i=n.questionDefinition,s=function(){return t.isComplete(n,i)},o=function(){return t.createView(n,r)},u=function(){r.addedToPage&&r.addedToPage()},a=function(){return t.getObjectId(i)};return{isComplete:s,createView:o,getObjectId:a,addedToPage:u}};return{create:n,shouldHandleQuestion:t.shouldHandleQuestion}}),define("hbs!plugins/ExtendedQuestions/HighlighterPlugin/Templates/highlighterDesktop",["handlebars"],function(e){return e.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers,i=i||{};var s="",o,u="function";s+='﻿<div class="visioncritical-highlighter">\r\n	<div data-template-element-id="highlighterToolbar" class="highlighter-toolbar">\r\n		<ul>\r\n			<li data-template-element-id="undoButton" class="undo">&#xe64c;</li>\r\n			<li data-template-element-id="clearButton" class="clear">&#xe617;</li>\r\n			<li data-template-element-id="infoButton" class="info">&#xe616;</li>\r\n		</ul>\r\n		<div data-template-element-id="highlighterToolbarFiller" class="highlighter-toolbar-filler"></div>\r\n	</div>   \r\n    <div data-template-element-id="highlighterContainer" class="highlighter-container">\r\n        <div data-template-element-id="highlighterEmptyImageErrorMessage" class="highlighter-errorMessage">',(o=n.highlighterEmptyImageErrorMessage)?o=o.call(t,{hash:{},data:i}):(o=t.highlighterEmptyImageErrorMessage,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;s+='</div>\r\n        <div data-template-element-id="highlighterImage" class="highlighter-image imagePlaceholder">\r\n            <div data-template-element-id="highlighter"></div>\r\n        </div>\r\n    </div>\r\n	\r\n    <div data-template-element-id="instructionPopup" class="highlighterInstructions answer-font-family">\r\n        <div class="highlighterInstructionText">',(o=n.instructionsText)?o=o.call(t,{hash:{},data:i}):(o=t.instructionsText,o=typeof o===u?o.apply(t):o);if(o||o===0)s+=o;return s+='</div>\r\n        <div data-template-element-id="raphaelContainer" class="raphael-container">\r\n            <div data-template-element-id="raphael" class="raphael-paper">\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>',s})}),function(e){var t="0.4.0",n="hasOwnProperty",r=/[\.\/]/,i="*",s=function(){},o=function(e,t){return e-t},u,a,f={n:{}},l=function(e,t){var n=f,r=a,i=Array.prototype.slice.call(arguments,2),s=l.listeners(e),c=0,h=!1,p,d=[],v={},m=[],g=[];u=e,a=0;for(var y=0,b=s.length;y<b;y++)"zIndex"in s[y]&&(d.push(s[y].zIndex),s[y].zIndex<0&&(v[s[y].zIndex]=s[y]));d.sort(o);while(d[c]<0){p=v[d[c++]],m.push(p.apply(t,i));if(a)return a=r,m}for(y=0;y<b;y++){p=s[y];if("zIndex"in p)if(p.zIndex==d[c]){m.push(p.apply(t,i));if(a)return a=r,m;do{c++,p=v[d[c]],p&&m.push(p.apply(t,i));if(a)return a=r,m}while(p)}else v[p.zIndex]=p;else{m.push(p.apply(t,i));if(a)return a=r,m}}return a=r,m.length?m:null};l.listeners=function(e){var t=e.split(r),n=f,s,o,u,a,l,c,h,p,d=[n],v=[];for(a=0,l=t.length;a<l;a++){p=[];for(c=0,h=d.length;c<h;c++){n=d[c].n,o=[n[t[a]],n[i]],u=2;while(u--)s=o[u],s&&(p.push(s),v=v.concat(s.f||[]))}d=p}return v},l.on=function(e,t){var n=e.split(r),i=f;for(var o=0,u=n.length;o<u;o++)i=i.n,!i[n[o]]&&(i[n[o]]={n:{}}),i=i[n[o]];i.f=i.f||[];for(o=0,u=i.f.length;o<u;o++)if(i.f[o]==t)return s;return i.f.push(t),function(e){+e==+e&&(t.zIndex=+e)}},l.stop=function(){a=1},l.nt=function(e){return e?(new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)")).test(u):u},l.unbind=function(e,t){var s=e.split(r),o,u,a,l,c,h,p,d=[f];for(l=0,c=s.length;l<c;l++)for(h=0;h<d.length;h+=a.length-2){a=[h,1],o=d[h].n;if(s[l]!=i)o[s[l]]&&a.push(o[s[l]]);else for(u in o)o[n](u)&&a.push(o[u]);d.splice.apply(d,a)}for(l=0,c=d.length;l<c;l++){o=d[l];while(o.n){if(t){if(o.f){for(h=0,p=o.f.length;h<p;h++)if(o.f[h]==t){o.f.splice(h,1);break}!o.f.length&&delete o.f}for(u in o.n)if(o.n[n](u)&&o.n[u].f){var v=o.n[u].f;for(h=0,p=v.length;h<p;h++)if(v[h]==t){v.splice(h,1);break}!v.length&&delete o.n[u].f}}else{delete o.f;for(u in o.n)o.n[n](u)&&o.n[u].f&&delete o.n[u].f}o=o.n}}},l.once=function(e,t){var n=function(){t.apply(this,arguments),l.unbind(e,n)};return l.on(e,n)},l.version=t,l.toString=function(){return"You are running Eve "+t},typeof module!="undefined"&&module.exports?module.exports=l:e.eve=l}(this),function(){function e(n){if(e.is(n,"function"))return t?n():eve.on("DOMload",n);if(e.is(n,O))return e._engine.create[h](e,n.splice(0,3+e.is(n[0],L))).add(n);var r=Array.prototype.slice.call(arguments,0);if(e.is(r[r.length-1],"function")){var i=r.pop();return t?i.call(e._engine.create[h](e,r)):eve.on("DOMload",function(){i.call(e._engine.create[h](e,r))})}return e._engine.create[h](e,arguments)}function yt(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function bt(e,t,n){function r(){var i=Array.prototype.slice.call(arguments,0),s=i.join("␀"),u=r.cache=r.cache||{},a=r.count=r.count||[];return u[o](s)?(yt(a,s),n?n(u[s]):u[s]):(a.length>=1e3&&delete u[a.shift()],a.push(s),u[s]=e[h](t,i),n?n(u[s]):u[s])}return r}function Et(){return this.hex}function St(e){var t=[];for(var n=0,r=e.length;r-2>n;n+=2){var i=[{x:+e[n],y:+e[n+1]},{x:+e[n],y:+e[n+1]},{x:+e[n+2],y:+e[n+3]},{x:+e[n+4],y:+e[n+5]}];r-4==n?(i[0]={x:+e[n-2],y:+e[n-1]},i[3]=i[2]):n&&(i[0]={x:+e[n-2],y:+e[n-1]}),t.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y])}return t}function Ut(e,t,n,r,i,s){e!=null?(this.a=+e,this.b=+t,this.c=+n,this.d=+r,this.e=+i,this.f=+s):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function nn(){return this.x+m+this.y}function rn(){return this.x+m+this.y+m+this.width+" × "+this.height}function mn(e,t,n,r,i,s){function h(e){return((a*e+u)*e+o)*e}function p(e,t){var n=d(e,t);return((c*n+l)*n+f)*n}function d(e,t){var n,r,i,s,f,l;for(i=e,l=0;l<8;l++){s=h(i)-e;if(N(s)<t)return i;f=(3*a*i+2*u)*i+o;if(N(f)<1e-6)break;i-=s/f}n=0,r=1,i=e;if(i<n)return n;if(i>r)return r;while(n<r){s=h(i);if(N(s-e)<t)return i;e>s?n=i:r=i,i=(r-n)/2+n}return i}var o=3*t,u=3*(r-t)-o,a=1-o-u,f=3*n,l=3*(i-n)-f,c=1-f-l;return p(e,1/(200*s))}function gn(e,t){var n=[],r={};this.ms=t,this.times=1;if(e){for(var i in e)e[o](i)&&(r[U(i)]=e[i],n.push(U(i)));n.sort(nt)}this.anim=r,this.top=n[n.length-1],this.percents=n}function yn(t,r,i,s,u,a){i=U(i);var f,l,c,h=[],d,v,m,b=t.ms,w={},E={},S={};if(s)for(T=0,N=hn.length;T<N;T++){var x=hn[T];if(x.el.id==r.id&&x.anim==t){x.percent!=i?(hn.splice(T,1),c=1):l=x,r.attr(x.totalOrigin);break}}else s=+E;for(var T=0,N=t.percents.length;T<N;T++){if(t.percents[T]==i||t.percents[T]>s*t.top){i=t.percents[T],v=t.percents[T-1]||0,b=b/t.top*(i-v),d=t.percents[T+1],f=t.anim[i];break}s&&r.attr(t.anim[t.percents[T]])}if(!f)return;if(!l){for(var C in f)if(f[o](C))if(V[o](C)||r.paper.customAttributes[o](C)){w[C]=r.attr(C),w[C]==null&&(w[C]=X[C]),E[C]=f[C];switch(V[C]){case L:S[C]=(E[C]-w[C])/b;break;case"colour":w[C]=e.getRGB(w[C]);var k=e.getRGB(E[C]);S[C]={r:(k.r-w[C].r)/b,g:(k.g-w[C].g)/b,b:(k.b-w[C].b)/b};break;case"path":var A=_t(w[C],E[C]),O=A[1];w[C]=A[0],S[C]=[];for(T=0,N=w[C].length;T<N;T++){S[C][T]=[0];for(var M=1,_=w[C][T].length;M<_;M++)S[C][T][M]=(O[T][M]-w[C][T][M])/b}break;case"transform":var D=r._,P=Rt(D[C],E[C]);if(P){w[C]=P.from,E[C]=P.to,S[C]=[],S[C].real=!0;for(T=0,N=w[C].length;T<N;T++){S[C][T]=[w[C][T][0]];for(M=1,_=w[C][T].length;M<_;M++)S[C][T][M]=(E[C][T][M]-w[C][T][M])/b}}else{var H=r.matrix||new Ut,B={_:{transform:D.transform},getBBox:function(){return r.getBBox(1)}};w[C]=[H.a,H.b,H.c,H.d,H.e,H.f],It(B,E[C]),E[C]=B._.transform,S[C]=[(B.matrix.a-H.a)/b,(B.matrix.b-H.b)/b,(B.matrix.c-H.c)/b,(B.matrix.d-H.d)/b,(B.matrix.e-H.e)/b,(B.matrix.e-H.f)/b]}break;case"csv":var j=g(f[C])[y](n),F=g(w[C])[y](n);if(C=="clip-rect"){w[C]=F,S[C]=[],T=F.length;while(T--)S[C][T]=(j[T]-w[C][T])/b}E[C]=j;break;default:j=[][p](f[C]),F=[][p](w[C]),S[C]=[],T=r.paper.customAttributes[C].length;while(T--)S[C][T]=((j[T]||0)-(F[T]||0))/b}}var q=f.easing,R=e.easing_formulas[q];if(!R){R=g(q).match(I);if(R&&R.length==5){var z=R;R=function(e){return mn(e,+z[1],+z[2],+z[3],+z[4],b)}}else R=it}m=f.start||t.start||+(new Date),x={anim:t,percent:i,timestamp:m,start:m+(t.del||0),status:0,initstatus:s||0,stop:!1,ms:b,easing:R,from:w,diff:S,to:E,el:r,callback:f.callback,prev:v,next:d,repeat:a||t.times,origin:r.attr(),totalOrigin:u},hn.push(x);if(s&&!l&&!c){x.stop=!0,x.start=new Date-b*s;if(hn.length==1)return dn()}c&&(x.start=new Date-x.ms*s),hn.length==1&&pn(dn)}else l.initstatus=s,l.start=new Date-l.ms*s;eve("anim.start."+r.id,r,t)}e.version="2.0.1",e.eve=eve;var t,n=/[, ]+/,r={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},i=/\{(\d+)\}/g,s="prototype",o="hasOwnProperty",u={doc:document,win:window},a={was:Object.prototype[o].call(u.win,"Raphael"),is:u.win.Raphael},f=function(){this.ca=this.customAttributes={}},l,c="appendChild",h="apply",p="concat",d="createTouch"in u.doc,v="",m=" ",g=String,y="split",b="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[y](m),w={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},E=g.prototype.toLowerCase,S=Math,x=S.max,T=S.min,N=S.abs,C=S.pow,k=S.PI,L="number",A="string",O="array",M="toString",_="fill",D=Object.prototype.toString,P={},H="push",B=e._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,j=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,F={NaN:1,Infinity:1,"-Infinity":1},I=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,q=S.round,R="setAttribute",U=parseFloat,z=parseInt,W=g.prototype.toUpperCase,X=e._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},V=e._availableAnimAttrs={blur:L,"clip-rect":"csv",cx:L,cy:L,fill:"colour","fill-opacity":L,"font-size":L,height:L,opacity:L,path:"path",r:L,rx:L,ry:L,stroke:"colour","stroke-opacity":L,"stroke-width":L,transform:"transform",width:L,x:L,y:L},$=/\s*,\s*/,J={hs:1,rg:1},K=/,?([achlmqrstvxz]),?/gi,Q=/([achlmrqstvz])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,G=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,Y=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)\s*,?\s*/ig,Z=e._radial_gradient=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,et={},tt=function(e,t){return e.key-t.key},nt=function(e,t){return U(e)-U(t)},rt=function(){},it=function(e){return e},st=e._rectPath=function(e,t,n,r,i){return i?[["M",e+i,t],["l",n-i*2,0],["a",i,i,0,0,1,i,i],["l",0,r-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-n,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-r],["a",i,i,0,0,1,i,-i],["z"]]:[["M",e,t],["l",n,0],["l",0,r],["l",-n,0],["z"]]},ot=function(e,t,n,r){return r==null&&(r=n),[["M",e,t],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]]},ut=e._getPath={path:function(e){return e.attr("path")},circle:function(e){var t=e.attrs;return ot(t.cx,t.cy,t.r)},ellipse:function(e){var t=e.attrs;return ot(t.cx,t.cy,t.rx,t.ry)},rect:function(e){var t=e.attrs;return st(t.x,t.y,t.width,t.height,t.r)},image:function(e){var t=e.attrs;return st(t.x,t.y,t.width,t.height)},text:function(e){var t=e._getBBox();return st(t.x,t.y,t.width,t.height)}},at=e.mapPath=function(e,t){if(!t)return e;var n,r,i,s,o,u,a;e=_t(e);for(i=0,o=e.length;i<o;i++){a=e[i];for(s=1,u=a.length;s<u;s+=2)n=t.x(a[s],a[s+1]),r=t.y(a[s],a[s+1]),a[s]=n,a[s+1]=r}return e};e._g=u,e.type=u.win.SVGAngle||u.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(e.type=="VML"){var ft=u.doc.createElement("div"),lt;ft.innerHTML='<v:shape adj="1"/>',lt=ft.firstChild,lt.style.behavior="url(#default#VML)";if(!lt||typeof lt.adj!="object")return e.type=v;ft=null}e.svg=!(e.vml=e.type=="VML"),e._Paper=f,e.fn=l=f.prototype=e.prototype,e._id=0,e._oid=0,e.is=function(e,t){return t=E.call(t),t=="finite"?!F[o](+e):t=="array"?e instanceof Array:t=="null"&&e===null||t==typeof e&&e!==null||t=="object"&&e===Object(e)||t=="array"&&Array.isArray&&Array.isArray(e)||D.call(e).slice(8,-1).toLowerCase()==t},e.angle=function(t,n,r,i,s,o){if(s==null){var u=t-r,a=n-i;return!u&&!a?0:(180+S.atan2(-a,-u)*180/k+360)%360}return e.angle(t,n,s,o)-e.angle(r,i,s,o)},e.rad=function(e){return e%360*k/180},e.deg=function(e){return e*180/k%360},e.snapTo=function(t,n,r){r=e.is(r,"finite")?r:10;if(e.is(t,O)){var i=t.length;while(i--)if(N(t[i]-n)<=r)return t[i]}else{t=+t;var s=n%t;if(s<r)return n-s;if(s>t-r)return n-s+t}return n};var ct=e.createUUID=function(e,t){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(e,t).toUpperCase()}}(/[xy]/g,function(e){var t=S.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)});e.setWindow=function(t){eve("setWindow",e,u.win,t),u.win=t,u.doc=u.win.document,e._engine.initWin&&e._engine.initWin(u.win)};var ht=function(t){if(e.vml){var n=/^\s+|\s+$/g,r;try{var i=new ActiveXObject("htmlfile");i.write("<body>"),i.close(),r=i.body}catch(s){r=createPopup().document.body}var o=r.createTextRange();ht=bt(function(e){try{r.style.color=g(e).replace(n,v);var t=o.queryCommandValue("ForeColor");return t=(t&255)<<16|t&65280|(t&16711680)>>>16,"#"+("000000"+t.toString(16)).slice(-6)}catch(i){return"none"}})}else{var a=u.doc.createElement("i");a.title="Raphaël Colour Picker",a.style.display="none",u.doc.body.appendChild(a),ht=bt(function(e){return a.style.color=e,u.doc.defaultView.getComputedStyle(a,v).getPropertyValue("color")})}return ht(t)},pt=function(){return"hsb("+[this.h,this.s,this.b]+")"},dt=function(){return"hsl("+[this.h,this.s,this.l]+")"},vt=function(){return this.hex},mt=function(t,n,r){n==null&&e.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(r=t.b,n=t.g,t=t.r);if(n==null&&e.is(t,A)){var i=e.getRGB(t);t=i.r,n=i.g,r=i.b}if(t>1||n>1||r>1)t/=255,n/=255,r/=255;return[t,n,r]},gt=function(t,n,r,i){t*=255,n*=255,r*=255;var s={r:t,g:n,b:r,hex:e.rgb(t,n,r),toString:vt};return e.is(i,"finite")&&(s.opacity=i),s};e.color=function(t){var n;return e.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(n=e.hsb2rgb(t),t.r=n.r,t.g=n.g,t.b=n.b,t.hex=n.hex):e.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(n=e.hsl2rgb(t),t.r=n.r,t.g=n.g,t.b=n.b,t.hex=n.hex):(e.is(t,"string")&&(t=e.getRGB(t)),e.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(n=e.rgb2hsl(t),t.h=n.h,t.s=n.s,t.l=n.l,n=e.rgb2hsb(t),t.v=n.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1)),t.toString=vt,t},e.hsb2rgb=function(e,t,n,r){this.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(n=e.b,t=e.s,e=e.h,r=e.o),e*=360;var i,s,o,u,a;return e=e%360/60,a=n*t,u=a*(1-N(e%2-1)),i=s=o=n-a,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],gt(i,s,o,r)},e.hsl2rgb=function(e,t,n,r){this.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(n=e.l,t=e.s,e=e.h);if(e>1||t>1||n>1)e/=360,t/=100,n/=100;e*=360;var i,s,o,u,a;return e=e%360/60,a=2*t*(n<.5?n:1-n),u=a*(1-N(e%2-1)),i=s=o=n-a/2,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],gt(i,s,o,r)},e.rgb2hsb=function(e,t,n){n=mt(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o;return s=x(e,t,n),o=s-T(e,t,n),r=o==0?null:s==e?(t-n)/o:s==t?(n-e)/o+2:(e-t)/o+4,r=(r+360)%6*60/360,i=o==0?0:o/s,{h:r,s:i,b:s,toString:pt}},e.rgb2hsl=function(e,t,n){n=mt(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o,u,a;return o=x(e,t,n),u=T(e,t,n),a=o-u,r=a==0?null:o==e?(t-n)/a:o==t?(n-e)/a+2:(e-t)/a+4,r=(r+360)%6*60/360,s=(o+u)/2,i=a==0?0:s<.5?a/(2*s):a/(2-2*s),{h:r,s:i,l:s,toString:dt}},e._path2string=function(){return this.join(",").replace(K,"$1")};var wt=e._preload=function(e,t){var n=u.doc.createElement("img");n.style.cssText="position:absolute;left:-9999em;top:-9999em",n.onload=function(){t.call(this),this.onload=null,u.doc.body.removeChild(this)},n.onerror=function(){u.doc.body.removeChild(this)},u.doc.body.appendChild(n),n.src=e};e.getRGB=bt(function(t){if(!t||!!((t=g(t)).indexOf("-")+1))return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Et};if(t=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:Et};!J[o](t.toLowerCase().substring(0,2))&&t.charAt()!="#"&&(t=ht(t));var n,r,i,s,u,a,f,l=t.match(j);return l?(l[2]&&(s=z(l[2].substring(5),16),i=z(l[2].substring(3,5),16),r=z(l[2].substring(1,3),16)),l[3]&&(s=z((a=l[3].charAt(3))+a,16),i=z((a=l[3].charAt(2))+a,16),r=z((a=l[3].charAt(1))+a,16)),l[4]&&(f=l[4][y]($),r=U(f[0]),f[0].slice(-1)=="%"&&(r*=2.55),i=U(f[1]),f[1].slice(-1)=="%"&&(i*=2.55),s=U(f[2]),f[2].slice(-1)=="%"&&(s*=2.55),l[1].toLowerCase().slice(0,4)=="rgba"&&(u=U(f[3])),f[3]&&f[3].slice(-1)=="%"&&(u/=100)),l[5]?(f=l[5][y]($),r=U(f[0]),f[0].slice(-1)=="%"&&(r*=2.55),i=U(f[1]),f[1].slice(-1)=="%"&&(i*=2.55),s=U(f[2]),f[2].slice(-1)=="%"&&(s*=2.55),(f[0].slice(-3)=="deg"||f[0].slice(-1)=="°")&&(r/=360),l[1].toLowerCase().slice(0,4)=="hsba"&&(u=U(f[3])),f[3]&&f[3].slice(-1)=="%"&&(u/=100),e.hsb2rgb(r,i,s,u)):l[6]?(f=l[6][y]($),r=U(f[0]),f[0].slice(-1)=="%"&&(r*=2.55),i=U(f[1]),f[1].slice(-1)=="%"&&(i*=2.55),s=U(f[2]),f[2].slice(-1)=="%"&&(s*=2.55),(f[0].slice(-3)=="deg"||f[0].slice(-1)=="°")&&(r/=360),l[1].toLowerCase().slice(0,4)=="hsla"&&(u=U(f[3])),f[3]&&f[3].slice(-1)=="%"&&(u/=100),e.hsl2rgb(r,i,s,u)):(l={r:r,g:i,b:s,toString:Et},l.hex="#"+(16777216|s|i<<8|r<<16).toString(16).slice(1),e.is(u,"finite")&&(l.opacity=u),l)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Et}},e),e.hsb=bt(function(t,n,r){return e.hsb2rgb(t,n,r).hex}),e.hsl=bt(function(t,n,r){return e.hsl2rgb(t,n,r).hex}),e.rgb=bt(function(e,t,n){return"#"+(16777216|n|t<<8|e<<16).toString(16).slice(1)}),e.getColor=function(e){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||.75},n=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,t.h>1&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),n.hex},e.getColor.reset=function(){delete this.start},e.parsePathString=bt(function(t){if(!t)return null;var n={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},r=[];return e.is(t,O)&&e.is(t[0],O)&&(r=Tt(t)),r.length||g(t).replace(Q,function(e,t,i){var s=[],o=t.toLowerCase();i.replace(Y,function(e,t){t&&s.push(+t)}),o=="m"&&s.length>2&&(r.push([t][p](s.splice(0,2))),o="l",t=t=="m"?"l":"L");if(o=="r")r.push([t][p](s));else while(s.length>=n[o]){r.push([t][p](s.splice(0,n[o])));if(!n[o])break}}),r.toString=e._path2string,r}),e.parseTransformString=bt(function(t){if(!t)return null;var n={r:3,s:4,t:2,m:6},r=[];return e.is(t,O)&&e.is(t[0],O)&&(r=Tt(t)),r.length||g(t).replace(G,function(e,t,n){var i=[],s=E.call(t);n.replace(Y,function(e,t){t&&i.push(+t)}),r.push([t][p](i))}),r.toString=e._path2string,r}),e.findDotsAtSegment=function(e,t,n,r,i,s,o,u,a){var f=1-a,l=C(f,3),c=C(f,2),h=a*a,p=h*a,d=l*e+c*3*a*n+f*3*a*a*i+p*o,v=l*t+c*3*a*r+f*3*a*a*s+p*u,m=e+2*a*(n-e)+h*(i-2*n+e),g=t+2*a*(r-t)+h*(s-2*r+t),y=n+2*a*(i-n)+h*(o-2*i+n),b=r+2*a*(s-r)+h*(u-2*s+r),w=f*e+a*n,E=f*t+a*r,x=f*i+a*o,T=f*s+a*u,N=90-S.atan2(m-y,g-b)*180/k;return(m>y||g<b)&&(N+=180),{x:d,y:v,m:{x:m,y:g},n:{x:y,y:b},start:{x:w,y:E},end:{x:x,y:T},alpha:N}},e._removedFactory=function(e){return function(){throw new Error("Raphaël: you are calling to method “"+e+"” of removed object")}};var xt=bt(function(e){if(!e)return{x:0,y:0,width:0,height:0};e=_t(e);var t=0,n=0,r=[],i=[],s;for(var o=0,u=e.length;o<u;o++){s=e[o];if(s[0]=="M")t=s[1],n=s[2],r.push(t),i.push(n);else{var a=Mt(t,n,s[1],s[2],s[3],s[4],s[5],s[6]);r=r[p](a.min.x,a.max.x),i=i[p](a.min.y,a.max.y),t=s[5],n=s[6]}}var f=T[h](0,r),l=T[h](0,i);return{x:f,y:l,width:x[h](0,r)-f,height:x[h](0,i)-l}},null,function(e){return{x:e.x,y:e.y,width:e.width,height:e.height}}),Tt=function(t){var n=[];if(!e.is(t,O)||!e.is(t&&t[0],O))t=e.parsePathString(t);for(var r=0,i=t.length;r<i;r++){n[r]=[];for(var s=0,o=t[r].length;s<o;s++)n[r][s]=t[r][s]}return n.toString=e._path2string,n},Nt=e._pathToRelative=bt(function(t){if(!e.is(t,O)||!e.is(t&&t[0],O))t=e.parsePathString(t);var n=[],r=0,i=0,s=0,o=0,u=0;t[0][0]=="M"&&(r=t[0][1],i=t[0][2],s=r,o=i,u++,n.push(["M",r,i]));for(var a=u,f=t.length;a<f;a++){var l=n[a]=[],c=t[a];if(c[0]!=E.call(c[0])){l[0]=E.call(c[0]);switch(l[0]){case"a":l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5],l[6]=+(c[6]-r).toFixed(3),l[7]=+(c[7]-i).toFixed(3);break;case"v":l[1]=+(c[1]-i).toFixed(3);break;case"m":s=c[1],o=c[2];default:for(var h=1,p=c.length;h<p;h++)l[h]=+(c[h]-(h%2?r:i)).toFixed(3)}}else{l=n[a]=[],c[0]=="m"&&(s=c[1]+r,o=c[2]+i);for(var d=0,v=c.length;d<v;d++)n[a][d]=c[d]}var m=n[a].length;switch(n[a][0]){case"z":r=s,i=o;break;case"h":r+=+n[a][m-1];break;case"v":i+=+n[a][m-1];break;default:r+=+n[a][m-2],i+=+n[a][m-1]}}return n.toString=e._path2string,n},0,Tt),Ct=e._pathToAbsolute=bt(function(t){if(!e.is(t,O)||!e.is(t&&t[0],O))t=e.parsePathString(t);if(!t||!t.length)return[["M",0,0]];var n=[],r=0,i=0,s=0,o=0,u=0;t[0][0]=="M"&&(r=+t[0][1],i=+t[0][2],s=r,o=i,u++,n[0]=["M",r,i]);for(var a,f,l=u,c=t.length;l<c;l++){n.push(a=[]),f=t[l];if(f[0]!=W.call(f[0])){a[0]=W.call(f[0]);switch(a[0]){case"A":a[1]=f[1],a[2]=f[2],a[3]=f[3],a[4]=f[4],a[5]=f[5],a[6]=+(f[6]+r),a[7]=+(f[7]+i);break;case"V":a[1]=+f[1]+i;break;case"H":a[1]=+f[1]+r;break;case"R":var h=[r,i][p](f.slice(1));for(var d=2,v=h.length;d<v;d++)h[d]=+h[d]+r,h[++d]=+h[d]+i;n.pop(),n=n[p](St(h));break;case"M":s=+f[1]+r,o=+f[2]+i;default:for(d=1,v=f.length;d<v;d++)a[d]=+f[d]+(d%2?r:i)}}else if(f[0]=="R")h=[r,i][p](f.slice(1)),n.pop(),n=n[p](St(h)),a=["R"][p](f.slice(-2));else for(var m=0,g=f.length;m<g;m++)a[m]=f[m];switch(a[0]){case"Z":r=s,i=o;break;case"H":r=a[1];break;case"V":i=a[1];break;case"M":s=a[a.length-2],o=a[a.length-1];default:r=a[a.length-2],i=a[a.length-1]}}return n.toString=e._path2string,n},null,Tt),kt=function(e,t,n,r){return[e,t,n,r,n,r]},Lt=function(e,t,n,r,i,s){var o=1/3,u=2/3;return[o*e+u*n,o*t+u*r,o*i+u*n,o*s+u*r,i,s]},At=function(e,t,n,r,i,s,o,u,a,f){var l=k*120/180,c=k/180*(+i||0),h=[],d,v=bt(function(e,t,n){var r=e*S.cos(n)-t*S.sin(n),i=e*S.sin(n)+t*S.cos(n);return{x:r,y:i}});if(!f){d=v(e,t,-c),e=d.x,t=d.y,d=v(u,a,-c),u=d.x,a=d.y;var m=S.cos(k/180*i),g=S.sin(k/180*i),b=(e-u)/2,w=(t-a)/2,E=b*b/(n*n)+w*w/(r*r);E>1&&(E=S.sqrt(E),n=E*n,r=E*r);var x=n*n,T=r*r,C=(s==o?-1:1)*S.sqrt(N((x*T-x*w*w-T*b*b)/(x*w*w+T*b*b))),L=C*n*w/r+(e+u)/2,A=C*-r*b/n+(t+a)/2,O=S.asin(((t-A)/r).toFixed(9)),M=S.asin(((a-A)/r).toFixed(9));O=e<L?k-O:O,M=u<L?k-M:M,O<0&&(O=k*2+O),M<0&&(M=k*2+M),o&&O>M&&(O-=k*2),!o&&M>O&&(M-=k*2)}else O=f[0],M=f[1],L=f[2],A=f[3];var _=M-O;if(N(_)>l){var D=M,P=u,H=a;M=O+l*(o&&M>O?1:-1),u=L+n*S.cos(M),a=A+r*S.sin(M),h=At(u,a,n,r,i,0,o,P,H,[M,D,L,A])}_=M-O;var B=S.cos(O),j=S.sin(O),F=S.cos(M),I=S.sin(M),q=S.tan(_/4),R=4/3*n*q,U=4/3*r*q,z=[e,t],W=[e+R*j,t-U*B],X=[u+R*I,a-U*F],V=[u,a];W[0]=2*z[0]-W[0],W[1]=2*z[1]-W[1];if(f)return[W,X,V][p](h);h=[W,X,V][p](h).join()[y](",");var $=[];for(var J=0,K=h.length;J<K;J++)$[J]=J%2?v(h[J-1],h[J],c).y:v(h[J],h[J+1],c).x;return $},Ot=function(e,t,n,r,i,s,o,u,a){var f=1-a;return{x:C(f,3)*e+C(f,2)*3*a*n+f*3*a*a*i+C(a,3)*o,y:C(f,3)*t+C(f,2)*3*a*r+f*3*a*a*s+C(a,3)*u}},Mt=bt(function(e,t,n,r,i,s,o,u){var a=i-2*n+e-(o-2*i+n),f=2*(n-e)-2*(i-n),l=e-n,c=(-f+S.sqrt(f*f-4*a*l))/2/a,p=(-f-S.sqrt(f*f-4*a*l))/2/a,d=[t,u],v=[e,o],m;return N(c)>"1e12"&&(c=.5),N(p)>"1e12"&&(p=.5),c>0&&c<1&&(m=Ot(e,t,n,r,i,s,o,u,c),v.push(m.x),d.push(m.y)),p>0&&p<1&&(m=Ot(e,t,n,r,i,s,o,u,p),v.push(m.x),d.push(m.y)),a=s-2*r+t-(u-2*s+r),f=2*(r-t)-2*(s-r),l=t-r,c=(-f+S.sqrt(f*f-4*a*l))/2/a,p=(-f-S.sqrt(f*f-4*a*l))/2/a,N(c)>"1e12"&&(c=.5),N(p)>"1e12"&&(p=.5),c>0&&c<1&&(m=Ot(e,t,n,r,i,s,o,u,c),v.push(m.x),d.push(m.y)),p>0&&p<1&&(m=Ot(e,t,n,r,i,s,o,u,p),v.push(m.x),d.push(m.y)),{min:{x:T[h](0,v),y:T[h](0,d)},max:{x:x[h](0,v),y:x[h](0,d)}}}),_t=e._path2curve=bt(function(e,t){var n=Ct(e),r=t&&Ct(t),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=function(e,t){var n,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null);switch(e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"][p](At[h](0,[t.x,t.y][p](e.slice(1))));break;case"S":n=t.x+(t.x-(t.bx||t.x)),r=t.y+(t.y-(t.by||t.y)),e=["C",n,r][p](e.slice(1));break;case"T":t.qx=t.x+(t.x-(t.qx||t.x)),t.qy=t.y+(t.y-(t.qy||t.y)),e=["C"][p](Lt(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"][p](Lt(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"][p](kt(t.x,t.y,e[1],e[2]));break;case"H":e=["C"][p](kt(t.x,t.y,e[1],t.y));break;case"V":e=["C"][p](kt(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"][p](kt(t.x,t.y,t.X,t.Y))}return e},u=function(e,t){if(e[t].length>7){e[t].shift();var i=e[t];while(i.length)e.splice(t++,0,["C"][p](i.splice(0,6)));e.splice(t,1),l=x(n.length,r&&r.length||0)}},a=function(e,t,i,s,o){e&&t&&e[o][0]=="M"&&t[o][0]!="M"&&(t.splice(o,0,["M",s.x,s.y]),i.bx=0,i.by=0,i.x=e[o][1],i.y=e[o][2],l=x(n.length,r&&r.length||0))};for(var f=0,l=x(n.length,r&&r.length||0);f<l;f++){n[f]=o(n[f],i),u(n,f),r&&(r[f]=o(r[f],s)),r&&u(r,f),a(n,r,i,s,f),a(r,n,s,i,f);var c=n[f],d=r&&r[f],v=c.length,m=r&&d.length;i.x=c[v-2],i.y=c[v-1],i.bx=U(c[v-4])||i.x,i.by=U(c[v-3])||i.y,s.bx=r&&(U(d[m-4])||s.x),s.by=r&&(U(d[m-3])||s.y),s.x=r&&d[m-2],s.y=r&&d[m-1]}return r?[n,r]:n},null,Tt),Dt=e._parseDots=bt(function(t){var n=[];for(var r=0,i=t.length;r<i;r++){var s={},o=t[r].match(/^([^:]*):?([\d\.]*)/);s.color=e.getRGB(o[1]);if(s.color.error)return null;s.color=s.color.hex,o[2]&&(s.offset=o[2]+"%"),n.push(s)}for(r=1,i=n.length-1;r<i;r++)if(!n[r].offset){var u=U(n[r-1].offset||0),a=0;for(var f=r+1;f<i;f++)if(n[f].offset){a=n[f].offset;break}a||(a=100,f=i),a=U(a);var l=(a-u)/(f-r+1);for(;r<f;r++)u+=l,n[r].offset=u+"%"}return n}),Pt=e._tear=function(e,t){e==t.top&&(t.top=e.prev),e==t.bottom&&(t.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)},Ht=e._tofront=function(e,t){if(t.top===e)return;Pt(e,t),e.next=null,e.prev=t.top,t.top.next=e,t.top=e},Bt=e._toback=function(e,t){if(t.bottom===e)return;Pt(e,t),e.next=t.bottom,e.prev=null,t.bottom.prev=e,t.bottom=e},jt=e._insertafter=function(e,t,n){Pt(e,n),t==n.top&&(n.top=e),t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e},Ft=e._insertbefore=function(e,t,n){Pt(e,n),t==n.bottom&&(n.bottom=e),t.prev&&(t.prev.next=e),e.prev=t.prev,t.prev=e,e.next=t},It=e._extractTransform=function(t,n){if(n==null)return t._.transform;n=g(n).replace(/\.{3}|\u2026/g,t._.transform||v);var r=e.parseTransformString(n),i=0,s=0,o=0,u=1,a=1,f=t._,l=new Ut;f.transform=r||[];if(r)for(var c=0,h=r.length;c<h;c++){var p=r[c],d=p.length,m=g(p[0]).toLowerCase(),y=p[0]!=m,b=y?l.invert():0,w,E,S,x,T;m=="t"&&d==3?y?(w=b.x(0,0),E=b.y(0,0),S=b.x(p[1],p[2]),x=b.y(p[1],p[2]),l.translate(S-w,x-E)):l.translate(p[1],p[2]):m=="r"?d==2?(T=T||t.getBBox(1),l.rotate(p[1],T.x+T.width/2,T.y+T.height/2),i+=p[1]):d==4&&(y?(S=b.x(p[2],p[3]),x=b.y(p[2],p[3]),l.rotate(p[1],S,x)):l.rotate(p[1],p[2],p[3]),i+=p[1]):m=="s"?d==2||d==3?(T=T||t.getBBox(1),l.scale(p[1],p[d-1],T.x+T.width/2,T.y+T.height/2),u*=p[1],a*=p[d-1]):d==5&&(y?(S=b.x(p[3],p[4]),x=b.y(p[3],p[4]),l.scale(p[1],p[2],S,x)):l.scale(p[1],p[2],p[3],p[4]),u*=p[1],a*=p[2]):m=="m"&&d==7&&l.add(p[1],p[2],p[3],p[4],p[5],p[6]),f.dirtyT=1,t.matrix=l}t.matrix=l,f.sx=u,f.sy=a,f.deg=i,f.dx=s=l.e,f.dy=o=l.f,u==1&&a==1&&!i&&f.bbox?(f.bbox.x+=+s,f.bbox.y+=+o):f.dirtyT=1},qt=function(e){var t=e[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return e.length==4?[t,0,e[2],e[3]]:[t,0];case"s":return e.length==5?[t,1,1,e[3],e[4]]:e.length==3?[t,1,1]:[t,1]}},Rt=e._equaliseTransform=function(t,n){n=g(n).replace(/\.{3}|\u2026/g,t),t=e.parseTransformString(t)||[],n=e.parseTransformString(n)||[];var r=x(t.length,n.length),i=[],s=[],o=0,u,a,f,l;for(;o<r;o++){f=t[o]||qt(n[o]),l=n[o]||qt(f);if(f[0]!=l[0]||f[0].toLowerCase()=="r"&&(f[2]!=l[2]||f[3]!=l[3])||f[0].toLowerCase()=="s"&&(f[3]!=l[3]||f[4]!=l[4]))return;i[o]=[],s[o]=[];for(u=0,a=x(f.length,l.length);u<a;u++)u in f&&(i[o][u]=f[u]),u in l&&(s[o][u]=l[u])}return{from:i,to:s}};e._getContainer=function(t,n,r,i){var s;s=i==null&&!e.is(t,"object")?u.doc.getElementById(t):t;if(s==null)return;return s.tagName?n==null?{container:s,width:s.style.pixelWidth||s.offsetWidth,height:s.style.pixelHeight||s.offsetHeight}:{container:s,width:n,height:r}:{container:1,x:t,y:n,width:r,height:i}},e.pathToRelative=Nt,e._engine={},e.path2curve=_t,e.matrix=function(e,t,n,r,i,s){return new Ut(e,t,n,r,i,s)},function(t){function n(e){return e[0]*e[0]+e[1]*e[1]}function r(e){var t=S.sqrt(n(e));e[0]&&(e[0]/=t),e[1]&&(e[1]/=t)}t.add=function(e,t,n,r,i,s){var o=[[],[],[]],u=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],a=[[e,n,i],[t,r,s],[0,0,1]],f,l,c,h;e&&e instanceof Ut&&(a=[[e.a,e.c,e.e],[e.b,e.d,e.f],[0,0,1]]);for(f=0;f<3;f++)for(l=0;l<3;l++){h=0;for(c=0;c<3;c++)h+=u[f][c]*a[c][l];o[f][l]=h}this.a=o[0][0],this.b=o[1][0],this.c=o[0][1],this.d=o[1][1],this.e=o[0][2],this.f=o[1][2]},t.invert=function(){var e=this,t=e.a*e.d-e.b*e.c;return new Ut(e.d/t,-e.b/t,-e.c/t,e.a/t,(e.c*e.f-e.d*e.e)/t,(e.b*e.e-e.a*e.f)/t)},t.clone=function(){return new Ut(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(e,t){this.add(1,0,0,1,e,t)},t.scale=function(e,t,n,r){t==null&&(t=e),(n||r)&&this.add(1,0,0,1,n,r),this.add(e,0,0,t,0,0),(n||r)&&this.add(1,0,0,1,-n,-r)},t.rotate=function(t,n,r){t=e.rad(t),n=n||0,r=r||0;var i=+S.cos(t).toFixed(9),s=+S.sin(t).toFixed(9);this.add(i,s,-s,i,n,r),this.add(1,0,0,1,-n,-r)},t.x=function(e,t){return e*this.a+t*this.c+this.e},t.y=function(e,t){return e*this.b+t*this.d+this.f},t.get=function(e){return+this[g.fromCharCode(97+e)].toFixed(4)},t.toString=function(){return e.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},t.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];t.scalex=S.sqrt(n(i[0])),r(i[0]),t.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*t.shear,i[1][1]-i[0][1]*t.shear],t.scaley=S.sqrt(n(i[1])),r(i[1]),t.shear/=t.scaley;var s=-i[0][1],o=i[1][1];return o<0?(t.rotate=e.deg(S.acos(o)),s<0&&(t.rotate=360-t.rotate)):t.rotate=e.deg(S.asin(s)),t.isSimple=!+t.shear.toFixed(9)&&(t.scalex.toFixed(9)==t.scaley.toFixed(9)||!t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(e){var t=e||this[y]();return t.isSimple?(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx&&t.dy?"t"+[t.dx,t.dy]:v)+(t.scalex!=1||t.scaley!=1?"s"+[t.scalex,t.scaley,0,0]:v)+(t.rotate?"r"+[t.rotate,0,0]:v)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(Ut.prototype);var zt=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(zt&&zt[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&zt&&zt[1]<8?l.safari=function(){var e=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){e.remove()})}:l.safari=rt;var Wt=function(){this.returnValue=!1},Xt=function(){return this.originalEvent.preventDefault()},Vt=function(){this.cancelBubble=!0},$t=function(){return this.originalEvent.stopPropagation()},Jt=function(){if(u.doc.addEventListener)return function(e,t,n,r){var i=d&&w[t]?w[t]:t,s=function(i){var s=u.doc.documentElement.scrollTop||u.doc.body.scrollTop,a=u.doc.documentElement.scrollLeft||u.doc.body.scrollLeft,f=i.clientX+a,l=i.clientY+s;if(d&&w[o](t))for(var c=0,h=i.targetTouches&&i.targetTouches.length;c<h;c++)if(i.targetTouches[c].target==e){var p=i;i=i.targetTouches[c],i.originalEvent=p,i.preventDefault=Xt,i.stopPropagation=$t;break}return n.call(r,i,f,l)};return e.addEventListener(i,s,!1),function(){return e.removeEventListener(i,s,!1),!0}};if(u.doc.attachEvent)return function(e,t,n,r){var i=function(e){e=e||u.win.event;var t=u.doc.documentElement.scrollTop||u.doc.body.scrollTop,i=u.doc.documentElement.scrollLeft||u.doc.body.scrollLeft,s=e.clientX+i,o=e.clientY+t;return e.preventDefault=e.preventDefault||Wt,e.stopPropagation=e.stopPropagation||Vt,n.call(r,e,s,o)};e.attachEvent("on"+t,i);var s=function(){return e.detachEvent("on"+t,i),!0};return s}}(),Kt=[],Qt=function(e){var t=e.clientX,n=e.clientY,r=u.doc.documentElement.scrollTop||u.doc.body.scrollTop,i=u.doc.documentElement.scrollLeft||u.doc.body.scrollLeft,s,o=Kt.length;while(o--){s=Kt[o];if(d){var a=e.touches.length,f;while(a--){f=e.touches[a];if(f.identifier==s.el._drag.id){t=f.clientX,n=f.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}}else e.preventDefault();var l=s.el.node,c,h=l.nextSibling,p=l.parentNode,v=l.style.display;u.win.opera&&p.removeChild(l),l.style.display="none",c=s.el.paper.getElementByPoint(t,n),l.style.display=v,u.win.opera&&(h?p.insertBefore(l,h):p.appendChild(l)),c&&eve("drag.over."+s.el.id,s.el,c),t+=i,n+=r,eve("drag.move."+s.el.id,s.move_scope||s.el,t-s.el._drag.x,n-s.el._drag.y,t,n,e)}},Gt=function(t){e.unmousemove(Qt).unmouseup(Gt);var n=Kt.length,r;while(n--)r=Kt[n],r.el._drag={},eve("drag.end."+r.el.id,r.end_scope||r.start_scope||r.move_scope||r.el,t);Kt=[]},Yt=e.el={};for(var Zt=b.length;Zt--;)(function(t){e[t]=Yt[t]=function(n,r){return e.is(n,"function")&&(this.events=this.events||[],this.events.push({name:t,f:n,unbind:Jt(this.shape||this.node||u.doc,t,n,r||this)})),this},e["un"+t]=Yt["un"+t]=function(e){var n=this.events,r=n.length;while(r--)if(n[r].name==t&&n[r].f==e)return n[r].unbind(),n.splice(r,1),!n.length&&delete this.events,this;return this}})(b[Zt]);Yt.data=function(t,n){var r=et[this.id]=et[this.id]||{};if(arguments.length==1){if(e.is(t,"object")){for(var i in t)t[o](i)&&this.data(i,t[i]);return this}return eve("data.get."+this.id,this,r[t],t),r[t]}return r[t]=n,eve("data.set."+this.id,this,n,t),this},Yt.removeData=function(e){return e==null?et[this.id]={}:et[this.id]&&delete et[this.id][e],this},Yt.hover=function(e,t,n,r){return this.mouseover(e,n).mouseout(t,r||n)},Yt.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)};var en=[];Yt.drag=function(t,n,r,i,s,o){function a(a){(a.originalEvent||a).preventDefault();var f=u.doc.documentElement.scrollTop||u.doc.body.scrollTop,l=u.doc.documentElement.scrollLeft||u.doc.body.scrollLeft;this._drag.x=a.clientX+l,this._drag.y=a.clientY+f,this._drag.id=a.identifier,!Kt.length&&e.mousemove(Qt).mouseup(Gt),Kt.push({el:this,move_scope:i,start_scope:s,end_scope:o}),n&&eve.on("drag.start."+this.id,n),t&&eve.on("drag.move."+this.id,t),r&&eve.on("drag.end."+this.id,r),eve("drag.start."+this.id,s||i||this,a.clientX+l,a.clientY+f,a)}return this._drag={},en.push({el:this,start:a}),this.mousedown(a),this},Yt.onDragOver=function(e){e?eve.on("drag.over."+this.id,e):eve.unbind("drag.over."+this.id)},Yt.undrag=function(){var t=en.length;while(t--)en[t].el==this&&(this.unmousedown(en[t].start),en.splice(t,1),eve.unbind("drag.*."+this.id));!en.length&&e.unmousemove(Qt).unmouseup(Gt)},l.circle=function(t,n,r){var i=e._engine.circle(this,t||0,n||0,r||0);return this.__set__&&this.__set__.push(i),i},l.rect=function(t,n,r,i,s){var o=e._engine.rect(this,t||0,n||0,r||0,i||0,s||0);return this.__set__&&this.__set__.push(o),o},l.ellipse=function(t,n,r,i){var s=e._engine.ellipse(this,t||0,n||0,r||0,i||0);return this.__set__&&this.__set__.push(s),s},l.path=function(t){t&&!e.is(t,A)&&!e.is(t[0],O)&&(t+=v);var n=e._engine.path(e.format[h](e,arguments),this);return this.__set__&&this.__set__.push(n),n},l.image=function(t,n,r,i,s){var o=e._engine.image(this,t||"about:blank",n||0,r||0,i||0,s||0);return this.__set__&&this.__set__.push(o),o},l.text=function(t,n,r){var i=e._engine.text(this,t||0,n||0,g(r));return this.__set__&&this.__set__.push(i),i},l.set=function(t){!e.is(t,"array")&&(t=Array.prototype.splice.call(arguments,0,arguments.length));var n=new bn(t);return this.__set__&&this.__set__.push(n),n},l.setStart=function(e){this.__set__=e||this.set()},l.setFinish=function(e){var t=this.__set__;return delete this.__set__,t},l.setSize=function(t,n){return e._engine.setSize.call(this,t,n)},l.setViewBox=function(t,n,r,i,s){return e._engine.setViewBox.call(this,t,n,r,i,s)},l.top=l.bottom=null,l.raphael=e;var tn=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.body,i=n.documentElement,s=i.clientTop||r.clientTop||0,o=i.clientLeft||r.clientLeft||0,a=t.top+(u.win.pageYOffset||i.scrollTop||r.scrollTop)-s,f=t.left+(u.win.pageXOffset||i.scrollLeft||r.scrollLeft)-o;return{y:a,x:f}};l.getElementByPoint=function(e,t){var n=this,r=n.canvas,i=u.doc.elementFromPoint(e,t);if(u.win.opera&&i.tagName=="svg"){var s=tn(r),o=r.createSVGRect();o.x=e-s.x,o.y=t-s.y,o.width=o.height=1;var a=r.getIntersectionList(o,null);a.length&&(i=a[a.length-1])}if(!i)return null;while(i.parentNode&&i!=r.parentNode&&!i.raphael)i=i.parentNode;return i==n.canvas.parentNode&&(i=r),i=i&&i.raphael?n.getById(i.raphaelid):null,i},l.getById=function(e){var t=this.bottom;while(t){if(t.id==e)return t;t=t.next}return null},l.forEach=function(e,t){var n=this.bottom;while(n){if(e.call(t,n)===!1)return this;n=n.next}return this},Yt.getBBox=function(e){if(this.removed)return{};var t=this._;if(e){if(t.dirty||!t.bboxwt)this.realPath=ut[this.type](this),t.bboxwt=xt(this.realPath),t.bboxwt.toString=rn,t.dirty=0;return t.bboxwt}if(t.dirty||t.dirtyT||!t.bbox){if(t.dirty||!this.realPath)t.bboxwt=0,this.realPath=ut[this.type](this);t.bbox=xt(at(this.realPath,this.matrix)),t.bbox.toString=rn,t.dirty=t.dirtyT=0}return t.bbox},Yt.clone=function(){if(this.removed)return null;var e=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(e),e},Yt.glow=function(e){if(this.type=="text")return null;e=e||{};var t={width:(e.width||10)+(+this.attr("stroke-width")||1),fill:e.fill||!1,opacity:e.opacity||.5,offsetx:e.offsetx||0,offsety:e.offsety||0,color:e.color||"#000"},n=t.width/2,r=this.paper,i=r.set(),s=this.realPath||ut[this.type](this);s=this.matrix?at(s,this.matrix):s;for(var o=1;o<n+1;o++)i.push(r.path(s).attr({stroke:t.color,fill:t.fill?t.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(t.width/n*o).toFixed(3),opacity:+(t.opacity/n).toFixed(3)}));return i.insertBefore(this).translate(t.offsetx,t.offsety)};var sn={},on=function(t,n,r,i,s,o,u,a,f){var l=0,c=100,h=[t,n,r,i,s,o,u,a].join(),p=sn[h],d,v;!p&&(sn[h]=p={data:[]}),p.timer&&clearTimeout(p.timer),p.timer=setTimeout(function(){delete sn[h]},2e3);if(f!=null&&!p.precision){var m=on(t,n,r,i,s,o,u,a);p.precision=~~m*10,p.data=[]}c=p.precision||c;for(var g=0;g<c+1;g++){p.data[g*c]?v=p.data[g*c]:(v=e.findDotsAtSegment(t,n,r,i,s,o,u,a,g/c),p.data[g*c]=v),g&&(l+=C(C(d.x-v.x,2)+C(d.y-v.y,2),.5));if(f!=null&&l>=f)return v;d=v}if(f==null)return l},un=function(t,n){return function(r,i,s){r=_t(r);var o,u,a,f,l="",c={},h,p=0;for(var d=0,v=r.length;d<v;d++){a=r[d];if(a[0]=="M")o=+a[1],u=+a[2];else{f=on(o,u,a[1],a[2],a[3],a[4],a[5],a[6]);if(p+f>i){if(n&&!c.start){h=on(o,u,a[1],a[2],a[3],a[4],a[5],a[6],i-p),l+=["C"+h.start.x,h.start.y,h.m.x,h.m.y,h.x,h.y];if(s)return l;c.start=l,l=["M"+h.x,h.y+"C"+h.n.x,h.n.y,h.end.x,h.end.y,a[5],a[6]].join(),p+=f,o=+a[5],u=+a[6];continue}if(!t&&!n)return h=on(o,u,a[1],a[2],a[3],a[4],a[5],a[6],i-p),{x:h.x,y:h.y,alpha:h.alpha}}p+=f,o=+a[5],u=+a[6]}l+=a.shift()+a}return c.end=l,h=t?p:n?c:e.findDotsAtSegment(o,u,a[0],a[1],a[2],a[3],a[4],a[5],1),h.alpha&&(h={x:h.x,y:h.y,alpha:h.alpha}),h}},an=un(1),fn=un(),ln=un(0,1);e.getTotalLength=an,e.getPointAtLength=fn,e.getSubpath=function(e,t,n){if(this.getTotalLength(e)-n<1e-6)return ln(e,t).end;var r=ln(e,n,1);return t?ln(r,t).end:r},Yt.getTotalLength=function(){if(this.type!="path")return;return this.node.getTotalLength?this.node.getTotalLength():an(this.attrs.path)},Yt.getPointAtLength=function(e){if(this.type!="path")return;return fn(this.attrs.path,e)},Yt.getSubpath=function(t,n){if(this.type!="path")return;return e.getSubpath(this.attrs.path,t,n)};var cn=e.easing_formulas={linear:function(e){return e},"<":function(e){return C(e,1.7)},">":function(e){return C(e,.48)},"<>":function(e){var t=.48-e/1.04,n=S.sqrt(.1734+t*t),r=n-t,i=C(N(r),1/3)*(r<0?-1:1),s=-n-t,o=C(N(s),1/3)*(s<0?-1:1),u=i+o+.5;return(1-u)*3*u*u+u*u*u},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){e-=1;var t=1.70158;return e*e*((t+1)*e+t)+1},elastic:function(e){return e==!!e?e:C(2,-10*e)*S.sin((e-.075)*2*k/.3)+1},bounce:function(e){var t=7.5625,n=2.75,r;return e<1/n?r=t*e*e:e<2/n?(e-=1.5/n,r=t*e*e+.75):e<2.5/n?(e-=2.25/n,r=t*e*e+.9375):(e-=2.625/n,r=t*e*e+.984375),r}};cn.easeIn=cn["ease-in"]=cn["<"],cn.easeOut=cn["ease-out"]=cn[">"],cn.easeInOut=cn["ease-in-out"]=cn["<>"],cn["back-in"]=cn.backIn,cn["back-out"]=cn.backOut;var hn=[],pn=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,16)},dn=function(){var t=+(new Date),n=0;for(;n<hn.length;n++){var r=hn[n];if(r.el.removed||r.paused)continue;var i=t-r.start,s=r.ms,u=r.easing,a=r.from,f=r.diff,l=r.to,c=r.t,h=r.el,d={},v,g={},y;r.initstatus?(i=(r.initstatus*r.anim.top-r.prev)/(r.percent-r.prev)*s,r.status=r.initstatus,delete r.initstatus,r.stop&&hn.splice(n--,1)):r.status=(r.prev+(r.percent-r.prev)*(i/s))/r.anim.top;if(i<0)continue;if(i<s){var b=u(i/s);for(var w in a)if(a[o](w)){switch(V[w]){case L:v=+a[w]+b*s*f[w];break;case"colour":v="rgb("+[vn(q(a[w].r+b*s*f[w].r)),vn(q(a[w].g+b*s*f[w].g)),vn(q(a[w].b+b*s*f[w].b))].join(",")+")";break;case"path":v=[];for(var E=0,S=a[w].length;E<S;E++){v[E]=[a[w][E][0]];for(var x=1,T=a[w][E].length;x<T;x++)v[E][x]=+a[w][E][x]+b*s*f[w][E][x];v[E]=v[E].join(m)}v=v.join(m);break;case"transform":if(f[w].real){v=[];for(E=0,S=a[w].length;E<S;E++){v[E]=[a[w][E][0]];for(x=1,T=a[w][E].length;x<T;x++)v[E][x]=a[w][E][x]+b*s*f[w][E][x]}}else{var N=function(e){return+a[w][e]+b*s*f[w][e]};v=[["m",N(0),N(1),N(2),N(3),N(4),N(5)]]}break;case"csv":if(w=="clip-rect"){v=[],E=4;while(E--)v[E]=+a[w][E]+b*s*f[w][E]}break;default:var C=[][p](a[w]);v=[],E=h.paper.customAttributes[w].length;while(E--)v[E]=+C[E]+b*s*f[w][E]}d[w]=v}h.attr(d),function(e,t,n){setTimeout(function(){eve("anim.frame."+e,t,n)})}(h.id,h,r.anim)}else{(function(t,n,r){setTimeout(function(){eve("anim.frame."+n.id,n,r),eve("anim.finish."+n.id,n,r),e.is(t,"function")&&t.call(n)})})(r.callback,h,r.anim),h.attr(l),hn.splice(n--,1);if(r.repeat>1&&!r.next){for(y in l)l[o](y)&&(g[y]=r.totalOrigin[y]);r.el.attr(g),yn(r.anim,r.el,r.anim.percents[0],null,r.totalOrigin,r.repeat-1)}r.next&&!r.stop&&yn(r.anim,r.el,r.next,null,r.totalOrigin,r.repeat)}}e.svg&&h&&h.paper&&h.paper.safari(),hn.length&&pn(dn)},vn=function(e){return e>255?255:e<0?0:e};Yt.animateWith=function(t,n,r,i,s,o){var u=r?e.animation(r,i,s,o):n,a=t.status(n);return this.animate(u).status(u,a*n.ms/u.ms)},Yt.onAnimation=function(e){return e?eve.on("anim.frame."+this.id,e):eve.unbind("anim.frame."+this.id),this},gn.prototype.delay=function(e){var t=new gn(this.anim,this.ms);return t.times=this.times,t.del=+e||0,t},gn.prototype.repeat=function(e){var t=new gn(this.anim,this.ms);return t.del=this.del,t.times=S.floor(x(e,0))||1,t},e.animation=function(t,n,r,i){if(t instanceof gn)return t;if(e.is(r,"function")||!r)i=i||r||null,r=null;t=Object(t),n=+n||0;var s={},u,a;for(a in t)t[o](a)&&U(a)!=a&&U(a)+"%"!=a&&(u=!0,s[a]=t[a]);return u?(r&&(s.easing=r),i&&(s.callback=i),new gn({100:s},n)):new gn(t,n)},Yt.animate=function(t,n,r,i){var s=this;if(s.removed)return i&&i.call(s),s;var o=t instanceof gn?t:e.animation(t,n,r,i);return yn(o,s,o.percents[0],null,s.attr()),s},Yt.setTime=function(e,t){return e&&t!=null&&this.status(e,T(t,e.ms)/e.ms),this},Yt.status=function(e,t){var n=[],r=0,i,s;if(t!=null)return yn(e,this,-1,T(t,1)),this;i=hn.length;for(;r<i;r++){s=hn[r];if(s.el.id==this.id&&(!e||s.anim==e)){if(e)return s.status;n.push({anim:s.anim,status:s.status})}}return e?0:n},Yt.pause=function(e){for(var t=0;t<hn.length;t++)hn[t].el.id==this.id&&(!e||hn[t].anim==e)&&eve("anim.pause."+this.id,this,hn[t].anim)!==!1&&(hn[t].paused=!0);return this},Yt.resume=function(e){for(var t=0;t<hn.length;t++)if(hn[t].el.id==this.id&&(!e||hn[t].anim==e)){var n=hn[t];eve("anim.resume."+this.id,this,n.anim)!==!1&&(delete n.paused,this.status(n.anim,n.status))}return this},Yt.stop=function(e){for(var t=0;t<hn.length;t++)hn[t].el.id==this.id&&(!e||hn[t].anim==e)&&eve("anim.stop."+this.id,this,hn[t].anim)!==!1&&hn.splice(t--,1);return this},Yt.toString=function(){return"Raphaël’s object"};var bn=function(e){this.items=[],this.length=0,this.type="set";if(e)for(var t=0,n=e.length;t<n;t++)e[t]&&(e[t].constructor==Yt.constructor||e[t].constructor==bn)&&(this[this.items.length]=this.items[this.items.length]=e[t],this.length++)},wn=bn.prototype;wn.push=function(){var e,t;for(var n=0,r=arguments.length;n<r;n++)e=arguments[n],e&&(e.constructor==Yt.constructor||e.constructor==bn)&&(t=this.items.length,this[t]=this.items[t]=e,this.length++);return this},wn.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},wn.forEach=function(e,t){for(var n=0,r=this.items.length;n<r;n++)if(e.call(t,this.items[n],n)===!1)return this;return this};for(var En in Yt)Yt[o](En)&&(wn[En]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e][h](n,t)})}}(En));wn.attr=function(t,n){if(t&&e.is(t,O)&&e.is(t[0],"object"))for(var r=0,i=t.length;r<i;r++)this.items[r].attr(t[r]);else for(var s=0,o=this.items.length;s<o;s++)this.items[s].attr(t,n);return this},wn.clear=function(){while(this.length)this.pop()},wn.splice=function(e,t,n){e=e<0?x(this.length+e,0):e,t=x(0,T(this.length-e,t));var r=[],i=[],s=[],o;for(o=2;o<arguments.length;o++)s.push(arguments[o]);for(o=0;o<t;o++)i.push(this[e+o]);for(;o<this.length-e;o++)r.push(this[e+o]);var u=s.length;for(o=0;o<u+r.length;o++)this.items[e+o]=this[e+o]=o<u?s[o]:r[o-u];o=this.items.length=this.length-=t-u;while(this[o])delete this[o++];return new bn(i)},wn.exclude=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]==e)return this.splice(t,1),!0},wn.animate=function(t,n,r,i){(e.is(r,"function")||!r)&&(i=r||null);var s=this.items.length,o=s,u,a=this,f;if(!s)return this;i&&(f=function(){!--s&&i.call(a)}),r=e.is(r,A)?r:f;var l=e.animation(t,n,r,f);u=this.items[--o].animate(l);while(o--)this.items[o]&&!this.items[o].removed&&this.items[o].animateWith(u,l);return this},wn.insertAfter=function(e){var t=this.items.length;while(t--)this.items[t].insertAfter(e);return this},wn.getBBox=function(){var e=[],t=[],n=[],r=[];for(var i=this.items.length;i--;)if(!this.items[i].removed){var s=this.items[i].getBBox();e.push(s.x),t.push(s.y),n.push(s.x+s.width),r.push(s.y+s.height)}return e=T[h](0,e),t=T[h](0,t),{x:e,y:t,width:x[h](0,n)-e,height:x[h](0,r)-t}},wn.clone=function(e){e=new bn;for(var t=0,n=this.items.length;t<n;t++)e.push(this.items[t].clone());return e},wn.toString=function(){return"Raphaël‘s set"},e.registerFont=function(e){if(!e.face)return e;this.fonts=this.fonts||{};var t={w:e.w,face:{},glyphs:{}},n=e.face["font-family"];for(var r in e.face)e.face[o](r)&&(t.face[r]=e.face[r]);this.fonts[n]?this.fonts[n].push(t):this.fonts[n]=[t];if(!e.svg){t.face["units-per-em"]=z(e.face["units-per-em"],10);for(var i in e.glyphs)if(e.glyphs[o](i)){var s=e.glyphs[i];t.glyphs[i]={w:s.w,k:{},d:s.d&&"M"+s.d.replace(/[mlcxtrv]/g,function(e){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[e]||"M"})+"z"};if(s.k)for(var u in s.k)s[o](u)&&(t.glyphs[i].k[u]=s.k[u])}}return e},l.getFont=function(t,n,r,i){i=i||"normal",r=r||"normal",n=+n||{normal:400,bold:700,lighter:300,bolder:800}[n]||400;if(!e.fonts)return;var s=e.fonts[t];if(!s){var u=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,v)+"(\\s|$)","i");for(var a in e.fonts)if(e.fonts[o](a)&&u.test(a)){s=e.fonts[a];break}}var f;if(s)for(var l=0,c=s.length;l<c;l++){f=s[l];if(f.face["font-weight"]==n&&(f.face["font-style"]==r||!f.face["font-style"])&&f.face["font-stretch"]==i)break}return f},l.print=function(t,r,i,s,o,u,a){u=u||"middle",a=x(T(a||0,1),-1);var f=this.set(),l=g(i)[y](v),c=0,h=v,p;e.is(s,i)&&(s=this.getFont(s));if(s){p=(o||16)/s.face["units-per-em"];var d=s.face.bbox[y](n),m=+d[0],b=+d[1]+(u=="baseline"?d[3]-d[1]+ +s.face.descent:(d[3]-d[1])/2);for(var w=0,E=l.length;w<E;w++){var S=w&&s.glyphs[l[w-1]]||{},N=s.glyphs[l[w]];c+=w?(S.w||s.w)+(S.k&&S.k[l[w]]||0)+s.w*a:0,N&&N.d&&f.push(this.path(N.d).attr({fill:"#000",stroke:"none",transform:[["t",c*p,0]]}))}f.transform(["...s",p,p,m,b,"t",(t-m)/p,(r-b)/p])}return f},l.add=function(t){if(e.is(t,"array")){var n=this.set(),i=0,s=t.length,u;for(;i<s;i++)u=t[i]||{},r[o](u.type)&&n.push(this[u.type]().attr(u))}return n},e.format=function(t,n){var r=e.is(n,O)?[0][p](n):arguments;return t&&e.is(t,A)&&r.length-1&&(t=t.replace(i,function(e,t){return r[++t]==null?v:r[t]})),t||v},e.fullfill=function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r){var i=r;return n.replace(t,function(e,t,n,r,s){t=t||r,i&&(t in i&&(i=i[t]),typeof i=="function"&&s&&(i=i()))}),i=(i==null||i==r?e:i)+"",i};return function(t,r){return String(t).replace(e,function(e,t){return n(e,t,r)})}}(),e.ninja=function(){return a.was?u.win.Raphael=a.is:delete Raphael,e},e.st=wn,function(t,n,r){function i(){/in/.test(t.readyState)?setTimeout(i,9):e.eve("DOMload")}t.readyState==null&&t.addEventListener&&(t.addEventListener(n,r=function(){t.removeEventListener(n,r,!1),t.readyState="complete"},!1),t.readyState="loading"),i()}(document,"DOMContentLoaded"),a.was?u.win.Raphael=e:Raphael=e,eve.on("DOMload",function(){t=!0})}(),window.Raphael.svg&&function(e){var t="hasOwnProperty",n=String,r=parseFloat,i=parseInt,s=Math,o=s.max,u=s.abs,a=s.pow,f=/[, ]+/,l=e.eve,c="",h=" ",p="http://www.w3.org/1999/xlink",d={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},v={};e.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var m=function(r,i){if(i){typeof r=="string"&&(r=m(r));for(var s in i)i[t](s)&&(s.substring(0,6)=="xlink:"?r.setAttributeNS(p,s.substring(6),n(i[s])):r.setAttribute(s,n(i[s])))}else r=e._g.doc.createElementNS("http://www.w3.org/2000/svg",r),r.style&&(r.style.webkitTapHighlightColor="rgba(0,0,0,0)");return r},g=function(t,i){var f="linear",l=t.id+i,h=.5,p=.5,d=t.node,v=t.paper,g=d.style,y=e._g.doc.getElementById(l);if(!y){i=n(i).replace(e._radial_gradient,function(e,t,n){f="radial";if(t&&n){h=r(t),p=r(n);var i=(p>.5)*2-1;a(h-.5,2)+a(p-.5,2)>.25&&(p=s.sqrt(.25-a(h-.5,2))*i+.5)&&p!=.5&&(p=p.toFixed(5)-1e-5*i)}return c}),i=i.split(/\s*\-\s*/);if(f=="linear"){var b=i.shift();b=-r(b);if(isNaN(b))return null;var w=[0,0,s.cos(e.rad(b)),s.sin(e.rad(b))],E=1/(o(u(w[2]),u(w[3]))||1);w[2]*=E,w[3]*=E,w[2]<0&&(w[0]=-w[2],w[2]=0),w[3]<0&&(w[1]=-w[3],w[3]=0)}var S=e._parseDots(i);if(!S)return null;l=l.replace(/[\(\)\s,\xb0#]/g,"_"),t.gradient&&l!=t.gradient.id&&(v.defs.removeChild(t.gradient),delete t.gradient);if(!t.gradient){y=m(f+"Gradient",{id:l}),t.gradient=y,m(y,f=="radial"?{fx:h,fy:p}:{x1:w[0],y1:w[1],x2:w[2],y2:w[3],gradientTransform:t.matrix.invert()}),v.defs.appendChild(y);for(var x=0,T=S.length;x<T;x++)y.appendChild(m("stop",{offset:S[x].offset?S[x].offset:x?"100%":"0%","stop-color":S[x].color||"#fff"}))}}return m(d,{fill:"url(#"+l+")",opacity:1,"fill-opacity":1}),g.fill=c,g.opacity=1,g.fillOpacity=1,1},y=function(e){var t=e.getBBox(1);m(e.pattern,{patternTransform:e.matrix.invert()+" translate("+t.x+","+t.y+")"})},b=function(r,i,s){if(r.type=="path"){var o=n(i).toLowerCase().split("-"),u=r.paper,a=s?"end":"start",f=r.node,l=r.attrs,c=l["stroke-width"],p=o.length,g="classic",y,b,w,E,S,x=3,T=3,N=5;while(p--)switch(o[p]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":g=o[p];break;case"wide":T=5;break;case"narrow":T=2;break;case"long":x=5;break;case"short":x=2}g=="open"?(x+=2,T+=2,N+=2,w=1,E=s?4:1,S={fill:"none",stroke:l.stroke}):(E=w=x/2,S={fill:l.stroke,stroke:"none"}),r._.arrows?s?(r._.arrows.endPath&&v[r._.arrows.endPath]--,r._.arrows.endMarker&&v[r._.arrows.endMarker]--):(r._.arrows.startPath&&v[r._.arrows.startPath]--,r._.arrows.startMarker&&v[r._.arrows.startMarker]--):r._.arrows={};if(g!="none"){var C="raphael-marker-"+g,k="raphael-marker-"+a+g+x+T;e._g.doc.getElementById(C)?v[C]++:(u.defs.appendChild(m(m("path"),{"stroke-linecap":"round",d:d[g],id:C})),v[C]=1);var L=e._g.doc.getElementById(k),A;L?(v[k]++,A=L.getElementsByTagName("use")[0]):(L=m(m("marker"),{id:k,markerHeight:T,markerWidth:x,orient:"auto",refX:E,refY:T/2}),A=m(m("use"),{"xlink:href":"#"+C,transform:(s?" rotate(180 "+x/2+" "+T/2+") ":h)+"scale("+x/N+","+T/N+")","stroke-width":1/((x/N+T/N)/2)}),L.appendChild(A),u.defs.appendChild(L),v[k]=1),m(A,S);var O=w*(g!="diamond"&&g!="oval");s?(y=r._.arrows.startdx*c||0,b=e.getTotalLength(l.path)-O*c):(y=O*c,b=e.getTotalLength(l.path)-(r._.arrows.enddx*c||0)),S={},S["marker-"+a]="url(#"+k+")";if(b||y)S.d=Raphael.getSubpath(l.path,y,b);m(f,S),r._.arrows[a+"Path"]=C,r._.arrows[a+"Marker"]=k,r._.arrows[a+"dx"]=O,r._.arrows[a+"Type"]=g,r._.arrows[a+"String"]=i}else s?(y=r._.arrows.startdx*c||0,b=e.getTotalLength(l.path)-y):(y=0,b=e.getTotalLength(l.path)-(r._.arrows.enddx*c||0)),r._.arrows[a+"Path"]&&m(f,{d:Raphael.getSubpath(l.path,y,b)}),delete r._.arrows[a+"Path"],delete r._.arrows[a+"Marker"],delete r._.arrows[a+"dx"],delete r._.arrows[a+"Type"],delete r._.arrows[a+"String"];for(S in v)if(v[t](S)&&!v[S]){var M=e._g.doc.getElementById(S);M&&M.parentNode.removeChild(M)}}},w={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},E=function(e,t,r){t=w[n(t).toLowerCase()];if(t){var i=e.attrs["stroke-width"]||"1",s={round:i,square:i,butt:0}[e.attrs["stroke-linecap"]||r["stroke-linecap"]]||0,o=[],u=t.length;while(u--)o[u]=t[u]*i+(u%2?1:-1)*s;m(e.node,{"stroke-dasharray":o.join(",")})}},S=function(r,s){var a=r.node,l=r.attrs,h=a.style.visibility;a.style.visibility="hidden";for(var d in s)if(s[t](d)){if(!e._availableAttrs[t](d))continue;var v=s[d];l[d]=v;switch(d){case"blur":r.blur(v);break;case"href":case"title":case"target":var w=a.parentNode;if(w.tagName.toLowerCase()!="a"){var S=m("a");w.insertBefore(S,a),S.appendChild(a),w=S}d=="target"&&v=="blank"?w.setAttributeNS(p,"show","new"):w.setAttributeNS(p,d,v);break;case"cursor":a.style.cursor=v;break;case"transform":r.transform(v);break;case"arrow-start":b(r,v);break;case"arrow-end":b(r,v,1);break;case"clip-rect":var x=n(v).split(f);if(x.length==4){r.clip&&r.clip.parentNode.parentNode.removeChild(r.clip.parentNode);var N=m("clipPath"),C=m("rect");N.id=e.createUUID(),m(C,{x:x[0],y:x[1],width:x[2],height:x[3]}),N.appendChild(C),r.paper.defs.appendChild(N),m(a,{"clip-path":"url(#"+N.id+")"}),r.clip=C}if(!v){var k=a.getAttribute("clip-path");if(k){var L=e._g.doc.getElementById(k.replace(/(^url\(#|\)$)/g,c));L&&L.parentNode.removeChild(L),m(a,{"clip-path":c}),delete r.clip}}break;case"path":r.type=="path"&&(m(a,{d:v?l.path=e._pathToAbsolute(v):"M0,0"}),r._.dirty=1,r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1)));break;case"width":a.setAttribute(d,v),r._.dirty=1;if(!l.fx)break;d="x",v=l.x;case"x":l.fx&&(v=-l.x-(l.width||0));case"rx":if(d=="rx"&&r.type=="rect")break;case"cx":a.setAttribute(d,v),r.pattern&&y(r),r._.dirty=1;break;case"height":a.setAttribute(d,v),r._.dirty=1;if(!l.fy)break;d="y",v=l.y;case"y":l.fy&&(v=-l.y-(l.height||0));case"ry":if(d=="ry"&&r.type=="rect")break;case"cy":a.setAttribute(d,v),r.pattern&&y(r),r._.dirty=1;break;case"r":r.type=="rect"?m(a,{rx:v,ry:v}):a.setAttribute(d,v),r._.dirty=1;break;case"src":r.type=="image"&&a.setAttributeNS(p,"href",v);break;case"stroke-width":if(r._.sx!=1||r._.sy!=1)v/=o(u(r._.sx),u(r._.sy))||1;r.paper._vbSize&&(v*=r.paper._vbSize),a.setAttribute(d,v),l["stroke-dasharray"]&&E(r,l["stroke-dasharray"],s),r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1));break;case"stroke-dasharray":E(r,v,s);break;case"fill":var A=n(v).match(e._ISURL);if(A){N=m("pattern");var O=m("image");N.id=e.createUUID(),m(N,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),m(O,{x:0,y:0,"xlink:href":A[1]}),N.appendChild(O),function(t){e._preload(A[1],function(){var e=this.offsetWidth,n=this.offsetHeight;m(t,{width:e,height:n}),m(O,{width:e,height:n}),r.paper.safari()})}(N),r.paper.defs.appendChild(N),a.style.fill="url(#"+N.id+")",m(a,{fill:"url(#"+N.id+")"}),r.pattern=N,r.pattern&&y(r);break}var M=e.getRGB(v);if(!M.error)delete s.gradient,delete l.gradient,!e.is(l.opacity,"undefined")&&e.is(s.opacity,"undefined")&&m(a,{opacity:l.opacity}),!e.is(l["fill-opacity"],"undefined")&&e.is(s["fill-opacity"],"undefined")&&m(a,{"fill-opacity":l["fill-opacity"]});else if((r.type=="circle"||r.type=="ellipse"||n(v).charAt()!="r")&&g(r,v)){if("opacity"in l||"fill-opacity"in l){var _=e._g.doc.getElementById(a.getAttribute("fill").replace(/^url\(#|\)$/g,c));if(_){var D=_.getElementsByTagName("stop");m(D[D.length-1],{"stop-opacity":("opacity"in l?l.opacity:1)*("fill-opacity"in l?l["fill-opacity"]:1)})}}l.gradient=v,l.fill="none";break}M[t]("opacity")&&m(a,{"fill-opacity":M.opacity>1?M.opacity/100:M.opacity});case"stroke":M=e.getRGB(v),a.setAttribute(d,M.hex),d=="stroke"&&M[t]("opacity")&&m(a,{"stroke-opacity":M.opacity>1?M.opacity/100:M.opacity}),d=="stroke"&&r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1));break;case"gradient":(r.type=="circle"||r.type=="ellipse"||n(v).charAt()!="r")&&g(r,v);break;case"opacity":l.gradient&&!l[t]("stroke-opacity")&&m(a,{"stroke-opacity":v>1?v/100:v});case"fill-opacity":if(l.gradient){_=e._g.doc.getElementById(a.getAttribute("fill").replace(/^url\(#|\)$/g,c)),_&&(D=_.getElementsByTagName("stop"),m(D[D.length-1],{"stop-opacity":v}));break};default:d=="font-size"&&(v=i(v,10)+"px");var P=d.replace(/(\-.)/g,function(e){return e.substring(1).toUpperCase()});a.style[P]=v,r._.dirty=1,a.setAttribute(d,v)}}T(r,s),a.style.visibility=h},x=1.2,T=function(r,s){if(r.type!="text"||!(s[t]("text")||s[t]("font")||s[t]("font-size")||s[t]("x")||s[t]("y")))return;var o=r.attrs,u=r.node,a=u.firstChild?i(e._g.doc.defaultView.getComputedStyle(u.firstChild,c).getPropertyValue("font-size"),10):10;if(s[t]("text")){o.text=s.text;while(u.firstChild)u.removeChild(u.firstChild);var f=n(s.text).split("\n"),l=[],h;for(var p=0,d=f.length;p<d;p++)h=m("tspan"),p&&m(h,{dy:a*x,x:o.x}),h.appendChild(e._g.doc.createTextNode(f[p])),u.appendChild(h),l[p]=h}else{l=u.getElementsByTagName("tspan");for(p=0,d=l.length;p<d;p++)p?m(l[p],{dy:a*x,x:o.x}):m(l[0],{dy:0})}m(u,{x:o.x,y:o.y}),r._.dirty=1;var v=r._getBBox(),g=o.y-(v.y+v.height/2);g&&e.is(g,"finite")&&m(l[0],{dy:g})},N=function(t,n){var r=0,i=0;this[0]=this.node=t,t.raphael=!0,this.id=e._oid++,t.raphaelid=this.id,this.matrix=e.matrix(),this.realPath=null,this.paper=n,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},C=e.el;N.prototype=C,C.constructor=N,e._engine.path=function(e,t){var n=m("path");t.canvas&&t.canvas.appendChild(n);var r=new N(n,t);return r.type="path",S(r,{fill:"none",stroke:"#000",path:e}),r},C.rotate=function(e,t,i){if(this.removed)return this;e=n(e).split(f),e.length-1&&(t=r(e[1]),i=r(e[2])),e=r(e[0]),i==null&&(t=i);if(t==null||i==null){var s=this.getBBox(1);t=s.x+s.width/2,i=s.y+s.height/2}return this.transform(this._.transform.concat([["r",e,t,i]])),this},C.scale=function(e,t,i,s){if(this.removed)return this;e=n(e).split(f),e.length-1&&(t=r(e[1]),i=r(e[2]),s=r(e[3])),e=r(e[0]),t==null&&(t=e),s==null&&(i=s);if(i==null||s==null)var o=this.getBBox(1);return i=i==null?o.x+o.width/2:i,s=s==null?o.y+o.height/2:s,this.transform(this._.transform.concat([["s",e,t,i,s]])),this},C.translate=function(e,t){return this.removed?this:(e=n(e).split(f),e.length-1&&(t=r(e[1])),e=r(e[0])||0,t=+t||0,this.transform(this._.transform.concat([["t",e,t]])),this)},C.transform=function(n){var r=this._;if(n==null)return r.transform;e._extractTransform(this,n),this.clip&&m(this.clip,{transform:this.matrix.invert()}),this.pattern&&y(this),this.node&&m(this.node,{transform:this.matrix});if(r.sx!=1||r.sy!=1){var i=this.attrs[t]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":i})}return this},C.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},C.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},C.remove=function(){if(this.removed)return;var t=this.paper;t.__set__&&t.__set__.exclude(this),l.unbind("*.*."+this.id),this.gradient&&t.defs.removeChild(this.gradient),e._tear(this,t),this.node.parentNode.removeChild(this.node);for(var n in this)this[n]=typeof this[n]=="function"?e._removedFactory(n):null;this.removed=!0},C._getBBox=function(){if(this.node.style.display=="none"){this.show();var e=!0}var t={};try{t=this.node.getBBox()}catch(n){}finally{t=t||{}}return e&&this.hide(),t},C.attr=function(n,r){if(this.removed)return this;if(n==null){var i={};for(var s in this.attrs)this.attrs[t](s)&&(i[s]=this.attrs[s]);return i.gradient&&i.fill=="none"&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(r==null&&e.is(n,"string")){if(n=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;if(n=="transform")return this._.transform;var o=n.split(f),u={};for(var a=0,c=o.length;a<c;a++)n=o[a],n in this.attrs?u[n]=this.attrs[n]:e.is(this.paper.customAttributes[n],"function")?u[n]=this.paper.customAttributes[n].def:u[n]=e._availableAttrs[n];return c-1?u:u[o[0]]}if(r==null&&e.is(n,"array")){u={};for(a=0,c=n.length;a<c;a++)u[n[a]]=this.attr(n[a]);return u}if(r!=null){var h={};h[n]=r}else n!=null&&e.is(n,"object")&&(h=n);for(var p in h)l("attr."+p+"."+this.id,this,h[p]);for(p in this.paper.customAttributes)if(this.paper.customAttributes[t](p)&&h[t](p)&&e.is(this.paper.customAttributes[p],"function")){var d=this.paper.customAttributes[p].apply(this,[].concat(h[p]));this.attrs[p]=h[p];for(var v in d)d[t](v)&&(h[v]=d[v])}return S(this,h),this},C.toFront=function(){if(this.removed)return this;this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var t=this.paper;return t.top!=this&&e._tofront(this,t),this},C.toBack=function(){if(this.removed)return this;var t=this.node.parentNode;t.tagName.toLowerCase()=="a"?t.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):t.firstChild!=this.node&&t.insertBefore(this.node,this.node.parentNode.firstChild),e._toback(this,this.paper);var n=this.paper;return this},C.insertAfter=function(t){if(this.removed)return this;var n=t.node||t[t.length-1].node;return n.nextSibling?n.parentNode.insertBefore(this.node,n.nextSibling):n.parentNode.appendChild(this.node),e._insertafter(this,t,this.paper),this},C.insertBefore=function(t){if(this.removed)return this;var n=t.node||t[0].node;return n.parentNode.insertBefore(this.node,n),e._insertbefore(this,t,this.paper),this},C.blur=function(t){var n=this;if(+t!==0){var r=m("filter"),i=m("feGaussianBlur");n.attrs.blur=t,r.id=e.createUUID(),m(i,{stdDeviation:+t||1.5}),r.appendChild(i),n.paper.defs.appendChild(r),n._blur=r,m(n.node,{filter:"url(#"+r.id+")"})}else n._blur&&(n._blur.parentNode.removeChild(n._blur),delete n._blur,delete n.attrs.blur),n.node.removeAttribute("filter")},e._engine.circle=function(e,t,n,r){var i=m("circle");e.canvas&&e.canvas.appendChild(i);var s=new N(i,e);return s.attrs={cx:t,cy:n,r:r,fill:"none",stroke:"#000"},s.type="circle",m(i,s.attrs),s},e._engine.rect=function(e,t,n,r,i,s){var o=m("rect");e.canvas&&e.canvas.appendChild(o);var u=new N(o,e);return u.attrs={x:t,y:n,width:r,height:i,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},u.type="rect",m(o,u.attrs),u},e._engine.ellipse=function(e,t,n,r,i){var s=m("ellipse");e.canvas&&e.canvas.appendChild(s);var o=new N(s,e);return o.attrs={cx:t,cy:n,rx:r,ry:i,fill:"none",stroke:"#000"},o.type="ellipse",m(s,o.attrs),o},e._engine.image=function(e,t,n,r,i,s){var o=m("image");m(o,{x:n,y:r,width:i,height:s,preserveAspectRatio:"none"}),o.setAttributeNS(p,"href",t),e.canvas&&e.canvas.appendChild(o);var u=new N(o,e);return u.attrs={x:n,y:r,width:i,height:s,src:t},u.type="image",u},e._engine.text=function(t,n,r,i){var s=m("text");t.canvas&&t.canvas.appendChild(s);var o=new N(s,t);return o.attrs={x:n,y:r,"text-anchor":"middle",text:i,font:e._availableAttrs.font,stroke:"none",fill:"#000"},o.type="text",S(o,o.attrs),o},e._engine.setSize=function(e,t){return this.width=e||this.width,this.height=t||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},e._engine.create=function(){var t=e._getContainer.apply(0,arguments),n=t&&t.container,r=t.x,i=t.y,s=t.width,o=t.height;if(!n)throw new Error("SVG container not found.");var u=m("svg"),a="overflow:hidden;",f;return r=r||0,i=i||0,s=s||512,o=o||342,m(u,{height:o,version:1.1,width:s,xmlns:"http://www.w3.org/2000/svg"}),n==1?(u.style.cssText=a+"position:absolute;left:"+r+"px;top:"+i+"px",e._g.doc.body.appendChild(u),f=1):(u.style.cssText=a+"position:relative",n.firstChild?n.insertBefore(u,n.firstChild):n.appendChild(u)),n=new e._Paper,n.width=s,n.height=o,n.canvas=u,n.clear(),n._left=n._top=0,f&&(n.renderfix=function(){}),n.renderfix(),n},e._engine.setViewBox=function(e,t,n,r,i){l("setViewBox",this,this._viewBox,[e,t,n,r,i]);var s=o(n/this.width,r/this.height),u=this.top,a=i?"meet":"xMinYMin",f,c;e==null?(this._vbSize&&(s=1),delete this._vbSize,f="0 0 "+this.width+h+this.height):(this._vbSize=s,f=e+h+t+h+n+h+r),m(this.canvas,{viewBox:f,preserveAspectRatio:a});while(s&&u)c="stroke-width"in u.attrs?u.attrs["stroke-width"]:1,u.attr({"stroke-width":c}),u._.dirty=1,u._.dirtyT=1,u=u.prev;return this._viewBox=[e,t,n,r,!!i],this},e.prototype.renderfix=function(){var e=this.canvas,t=e.style,n=e.getScreenCTM()||e.createSVGMatrix(),r=-n.e%1,i=-n.f%1;if(r||i)r&&(this._left=(this._left+r)%1,t.left=this._left+"px"),i&&(this._top=(this._top+i)%1,t.top=this._top+"px")},e.prototype.clear=function(){e.eve("clear",this);var t=this.canvas;while(t.firstChild)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=m("desc")).appendChild(e._g.doc.createTextNode("Created with Raphaël "+e.version)),t.appendChild(this.desc),t.appendChild(this.defs=m("defs"))},e.prototype.remove=function(){l("remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=typeof this[t]=="function"?e._removedFactory(t):null};var k=e.st;for(var L in C)C[t](L)&&!k[t](L)&&(k[L]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e].apply(n,t)})}}(L))}(window.Raphael),window.Raphael.vml&&function(e){var t="hasOwnProperty",n=String,r=parseFloat,i=Math,s=i.round,o=i.max,u=i.min,a=i.abs,f="fill",l=/[, ]+/,c=e.eve,h=" progid:DXImageTransform.Microsoft",p=" ",d="",v={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,g=/ progid:\S+Blur\([^\)]+\)/g,y=/-?[^,\s-]+/g,b="position:absolute;left:0;top:0;width:1px;height:1px",w=21600,E={path:1,rect:1,image:1},S={circle:1,ellipse:1},x=function(t){var r=/[ahqstv]/ig,i=e._pathToAbsolute;n(t).match(r)&&(i=e._path2curve),r=/[clmz]/g;if(i==e._pathToAbsolute&&!n(t).match(r)){var o=n(t).replace(m,function(e,t,n){var r=[],i=t.toLowerCase()=="m",o=v[t];return n.replace(y,function(e){i&&r.length==2&&(o+=r+v[t=="m"?"l":"L"],r=[]),r.push(s(e*w))}),o+r});return o}var u=i(t),a,f;o=[];for(var l=0,c=u.length;l<c;l++){a=u[l],f=u[l][0].toLowerCase(),f=="z"&&(f="x");for(var h=1,g=a.length;h<g;h++)f+=s(a[h]*w)+(h!=g-1?",":d);o.push(f)}return o.join(p)},T=function(t,n,r){var i=e.matrix();return i.rotate(-t,.5,.5),{dx:i.x(n,r),dy:i.y(n,r)}},N=function(e,t,n,r,i,s){var o=e._,u=e.matrix,l=o.fillpos,c=e.node,h=c.style,d=1,v="",m,g=w/t,y=w/n;h.visibility="hidden";if(!t||!n)return;c.coordsize=a(g)+p+a(y),h.rotation=s*(t*n<0?-1:1);if(s){var b=T(s,r,i);r=b.dx,i=b.dy}t<0&&(v+="x"),n<0&&(v+=" y")&&(d=-1),h.flip=v,c.coordorigin=r*-g+p+i*-y;if(l||o.fillsize){var E=c.getElementsByTagName(f);E=E&&E[0],c.removeChild(E),l&&(b=T(s,u.x(l[0],l[1]),u.y(l[0],l[1])),E.position=b.dx*d+p+b.dy*d),o.fillsize&&(E.size=o.fillsize[0]*a(t)+p+o.fillsize[1]*a(n)),c.appendChild(E)}h.visibility="visible"};e.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var C=function(e,t,r){var i=n(t).toLowerCase().split("-"),s=r?"end":"start",o=i.length,u="classic",a="medium",f="medium";while(o--)switch(i[o]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":u=i[o];break;case"wide":case"narrow":f=i[o];break;case"long":case"short":a=i[o]}var l=e.node.getElementsByTagName("stroke")[0];l[s+"arrow"]=u,l[s+"arrowlength"]=a,l[s+"arrowwidth"]=f},k=function(i,a){i.attrs=i.attrs||{};var c=i.node,h=i.attrs,v=c.style,m,g=E[i.type]&&(a.x!=h.x||a.y!=h.y||a.width!=h.width||a.height!=h.height||a.cx!=h.cx||a.cy!=h.cy||a.rx!=h.rx||a.ry!=h.ry||a.r!=h.r),y=S[i.type]&&(h.cx!=a.cx||h.cy!=a.cy||h.r!=a.r||h.rx!=a.rx||h.ry!=a.ry),b=i;for(var T in a)a[t](T)&&(h[T]=a[T]);g&&(h.path=e._getPath[i.type](i),i._.dirty=1),a.href&&(c.href=a.href),a.title&&(c.title=a.title),a.target&&(c.target=a.target),a.cursor&&(v.cursor=a.cursor),"blur"in a&&i.blur(a.blur);if(a.path&&i.type=="path"||g)c.path=x(~n(h.path).toLowerCase().indexOf("r")?e._pathToAbsolute(h.path):h.path),i.type=="image"&&(i._.fillpos=[h.x,h.y],i._.fillsize=[h.width,h.height],N(i,1,1,0,0,0));"transform"in a&&i.transform(a.transform);if(y){var k=+h.cx,A=+h.cy,O=+h.rx||+h.r||0,_=+h.ry||+h.r||0;c.path=e.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",s((k-O)*w),s((A-_)*w),s((k+O)*w),s((A+_)*w),s(k*w))}if("clip-rect"in a){var D=n(a["clip-rect"]).split(l);if(D.length==4){D[2]=+D[2]+ +D[0],D[3]=+D[3]+ +D[1];var P=c.clipRect||e._g.doc.createElement("div"),H=P.style;H.clip=e.format("rect({1}px {2}px {3}px {0}px)",D),c.clipRect||(H.position="absolute",H.top=0,H.left=0,H.width=i.paper.width+"px",H.height=i.paper.height+"px",c.parentNode.insertBefore(P,c),P.appendChild(c),c.clipRect=P)}a["clip-rect"]||c.clipRect&&(c.clipRect.style.clip="auto")}if(i.textpath){var B=i.textpath.style;a.font&&(B.font=a.font),a["font-family"]&&(B.fontFamily='"'+a["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,d)+'"'),a["font-size"]&&(B.fontSize=a["font-size"]),a["font-weight"]&&(B.fontWeight=a["font-weight"]),a["font-style"]&&(B.fontStyle=a["font-style"])}"arrow-start"in a&&C(b,a["arrow-start"]),"arrow-end"in a&&C(b,a["arrow-end"],1);if(a.opacity!=null||a["stroke-width"]!=null||a.fill!=null||a.src!=null||a.stroke!=null||a["stroke-width"]!=null||a["stroke-opacity"]!=null||a["fill-opacity"]!=null||a["stroke-dasharray"]!=null||a["stroke-miterlimit"]!=null||a["stroke-linejoin"]!=null||a["stroke-linecap"]!=null){var j=c.getElementsByTagName(f),F=!1;j=j&&j[0],!j&&(F=j=M(f)),i.type=="image"&&a.src&&(j.src=a.src),a.fill&&(j.on=!0);if(j.on==null||a.fill=="none"||a.fill===null)j.on=!1;if(j.on&&a.fill){var I=n(a.fill).match(e._ISURL);if(I){j.parentNode==c&&c.removeChild(j),j.rotate=!0,j.src=I[1],j.type="tile";var q=i.getBBox(1);j.position=q.x+p+q.y,i._.fillpos=[q.x,q.y],e._preload(I[1],function(){i._.fillsize=[this.offsetWidth,this.offsetHeight]})}else j.color=e.getRGB(a.fill).hex,j.src=d,j.type="solid",e.getRGB(a.fill).error&&(b.type in{circle:1,ellipse:1}||n(a.fill).charAt()!="r")&&L(b,a.fill,j)&&(h.fill="none",h.gradient=a.fill,j.rotate=!1)}if("fill-opacity"in a||"opacity"in a){var U=((+h["fill-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+e.getRGB(a.fill).o+1||2)-1);U=u(o(U,0),1),j.opacity=U,j.src&&(j.color="none")}c.appendChild(j);var z=c.getElementsByTagName("stroke")&&c.getElementsByTagName("stroke")[0],W=!1;!z&&(W=z=M("stroke"));if(a.stroke&&a.stroke!="none"||a["stroke-width"]||a["stroke-opacity"]!=null||a["stroke-dasharray"]||a["stroke-miterlimit"]||a["stroke-linejoin"]||a["stroke-linecap"])z.on=!0;(a.stroke=="none"||a.stroke===null||z.on==null||a.stroke==0||a["stroke-width"]==0)&&(z.on=!1);var X=e.getRGB(a.stroke);z.on&&a.stroke&&(z.color=X.hex),U=((+h["stroke-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+X.o+1||2)-1);var V=(r(a["stroke-width"])||1)*.75;U=u(o(U,0),1),a["stroke-width"]==null&&(V=h["stroke-width"]),a["stroke-width"]&&(z.weight=V),V&&V<1&&(U*=V)&&(z.weight=1),z.opacity=U,a["stroke-linejoin"]&&(z.joinstyle=a["stroke-linejoin"]||"miter"),z.miterlimit=a["stroke-miterlimit"]||8,a["stroke-linecap"]&&(z.endcap=a["stroke-linecap"]=="butt"?"flat":a["stroke-linecap"]=="square"?"square":"round");if(a["stroke-dasharray"]){var $={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};z.dashstyle=$[t](a["stroke-dasharray"])?$[a["stroke-dasharray"]]:d}W&&c.appendChild(z)}if(b.type=="text"){b.paper.canvas.style.display=d;var J=b.paper.span,K=100,Q=h.font&&h.font.match(/\d+(?:\.\d*)?(?=px)/);v=J.style,h.font&&(v.font=h.font),h["font-family"]&&(v.fontFamily=h["font-family"]),h["font-weight"]&&(v.fontWeight=h["font-weight"]),h["font-style"]&&(v.fontStyle=h["font-style"]),Q=r(h["font-size"]||Q&&Q[0])||10,v.fontSize=Q*K+"px",b.textpath.string&&(J.innerHTML=n(b.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var G=J.getBoundingClientRect();b.W=h.w=(G.right-G.left)/K,b.H=h.h=(G.bottom-G.top)/K,b.X=h.x,b.Y=h.y+b.H/2,("x"in a||"y"in a)&&(b.path.v=e.format("m{0},{1}l{2},{1}",s(h.x*w),s(h.y*w),s(h.x*w)+1));var Y=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var Z=0,et=Y.length;Z<et;Z++)if(Y[Z]in a){b._.dirty=1;break}switch(h["text-anchor"]){case"start":b.textpath.style["v-text-align"]="left",b.bbx=b.W/2;break;case"end":b.textpath.style["v-text-align"]="right",b.bbx=-b.W/2;break;default:b.textpath.style["v-text-align"]="center",b.bbx=0}b.textpath.style["v-text-kern"]=!0}},L=function(t,s,o){t.attrs=t.attrs||{};var u=t.attrs,a=Math.pow,f,l,c="linear",h=".5 .5";t.attrs.gradient=s,s=n(s).replace(e._radial_gradient,function(e,t,n){return c="radial",t&&n&&(t=r(t),n=r(n),a(t-.5,2)+a(n-.5,2)>.25&&(n=i.sqrt(.25-a(t-.5,2))*((n>.5)*2-1)+.5),h=t+p+n),d}),s=s.split(/\s*\-\s*/);if(c=="linear"){var v=s.shift();v=-r(v);if(isNaN(v))return null}var m=e._parseDots(s);if(!m)return null;t=t.shape||t.node;if(m.length){t.removeChild(o),o.on=!0,o.method="none",o.color=m[0].color,o.color2=m[m.length-1].color;var g=[];for(var y=0,b=m.length;y<b;y++)m[y].offset&&g.push(m[y].offset+p+m[y].color);o.colors=g.length?g.join():"0% "+o.color,c=="radial"?(o.type="gradientTitle",o.focus="100%",o.focussize="0 0",o.focusposition=h,o.angle=0):(o.type="gradient",o.angle=(270-v)%360),t.appendChild(o)}return 1},A=function(t,n){this[0]=this.node=t,t.raphael=!0,this.id=e._oid++,t.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=n,this.matrix=e.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},O=e.el;A.prototype=O,O.constructor=A,O.transform=function(t){if(t==null)return this._.transform;var r=this.paper._viewBoxShift,i=r?"s"+[r.scale,r.scale]+"-1-1t"+[r.dx,r.dy]:d,s;r&&(s=t=n(t).replace(/\.{3}|\u2026/g,this._.transform||d)),e._extractTransform(this,i+t);var o=this.matrix.clone(),u=this.skew,a=this.node,f,l=~n(this.attrs.fill).indexOf("-"),c=!n(this.attrs.fill).indexOf("url(");o.translate(-0.5,-0.5);if(c||l||this.type=="image"){u.matrix="1 0 0 1",u.offset="0 0",f=o.split();if(l&&f.noRotation||!f.isSimple){a.style.filter=o.toFilter();var h=this.getBBox(),v=this.getBBox(1),m=h.x-v.x,g=h.y-v.y;a.coordorigin=m*-w+p+g*-w,N(this,1,1,m,g,0)}else a.style.filter=d,N(this,f.scalex,f.scaley,f.dx,f.dy,f.rotate)}else a.style.filter=d,u.matrix=n(o),u.offset=o.offset();return s&&(this._.transform=s),this},O.rotate=function(e,t,i){if(this.removed)return this;if(e==null)return;e=n(e).split(l),e.length-1&&(t=r(e[1]),i=r(e[2])),e=r(e[0]),i==null&&(t=i);if(t==null||i==null){var s=this.getBBox(1);t=s.x+s.width/2,i=s.y+s.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",e,t,i]])),this},O.translate=function(e,t){return this.removed?this:(e=n(e).split(l),e.length-1&&(t=r(e[1])),e=r(e[0])||0,t=+t||0,this._.bbox&&(this._.bbox.x+=e,this._.bbox.y+=t),this.transform(this._.transform.concat([["t",e,t]])),this)},O.scale=function(e,t,i,s){if(this.removed)return this;e=n(e).split(l),e.length-1&&(t=r(e[1]),i=r(e[2]),s=r(e[3]),isNaN(i)&&(i=null),isNaN(s)&&(s=null)),e=r(e[0]),t==null&&(t=e),s==null&&(i=s);if(i==null||s==null)var o=this.getBBox(1);return i=i==null?o.x+o.width/2:i,s=s==null?o.y+o.height/2:s,this.transform(this._.transform.concat([["s",e,t,i,s]])),this._.dirtyT=1,this},O.hide=function(){return!this.removed&&(this.node.style.display="none"),this},O.show=function(){return!this.removed&&(this.node.style.display=d),this},O._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},O.remove=function(){if(this.removed)return;this.paper.__set__&&this.paper.__set__.exclude(this),e.eve.unbind("*.*."+this.id),e._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)this[t]=typeof this[t]=="function"?e._removedFactory(t):null;this.removed=!0},O.attr=function(n,r){if(this.removed)return this;if(n==null){var i={};for(var s in this.attrs)this.attrs[t](s)&&(i[s]=this.attrs[s]);return i.gradient&&i.fill=="none"&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(r==null&&e.is(n,"string")){if(n==f&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;var o=n.split(l),u={};for(var a=0,h=o.length;a<h;a++)n=o[a],n in this.attrs?u[n]=this.attrs[n]:e.is(this.paper.customAttributes[n],"function")?u[n]=this.paper.customAttributes[n].def:u[n]=e._availableAttrs[n];return h-1?u:u[o[0]]}if(this.attrs&&r==null&&e.is(n,"array")){u={};for(a=0,h=n.length;a<h;a++)u[n[a]]=this.attr(n[a]);return u}var p;r!=null&&(p={},p[n]=r),r==null&&e.is(n,"object")&&(p=n);for(var d in p)c("attr."+d+"."+this.id,this,p[d]);if(p){for(d in this.paper.customAttributes)if(this.paper.customAttributes[t](d)&&p[t](d)&&e.is(this.paper.customAttributes[d],"function")){var v=this.paper.customAttributes[d].apply(this,[].concat(p[d]));this.attrs[d]=p[d];for(var m in v)v[t](m)&&(p[m]=v[m])}p.text&&this.type=="text"&&(this.textpath.string=p.text),k(this,p)}return this},O.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&e._tofront(this,this.paper),this},O.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),e._toback(this,this.paper)),this)},O.insertAfter=function(t){return this.removed?this:(t.constructor==e.st.constructor&&(t=t[t.length-1]),t.node.nextSibling?t.node.parentNode.insertBefore(this.node,t.node.nextSibling):t.node.parentNode.appendChild(this.node),e._insertafter(this,t,this.paper),this)},O.insertBefore=function(t){return this.removed?this:(t.constructor==e.st.constructor&&(t=t[0]),t.node.parentNode.insertBefore(this.node,t.node),e._insertbefore(this,t,this.paper),this)},O.blur=function(t){var n=this.node.runtimeStyle,r=n.filter;r=r.replace(g,d),+t!==0?(this.attrs.blur=t,n.filter=r+p+h+".Blur(pixelradius="+(+t||1.5)+")",n.margin=e.format("-{0}px 0 0 -{0}px",s(+t||1.5))):(n.filter=r,n.margin=0,delete this.attrs.blur)},e._engine.path=function(e,t){var n=M("shape");n.style.cssText=b,n.coordsize=w+p+w,n.coordorigin=t.coordorigin;var r=new A(n,t),i={fill:"none",stroke:"#000"};e&&(i.path=e),r.type="path",r.path=[],r.Path=d,k(r,i),t.canvas.appendChild(n);var s=M("skew");return s.on=!0,n.appendChild(s),r.skew=s,r.transform(d),r},e._engine.rect=function(t,n,r,i,s,o){var u=e._rectPath(n,r,i,s,o),a=t.path(u),f=a.attrs;return a.X=f.x=n,a.Y=f.y=r,a.W=f.width=i,a.H=f.height=s,f.r=o,f.path=u,a.type="rect",a},e._engine.ellipse=function(e,t,n,r,i){var s=e.path(),o=s.attrs;return s.X=t-r,s.Y=n-i,s.W=r*2,s.H=i*2,s.type="ellipse",k(s,{cx:t,cy:n,rx:r,ry:i}),s},e._engine.circle=function(e,t,n,r){var i=e.path(),s=i.attrs;return i.X=t-r,i.Y=n-r,i.W=i.H=r*2,i.type="circle",k(i,{cx:t,cy:n,r:r}),i},e._engine.image=function(t,n,r,i,s,o){var u=e._rectPath(r,i,s,o),a=t.path(u).attr({stroke:"none"}),l=a.attrs,c=a.node,h=c.getElementsByTagName(f)[0];return l.src=n,a.X=l.x=r,a.Y=l.y=i,a.W=l.width=s,a.H=l.height=o,l.path=u,a.type="image",h.parentNode==c&&c.removeChild(h),h.rotate=!0,h.src=n,h.type="tile",a._.fillpos=[r,i],a._.fillsize=[s,o],c.appendChild(h),N(a,1,1,0,0,0),a},e._engine.text=function(t,r,i,o){var u=M("shape"),a=M("path"),f=M("textpath");r=r||0,i=i||0,o=o||"",a.v=e.format("m{0},{1}l{2},{1}",s(r*w),s(i*w),s(r*w)+1),a.textpathok=!0,f.string=n(o),f.on=!0,u.style.cssText=b,u.coordsize=w+p+w,u.coordorigin="0 0";var l=new A(u,t),c={fill:"#000",stroke:"none",font:e._availableAttrs.font,text:o};l.shape=u,l.path=a,l.textpath=f,l.type="text",l.attrs.text=n(o),l.attrs.x=r,l.attrs.y=i,l.attrs.w=1,l.attrs.h=1,k(l,c),u.appendChild(f),u.appendChild(a),t.canvas.appendChild(u);var h=M("skew");return h.on=!0,u.appendChild(h),l.skew=h,l.transform(d),l},e._engine.setSize=function(t,n){var r=this.canvas.style;return this.width=t,this.height=n,t==+t&&(t+="px"),n==+n&&(n+="px"),r.width=t,r.height=n,r.clip="rect(0 "+t+" "+n+" 0)",this._viewBox&&e._engine.setViewBox.apply(this,this._viewBox),this},e._engine.setViewBox=function(t,n,r,i,s){e.eve("setViewBox",this,this._viewBox,[t,n,r,i,s]);var u=this.width,a=this.height,f=1/o(r/u,i/a),l,c;return s&&(l=a/i,c=u/r,r*l<u&&(t-=(u-r*l)/2/l),i*c<a&&(n-=(a-i*c)/2/c)),this._viewBox=[t,n,r,i,!!s],this._viewBoxShift={dx:-t,dy:-n,scale:f},this.forEach(function(e){e.transform("...")}),this};var M;e._engine.initWin=function(e){var t=e.document;t.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!t.namespaces.rvml&&t.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),M=function(e){return t.createElement("<rvml:"+e+' class="rvml">')}}catch(n){M=function(e){return t.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},e._engine.initWin(e._g.win),e._engine.create=function(){var t=e._getContainer.apply(0,arguments),n=t.container,r=t.height,i,s=t.width,o=t.x,u=t.y;if(!n)throw new Error("VML container not found.");var a=new e._Paper,f=a.canvas=e._g.doc.createElement("div"),l=f.style;return o=o||0,u=u||0,s=s||512,r=r||342,a.width=s,a.height=r,s==+s&&(s+="px"),r==+r&&(r+="px"),a.coordsize=w*1e3+p+w*1e3,a.coordorigin="0 0",a.span=e._g.doc.createElement("span"),a.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",f.appendChild(a.span),l.cssText=e.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",s,r),n==1?(e._g.doc.body.appendChild(f),l.left=o+"px",l.top=u+"px",l.position="absolute"):n.firstChild?n.insertBefore(f,n.firstChild):n.appendChild(f),a.renderfix=function(){},a},e.prototype.clear=function(){e.eve("clear",this),this.canvas.innerHTML=d,this.span=e._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},e.prototype.remove=function(){e.eve("remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=typeof this[t]=="function"?e._removedFactory(t):null;return!0};var _=e.st;for(var D in O)O[t](D)&&!_[t](D)&&(_[D]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e].apply(n,t)})}}(D))}(window.Raphael),define("raphael",function(e){return function(){return e.Raphael}}(this)),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/Library/raphael.pathConverter",[],function(){function e(e,n,r){var i=[];if(e)for(var s=0,o=e.length;s<o;s++){var u=t(e[s].points,n,r,e[s].brushSize);i.push(u)}return i}function t(e,t,r,i){var s={fill:"none",stroke:t,type:"path","stroke-opacity":r,"stroke-width":i,"stroke-linecap":"round","stroke-linejoin":"round",path:n(e),transform:[]};return s}function n(e){var t=[];for(var n=0,r=e.length;n<r;n++)t.push([n===0?"M":"L",e[n][0],e[n][1]]);return t}function r(e,t){var n={brushSize:t,points:[]};for(var r=0,i=e.length;r<i;r++)n.points.push([e[r][1],e[r][2]]);return n}return{convertToSvgStrokes:e,convertToSvgStroke:t,convertToSvgPath:n,convertToStokeObject:r}}),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/Library/raphael.highlighterPen",["jQueryFramework","./raphael.pathConverter","utils","constants"],function(e,t,n,r){var i=function(i){var s={color:"#FFFF00",opacity:.5,size:22,scaleVal:1},o=n.isUxImprovementsToggleEnabled()&&r.IsMobile,u=null;e.extend(s,i);var a=!1,f=null,l=[],c=null,h=!1,p=function(){h=!0},d=function(){h=!1},v=function(){a=!1,f=null,l=[]},m=function(e,t,n){if(h)return;v(),a=!0,c=t;var r=e.pageX-c.left,i=e.pageY-c.top;if(o){var u=g(e.pageX-window.scrollX,e.pageY-window.scrollY);r=u.x,i=u.y}l.push([r,i]),f=n.path(),f.attr({stroke:s.color,"stroke-opacity":s.opacity,"stroke-width":s.size,"stroke-linecap":"round","stroke-linejoin":"round"}),f.toBack()},g=function(t,n){u===null&&(u=e(".highlighterContainer:visible").find("svg")[0]);const r=u.createSVGPoint();r.x=t,r.y=n;var i=u.getScreenCTM();parseFloat(s.scaleVal.toFixed(2))>parseFloat(i.a.toFixed(2))&&(i=i.scale(s.scaleVal));const o=r.matrixTransform(i.inverse());return o},y=function(e,t){var n=null;if(f!=null){n=f;if(l.length===1){var r={pageX:b(t.x,c.left),pageY:b(t.y,c.top)};w(r)}}return v(),n},b=function(e,t){return e-t>0?e-.1:e+.1},w=function(e){if(a&&!h){var n=e.pageX-c.left,r=e.pageY-c.top;if(o){var i=g(e.pageX-window.scrollX,e.pageY-window.scrollY);n=i.x,r=i.y}l.push([n,r]),f.attr({path:t.convertToSvgPath(l)})}},E=function(){return s};return{start:m,move:w,finish:y,getOptions:E,options:s,pinchStart:p,pinchEnd:d}};return{create:i}}),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/Library/cursor",["jQueryFramework","underscore","utils","constants"],function(e,t,n,r){var i=function(e,t,i){var s=null,o=null,u=n.isUxImprovementsToggleEnabled()&&r.IsMobile,a=i,f=e.find("svg")[0],l=function(n){o=e.offset();var r=n.pageX-o.left,u=n.pageY-o.top;s=t.add([{type:"circle",cx:r,cy:u,r:a.penSize/2,fill:i.color,stroke:i.color,opacity:i.opacity}])},c=function(e){s.remove(),s=null},h=function(e){if(s===null)return;var t=e.pageX-o.left,n=e.pageY-o.top;if(u){var r=p(e,e.pageX-window.scrollX,e.pageY-window.scrollY);t=r.x,n=r.y}s.attr({cx:t,cy:n})},p=function(e,t,n){const r=f.createSVGPoint();r.x=t,r.y=n;var i=e.target.getScreenCTM();parseFloat(a.scaleVal.toFixed(2))>parseFloat(i.a.toFixed(2))&&(i=i.scale(a.scaleVal));const s=r.matrixTransform(i.inverse());return s};return e.mouseenter(l),e.mouseleave(c),e.mousemove(h),{penOptions:a}};return{create:i}}),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/Library/raphael.highlighter",["jQueryFramework","raphael","./raphael.highlighterPen","./raphael.pathConverter","./cursor"],function(e,t,n,r,i){var s={width:100,height:100},o=function(o,u,a,f){function g(e,t){var n=r.convertToSvgStrokes(e,h.getOptions().color,h.getOptions().opacity);y();for(var i=0,s=n.length;i<s;i++){var o=n[i],u=o.type;l[u]().attr(o)}}function y(){l.clear()}function b(){e("*").css("-webkit-user-select","none"),e("*").css("-moz-user-select","none"),e.browser&&e.browser.msie&&e("body").attr("onselectstart","return false;")}function w(){e("*").css("-webkit-user-select","text"),e("*").css("-moz-user-select","text"),e.browser&&e.browser.msie&&e("body").removeAttr("onselectstart")}function E(t){b(),v.x=t.pageX,v.y=t.pageY;var n=e(c).offset();h.start(t,n,l)}function S(e){v.x=e.pageX,v.y=e.pageY,h.move(e)}function x(e){w();var t=h.finish(e,v);if(t!=null){var n=t.attr(),i=r.convertToStokeObject(n.path,n["stroke-width"]);u(i)}}function T(e,t){e=e.originalEvent,e.preventDefault();if(e.touches.length>1){h.pinchStart();return}if(e.touches.length==1){var n=e.touches[0];t(n),d=!0}}function N(e){T(e,E)}function C(e){T(e,S)}function k(t){t=t.originalEvent,t.preventDefault(),x(t),t.touches.length>0&&(h.pinchEnd(),d&&(d=!1,e(".button.undo").click())),d=!1}e.extend(s,a);var l=t(o,s.width,s.height),c=e(l.canvas).parent(),h=n.create(f),p=i.create(c,l,f),d=!1,v={};e(c).mousedown(E),e(c).mousemove(S),e(c).mouseup(x),e(document).mouseup(x);var m=navigator.userAgent;return e(c).bind("touchstart",N),e(c).bind("touchmove",C),e(c).bind("touchend",k),{redrawStrokes:g,clear:y,pen:h,cursor:p}};return{create:o}}),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/instructionRaphael",["raphael","jQueryFramework","utils"],function(e,t,n){var r=function(t,r){var i,s,o,u=!1,a=function(e){e.attr("stroke","#ffff00"),e.attr("stroke-width","18px"),e.attr("stroke-opacity",n.isIE8OrLess()?"0.5":"1.0"),e.attr("stroke-linecap","round"),e.attr("stroke-linejoin","round")},f=function(e){var t=r.strokes[e];t.element.animate({path:t.start+" "+t.lineTo},t.delay,t.easing,function(){e+1<r.strokes.length?f(e+1):u=!1})},l=function(){o.clear();for(var e=0;e<r.strokes.length;e++){var t=o.path(r.strokes[e].start);a(t),r.strokes[e].element=t}u||(f(0),u=!0)},c,h=function(){o.clear();for(var e=0;e<r.strokes.length;e++)r.strokes[e].element.stop();clearInterval(c),u=!1},p=function(){i=t.find(".raphael-container"),i.find("svg").remove(),s=t.find(".raphael-paper"),i.css({background:"url("+r.image+") no-repeat","background-image":"url("+r.image+") no-repeat",height:r.imageHeight,width:r.imageWidth}),o=e(s[0],r.imageWidth,r.imageHeight),c=setInterval(l,r.interval),l()};return{startRaphaelAnimation:p,stop:h}};return{create:r}}),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/Views/highlighterDesktopView",["jQueryFramework","viewUtils","utils","images","hbs!../../Templates/highlighterDesktop","../Library/raphael.highlighter","../instructionRaphael","underscore","constants"],function(e,t,n,r,i,s,o,u,a){var f=884,l=function(r,l){var c={penColor:"#FFFF00",opacity:1,penSize:22,decimalPlaces:0},h="visioncritical-highlighterInstructionDialog"+(a.IsRtlContentDirection?" rtl-element":"");r.penColor&&(c.penColor=r.penColor);var p=i({instructionsText:l.getLocalizedString("mobileInstruction"),highlighterEmptyImageErrorMessage:l.getLocalizedString("noImageUploaded")}),d=t.grabElements(p),v={strokes:[{start:"M141 104",lineTo:"L191 83",delay:400,easing:"ease-in-out"},{start:"M191 83",lineTo:"L120 135",delay:300,easing:"ease-in-out"},{start:"M120 135",lineTo:"L225 86",delay:300,easing:"ease-in-out"},{start:"M225 86",lineTo:"L112 165",delay:300,easing:"ease-in-out"},{start:"M112 165",lineTo:"L249 100",delay:270,easing:"ease-in-out"},{start:"M249 100",lineTo:"L133 178",delay:270,easing:"ease-in-out"},{start:"M133 178",lineTo:"L254 123",delay:270,easing:"ease-in-out"},{start:"M254 123",lineTo:"L145 195",delay:270,easing:"ease-in-out"},{start:"M145 195",lineTo:"L250 152",delay:270,easing:"ease-in-out"},{start:"M250 152",lineTo:"L169 197",delay:300,easing:"ease-in-out"},{start:"M169 197",lineTo:"L227 180",delay:350,easing:"ease-in-out"}],image:a.EqfBaseUrl+"/Plugins/ExtendedQuestions/HighlighterPlugin/images/turtle.jpg",imageWidth:380,imageHeight:274,interval:8500},m=o.create(d.$instructionPopup,v),g=null,y=null,b=function(){n.isIE8OrLess()&&(c.opacity=.5)},w=function(e){y=e},E=function(t){var n=function(t){e(t.target).addClass("button-mousedown")},r=function(t){e(t.target).removeClass("button-mousedown")};t.on("mousedown",n),t.on("mouseup",r)},S=function(e){var t=function(t){e()};d.$undoButton.on("click",t),E(d.$undoButton)},x=function(e){var t=function(t){e()};d.$clearButton.on("click",t),E(d.$clearButton)},T=function(){var e=r.getAllStrokes();g.redrawStrokes(e,c.penColor),r.onChanged()},N=function(){var e=parseInt(r.image.Width),t=parseInt(r.image.Height);return e>=t&&e>f?(r.image.Height=t/e*f,r.image.Width=f):t>e&&t>f&&(r.image.Height=f,r.image.Width=e/t*f),r.image},C=function(e,t,i){var s=123;d.$highlighter.hide(),u.each([d.$highlighterContainer,d.$highlighter,d.$highlighterImage],function(e){e.css("width",t),e.css("height",i)}),d.$highlighterToolbar.height(i),d.$highlighterToolbarFiller.height(i-s),d.$highlighter.css("opacity",.6);if(e!==""){var o=new Image(t,i);o.onload=function(){d.$highlighterImage.css({"background-image":n.formatString("url('{0}') no-repeat 0 0",[e]),background:n.formatString("url('{0}') no-repeat 0 0",[e]),"background-size":"100% 100%"}),d.$highlighterImage.removeClass("imagePlaceholder"),d.$highlighter.show()},o.src=e}r.hasImage()||(d.$highlighterEmptyImageErrorMessage.css("display","block"),d.$highlighter.show()),L()},k=function(){var e=N();r.init(e);var t=r.image.Url,n=e.Width,i=e.Height;C(t,n,i),g=s.create(d.$highlighter[0],y,{width:n,height:i},{color:c.penColor,opacity:c.opacity,penSize:c.penSize}),T()},L=function(){var e=d.$instructionPopup,t=function(){l.showDialog({draggable:!1,dialogClass:h,style:"small",fixedHeightHierarchy:[326,0,102],fixedWidth:400,closeOnOverlayClick:!0,title:l.getLocalizedString("desktopInfoTitle"),content:e,buttons:[{text:l.getLocalizedString("mobileBegin"),click:function(){e.closest(".ui-dialog-content").dialog("close")}}],open:function(){m.startRaphaelAnimation()},beforeClose:function(){m.stop()}})};d.$infoButton.on("click",t)};return b(),{$root:d.$root,addedToPage:k,getAdjustedImage:N,setAddStroke:w,setUndo:S,setClear:x,refresh:T}};return{create:l}}),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/dataScaler",[],function(){var e=2,t=function(e,t,i){if(e===i.meta.renderedSize.width&&t===i.meta.renderedSize.height)return i;var s={meta:{renderedSize:{width:0,height:0}},objects:[]};s.meta=i.meta;var o=e/i.meta.renderedSize.width,u=t/i.meta.renderedSize.height;for(var a=0,f=i.objects.length;a<f;a++)s.objects.push({brushSize:r(i.objects[a].brushSize*o),points:n(o,u,i.objects[a].points)});return s.meta.renderedSize.width=e,s.meta.renderedSize.height=t,s},n=function(e,t,n){var i=[];for(var s=0,o=n.length;s<o;s++)i.push([r(n[s][0]*e),r(n[s][1]*t)]);return i},r=function(t){return parseFloat(t.toFixed(e))};return{scaleData:t}}),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/highlighterViewModel",["./dataScaler"],function(e){var t=function(t){function h(){return l()?n.CustomQuestionProperties.HighlighterImage:f}var n=t.questionDefinition,r={meta:{renderedSize:{width:0,height:0}},objects:[]},i=r,s=function(){for(var e=0;e<i.objects.length;e++)for(var t=0;t<i.objects[e].points.length;t++)i.objects[e].points[t][0]<0?i.objects[e].points[t][0]=0:i.objects[e].points[t][0]>=i.meta.renderedSize.width&&(i.objects[e].points[t][0]=i.meta.renderedSize.width-1),i.objects[e].points[t][1]<0?i.objects[e].points[t][1]=0:i.objects[e].points[t][1]>=i.meta.renderedSize.height&&(i.objects[e].points[t][1]=i.meta.renderedSize.height-1)},o={store:function(){i.meta.renderedSize.width=p.image.Width,i.meta.renderedSize.height=p.image.Height,s(),i.objects.length>0?t.dataStore.setOpenEndText(JSON.stringify(i)):t.dataStore.setOpenEndText("")},load:function(){try{var i=JSON.parse(t.dataStore.getOpenEndText(n.ObjectId))}catch(s){return r}var o=e.scaleData(p.image.Width,p.image.Height,i);return o},changed:t.completionStatusChanged},u=function(e){return!e||e&&a()},a=function(){return i.objects.length>0},f={Height:200,Width:200},l=function(){return n.CustomQuestionProperties.HighlighterImage&&!0},c=h(),p={},d=function(){return t.getImage(p.image,p.image.Width,p.image.Height)},v=function(e){i.objects.push(e)},m=function(){i.objects.pop()},g=function(){i.objects=[]},y=function(){return i.objects},b=function(e){i=o.load(),p.image=e};return p.penColor=n.CustomQuestionProperties.PenColor,p.image=c,p.getImageUrl=d,p.validate=u,p.getAllStrokes=y,p.undo=m,p.clear=g,p.addStroke=v,p.onChanged=o.changed,p.save=o.store,p.init=b,p.hasData=a,p.hasImage=l,p};return{create:t}}),define("plugins/ExtendedQuestions/HighlighterPlugin/Scripts/main",["jQueryFramework","utils","event!aboutToValidate","./Views/highlighterDesktopView","./highlighterViewModel"],function(e,t,n,r,i){var s=function(e){return e.RespondingPlugin==="HighlighterPlugin"},o=function(e){var t=i.create(e),s=r.create(t,e),o=function(){var e=s.$root;return s.setAddStroke(function(e){t.addStroke(e),t.onChanged()}),s.setUndo(function(){t.undo(),s.refresh()}),s.setClear(function(){t.clear(),s.refresh()}),e},u=function(){return t.validate(e.questionDefinition.Required)},a=function(){s.addedToPage()};return n.subscribe(function(){t.save()}),e.loadCss("HighlighterPlugin/css/highlighter.main.desktop.css"),{isComplete:u,createView:o,addedToPage:a,shouldRenderQuestionHeader:!1,getObjectId:function(){return e.questionDefinition.ObjectId}}};return{create:o,shouldHandleQuestion:s}})